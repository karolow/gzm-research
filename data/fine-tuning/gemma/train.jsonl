{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby preferujące wydarzenia o zasięgu miejskim częściej uważają, że kultura podnosi atrakcyjność regionu (ocena 5-7), niż osoby preferujące wydarzenia dzielnicowe?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wydarzenie_miejskie = TRUE AND wydarzenie_dzielnicowe = FALSE THEN 'Preferuje miejskie (nie dziel.)' WHEN wydarzenie_dzielnicowe = TRUE AND wydarzenie_miejskie = FALSE THEN 'Preferuje dzielnicowe (nie miejs.)' ELSE 'Inne/Mieszane' END AS preferencja_zasiegu, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc FROM participation_survey WHERE (wydarzenie_miejskie = TRUE OR wydarzenie_dzielnicowe = TRUE) GROUP BY preferencja_zasiegu HAVING preferencja_zasiegu != 'Inne/Mieszane';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy seniorzy z Katowic mają inne preferencje dotyczące aktywności kulturalnych niż seniorzy z Gliwic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzeum, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncert, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS piknik FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') AND grupa_wiekowa = '60 i więcej' GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent rencistów w GZM odwiedził teatr w ciągu ostatnich 3 lat (ale nie w ostatnim roku)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_1_3_lata FROM participation_survey WHERE zatrudnienie_rencista = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W zespole dzielnic południowych Katowic, czy bariera 'wysokie ceny' jest częściej wskazywana niż 'brak czasu'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneS AS ( SELECT bariera_wysokie_ceny, bariera_brak_czasu, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Wysokie ceny' AS bariera, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS UNION ALL SELECT 'Brak czasu' AS bariera, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W powiecie tarnogórskim, jakie jest główne źródło informacji o kulturze: plakaty czy portale lokalne?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Plakaty/Ogłoszenia' AS zrodlo, ROUND(SUM(CASE WHEN informacja_plakaty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' UNION ALL SELECT 'Portale Lokalne' AS zrodlo, ROUND(SUM(CASE WHEN informacja_portale_lokalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' ORDER BY procent DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W Katowicach, porównaj odsetek osób odwiedzających ostatnio (6 msc) piknik/festyn między zespołem dzielnic zachodnich i południowych.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_piknik, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_piknik_6msc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic zachodnich', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy subregionu tyskiego częściej niż mieszkańcy subregionu katowickiego uważają, że 'to jak się do siebie zwracamy' jest częścią kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Tyski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN kultura_sposob_zwracania_sie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sposob_zwracania FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI', 'TYSKI') GROUP BY subregion_grupa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że dzięki kulturze można nawiązywać relacje (ocena 6-7), częściej odwiedzają domy kultury (przynajmniej raz na rok)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Relacje)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_relacje, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE opinia_kultura_relacje_miedzyludzkie IS NOT NULL AND czestotliwosc_dom_kultury IS NOT NULL GROUP BY opinia_relacje;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Czeladzi i Siewierza był ostatnio na pikniku/festynie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Czeladź', 'Siewierz') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które zgadzają się (ocena 6-7), że konsumpcja kultury sprawia przyjemność, między mieszkańcami powiatu pszczyńskiego a mieszkańcami dzielnicy Murcki (Katowice).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' THEN 'Powiat Pszczyński' WHEN dzielnica_katowic = 'Murcki' THEN 'Murcki KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński') OR (dzielnica_katowic = 'Murcki') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które jako pierwsze skojarzenie z wydarzeniami GZM podają 'koncerty', wydają średnio więcej na kulturę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN skojarzenia_wydarzenia_gzm_1_kategoria = 'koncerty / imprezy muzyczne' THEN 'Skojarzenie: Koncerty' ELSE 'Inne skojarzenie' END AS typ_skojarzenia, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY typ_skojarzenia;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Kobióra i Wyr odwiedza muzea przynajmniej raz w roku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób czerpiących informacje z plakatów/ogłoszeń na mieście odwiedziło muzeum/galerię sztuki w ciągu ostatnich 6 miesięcy, w porównaniu do osób czerpiących informacje z lokalnych portali internetowych?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Plakaty/Ogłoszenia na mieście' AS zrodlo_informacji, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum FROM participation_survey WHERE informacja_plakaty = TRUE UNION ALL SELECT 'Lokalne portale internetowe' AS zrodlo_informacji, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum FROM participation_survey WHERE informacja_portale_lokalne = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które oglądają nagrania sztuk teatralnych przynajmniej raz w roku, między mieszkańcami gminy Gierałtowice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_nagrania_teatralne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_nagrania_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie są 3 główne bariery uczestnictwa w kulturze dla osób o dochodach do 3500 zł netto w subregionie bytomskim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI') SELECT bariera, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Wysokie ceny / koszty korzystania' AS bariera, bariera_wysokie_ceny AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Problemy z dojazdem / komunikacją' AS bariera, bariera_dojazd AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało atrakcyjna oferta tematyczna' AS bariera, bariera_nieatrakcyjna_oferta AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Niewystarczająca ilość informacji o ofercie' AS bariera, bariera_brak_informacji AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Trudności z fizycznym dostępem / bariery architektoniczne' AS bariera, bariera_dostep_fizyczny AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało dogodne godziny otwarcia instytucji' AS bariera, bariera_godziny_otwarcia AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Brak czasu / za dużo innych spraw na głowie' AS bariera, bariera_brak_czasu AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Opieka nad inną osobą/ osobą zależną' AS bariera, bariera_opieka AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało atrakcyjna jakościowa oferta' AS bariera, bariera_niska_jakosc AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Niska dostępność biletów/są szybko wykupywane' AS bariera, bariera_dostepnosc_biletow AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Moja miejscowość nie ma żadnej oferty kulturalnej' AS bariera, bariera_brak_oferty_lokalnej AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Nie znam oferty kulturalnej w mojej okolicy' AS bariera, bariera_nieznajomosc_oferty AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Inne problemy' AS bariera, bariera_inne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Żadne z powyższych barier' AS bariera, bariera_zadne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' ) subquery WHERE selected = TRUE GROUP BY bariera ORDER BY procent DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak uczestnictwo w kulturze i jej postrzeganie (np. średnia ocena przyjemności, odsetek odwiedzających muzea rocznie) różni się między rodzicami małych dzieci a pozostałymi osobami?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT opieka_nad_dzieckiem AS ma_dzieci_ponizej_13, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE opieka_nad_dzieckiem IS NOT NULL GROUP BY opieka_nad_dzieckiem;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Katowic, którzy często korzystają z kultury online (ocena 6-7), wydają średnio więcej na kulturę miesięcznie niż ci, którzy korzystają rzadko (ocena 1-2)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN czestotliwosc_kultura_online IN ('6', '7 bardzo często') THEN 'Często online (6-7)' WHEN czestotliwosc_kultura_online IN ('1 bardzo rzadko lub wcale', '2') THEN 'Rzadko online (1-2)' ELSE 'Średnio/Brak danych' END AS czestotliwosc_online, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_miesieczne FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND wydatki_na_kulture_kwota IS NOT NULL AND czestotliwosc_kultura_online IS NOT NULL GROUP BY czestotliwosc_online HAVING czestotliwosc_online IN ('Często online (6-7)', 'Rzadko online (1-2)');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) dostępu do kultury w GZM wśród mieszkańców zespołu dzielnic wschodnich Katowic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ocena_dostepu_do_kultury_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic wschodnich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w subregionie bytomskim więcej osób uważa tradycję za element kultury niż w subregionie sosnowieckim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycja FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które uważają, że najlepszy sposób spędzania wolnego czasu jest użyteczny/praktyczny (odpowiedź 'zdecydowanie tak'), odwiedziło dom kultury w ciągu ostatnich 12 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_dom_kultury FROM participation_survey WHERE wolny_czas_definicja_praktycznosc = 'zdecydowanie tak';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Koszutki i Wełnowca-Józefowca (Katowice) zgadza się (ocena 5-7), że działalność kulturalna podnosi atrakcyjność regionu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT dzielnica_katowic, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc_regionu FROM participation_survey WHERE dzielnica_katowic IN ('Koszutka', 'Wełnowiec-Józefowiec') GROUP BY dzielnica_katowic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które aktywnie tworzą (np. malują, grają muzykę), częściej deklarują 'brak czasu' jako barierę niż osoby nietworzące?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN 'Aktywny twórczo' ELSE 'Nieaktywny twórczo' END AS status_tworczosci, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey GROUP BY status_tworczosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie wydarzenia kulturalne (ostatnie 6 msc) są popularniejsze w zespole dzielnic północnych Katowic w porównaniu do zespołu dzielnic wschodnich?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_teatr, ostatnio_koncert, ostatnio_muzeum, ostatnio_piknik, ostatnio_kino, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr_proc, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty_proc, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzea_proc, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS pikniki_proc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino_proc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic wschodnich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób grających na instrumencie między mieszkańcami miast poniżej 20 tys. a mieszkańcami miast powyżej 200 tys.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_grajacych_na_instrumencie FROM participation_survey WHERE wielkosc_miejscowosci IN ('miasto  poniżej 20 tys. mieszkańców', 'miasto powyżej 200 tys. mieszkańców') GROUP BY wielkosc_miejscowosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Z jakich źródeł informacji o kulturze korzystają najczęściej osoby które jeżdżą na rowerze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total AS (SELECT SUM(waga_proby) AS total_weight FROM participation_survey WHERE transport_wlasny_rower = TRUE) SELECT source, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total_weight FROM total), 2) AS percentage FROM ( SELECT 'Prasa drukowana' AS source, informacja_prasa_drukowana AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Plakaty/ogłoszenia/reklamy' AS source, informacja_plakaty AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Lokalne portale/strony' AS source, informacja_portale_lokalne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Ogólnopolskie portale/strony' AS source, informacja_portale_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Profile instytucji w mediach społecznościowych' AS source, informacja_social_media_instytucje AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Profile twórców w mediach społecznościowych' AS source, informacja_social_media_tworcy AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Inne profile w mediach społecznościowych' AS source, informacja_social_media_inne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Od znajomych/rodziny' AS source, informacja_znajomi_rodzina AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Radio' AS source, informacja_radio AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Telewizja' AS source, informacja_telewizja AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Strony internetowe instytucji kultury' AS source, informacja_strony_instytucji AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Ogólnotematyczne strony internetowe' AS source, informacja_strony_ogolne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Inne źródła' AS source, informacja_inne_zrodla AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Żadne z powyższych źródeł informacji' AS source, informacja_zadne_zrodla AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE ) subquery GROUP BY source ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy odsetek osób uważających patriotyzm za część kultury jest wyższy w subregionie bytomskim niż w sosnowieckim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_jako_kultura FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W subregionie sosnowieckim, czy odsetek osób odwiedzających Teatr Zagłębia jest większy niż odsetek odwiedzających inne teatry?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH TheatreVisits AS ( SELECT waga_proby, CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Zagłębia w Sosnowcu' THEN 'Teatr Zagłębia' WHEN ostatnio_teatr = TRUE AND kategoria_odwiedzonego_teatru != 'Teatr Zagłębia w Sosnowcu' THEN 'Inne Teatry' ELSE 'Nieodwiedzający Teatru (ost 6msc)' END AS typ_teatru FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' ) SELECT typ_teatru, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM TheatreVisits), 2) AS procent FROM TheatreVisits WHERE typ_teatru IN ('Teatr Zagłębia', 'Inne Teatry') GROUP BY typ_teatru;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie bariery uniemożliwiają seniorom z subregionu tyskie uczestnictwo w kulturze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN bariera_wysokie_ceny = TRUE THEN 'Wysokie ceny' WHEN bariera_dojazd = TRUE THEN 'Problemy z dojazdem' WHEN bariera_nieatrakcyjna_oferta = TRUE THEN 'Mało atrakcyjna oferta' WHEN bariera_brak_informacji = TRUE THEN 'Niewystarczająca ilość informacji' WHEN bariera_dostep_fizyczny = TRUE THEN 'Trudności z fizycznym dostępem' WHEN bariera_godziny_otwarcia = TRUE THEN 'Mało dogodne godziny otwarcia' WHEN bariera_brak_czasu = TRUE THEN 'Brak czasu' WHEN bariera_opieka = TRUE THEN 'Opieka nad inną osobą' WHEN bariera_niska_jakosc = TRUE THEN 'Mało atrakcyjna jakościowo oferta' WHEN bariera_dostepnosc_biletow = TRUE THEN 'Niska dostępność biletów' WHEN bariera_brak_oferty_lokalnej = TRUE THEN 'Brak oferty lokalnej' WHEN bariera_nieznajomosc_oferty = TRUE THEN 'Nie znam oferty lokalnej' WHEN bariera_inne = TRUE THEN 'Inne' ELSE 'Brak barier' END AS bariera, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa = '60 i więcej'), 2) AS procent FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa = '60 i więcej' GROUP BY bariera ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak konsumpcja kultury cyfrowej (średnia częstotliwość online, odsetek używających VR) różni się między mieszkańcami miast i wsi?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online, ROUND(SUM(CASE WHEN cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uzywa_vr FROM participation_survey WHERE wielkosc_miejscowosci IS NOT NULL GROUP BY wielkosc_miejscowosci ORDER BY wielkosc_miejscowosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z segmentu 'Sensualni' nigdy nie był w teatrze, ale chciałby pójść w przyszłości?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_chcialby_isc FROM participation_survey WHERE segment_uczestnika = 'Sensualni' AND czestotliwosc_teatr IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic północnych i południowych Katowic był ostatnio w kinie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_kino, waga_proby, CASE WHEN dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice-Ochojec', 'Kostuchna', 'Zarzecze', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców subregionu gliwickiego i tyskiego był ostatnio w kinie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE subregion_metropolii_gzm IN ('GLIWICKI', 'TYSKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców subregionu katowickiego uczestniczył w rekonstrukcji historycznej przynajmniej raz w ciągu ostatnich 3 lat?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_rekonstrukcja_historyczna IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rekonstrukcja_3lata FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z niepełnosprawnością ruchu w Katowicach jako barierę wskazuje 'trudności z fizycznym dostępem'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_fizyczna FROM participation_survey WHERE miasto_powiat = 'Katowice' AND niepelnosprawnosc_ruch = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia miesięczna kwota wydatków na kulturę wśród osób, które zetknęły się z twórczością lokalnego artysty wielokrotnie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_miesieczne FROM participation_survey WHERE kontakt_z_artysta_lokalnym = 'tak, wielokrotnie' AND wydatki_na_kulture_kwota IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki odsetek osób pracujących wyłącznie zdalnie ('wyłącznie w domu | zdalnie') uczestniczy w kulturze wyłącznie w miejscu zamieszkania, w porównaniu do osób pracujących wyłącznie poza domem ('wyłącznie w miejscu pracy | poza domem')?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miejsce_wykonywania_pracy, ROUND(SUM(CASE WHEN uczestnictwo_miejsce_zamieszkania = TRUE AND uczestnictwo_miejsce_pracy = FALSE AND uczestnictwo_inne_miejsce_gzm = FALSE AND uczestnictwo_poza_gzm = FALSE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tylko_w_miejscu_zamieszkania FROM participation_survey WHERE miejsce_wykonywania_pracy IN ('wyłącznie w domu | zdalnie', 'wyłącznie w miejscu pracy | poza domem') GROUP BY miejsce_wykonywania_pracy;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest zależność między postrzeganą istotnością kultury a średnimi wydatkami na kulturę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT istotnosc_uczestnictwa_w_kulturze, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 END), 0) AS poziom_istotnosci_num, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE istotnosc_uczestnictwa_w_kulturze IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY istotnosc_uczestnictwa_w_kulturze ORDER BY poziom_istotnosci_num;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Sosnowca a mieszkańcami zespołu dzielnic wschodnich Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneE AS ( SELECT wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT 'Sosnowiec (Miasto)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Zespół dzielnic wschodnich KTW' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM KatowiceZoneE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które korzystają z kultury poza GZM, jako powód lub rodzaj aktywności wskazuje (w pytaniu otwartym) coś związanego z teatrem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN LOWER(aktywnosc_poza_gzm_tekst) LIKE '%teatr%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wskazujacy_teatr FROM participation_survey WHERE uczestnictwo_poza_gzm_czas = TRUE AND aktywnosc_poza_gzm_tekst IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które odwiedziły ostatnio (6 msc) muzeum, częściej zgadzają się (ocena 6-7), że kultura pozwala im się realizować?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ostatnio_muzeum, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_samorealizacja FROM participation_survey WHERE ostatnio_muzeum IS NOT NULL GROUP BY ostatnio_muzeum;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic północnych Katowic oraz jaki procent mieszkańców powiatu mikołowskiego był ostatnio na pikniku/festynie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneN AS ( SELECT ostatnio_piknik, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') ) SELECT 'Zespół dzielnic północnych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_piknik FROM KatowiceZoneN UNION ALL SELECT 'Powiat Mikołowski' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Siemianowic Śląskich i mieszkańców dzielnicy Dąbrówka Mała (Katowice) był ostatnio na koncercie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Siemianowice Śląskie' THEN 'Siemianowice Śląskie (Miasto)' WHEN dzielnica_katowic = 'Dąbrówka Mała' THEN 'Dąbrówka Mała KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE (miasto_powiat = 'Siemianowice Śląskie') OR (dzielnica_katowic = 'Dąbrówka Mała') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Gliwic odwiedził Muzeum w Gliwicach (jako muzeum)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum w Gliwicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_mgliwice FROM participation_survey WHERE miasto_powiat = 'Gliwice';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób w GZM ma dostęp do internetu jednocześnie w domu, pracy i telefonie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN internet_w_domu = TRUE AND internet_w_pracy = TRUE AND internet_w_telefonie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_internet_wszedzie FROM participation_survey;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby opiekujące się osobą zależną (chorą, niepełnosprawną) częściej zgadzają się (ocena 5-7) ze stwierdzeniem 'Jest wiele ważniejszych rzeczy niż kultura' w porównaniu do osób nieopiekujących się taką osobą? Pokaż procenty.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT opieka_nad_osoba_zalezna, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_wazniejsze_rzeczy FROM participation_survey GROUP BY opieka_nad_osoba_zalezna;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Gierałtowice i gminy Zbrosławice uważa, że 'patriotyzm' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które jako pierwsze skojarzenie z miejscami GZM podają 'Muzeum', odwiedziło muzeum w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzeum_6msc FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'muzeum';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Tychów częściej korzystają z instytucji kulturalnych w innych miastach GZM niż mieszkańcy Gliwic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_poza_miastem FROM participation_survey WHERE miasto_powiat IN ('Tychy', 'Gliwice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które jako źródło informacji o kulturze wskazują portale lokalne, między mieszkańcami gminy Mierzęcice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_portale_lokalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_portale_lokalne FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W Katowicach, jaki procent mieszkańców zespołu dzielnic śródmiejskich odwiedził teatr w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_teatr, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic śródmiejskich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) istotności kultury wśród osób, które jako swoją definicję kultury podają 'Dziedzictwo/historia...'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE definicja_kultury_kategoria = 'Dziedzictwo/historia/narodowość/regionalność/tożsamość' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby korzystające z transportu współdzielonego (rower/hulajnoga na minuty) częściej uczestniczą w piknikach/festynach (w ostatnich 6 msc) niż osoby korzystające głównie z własnego samochodu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN transport_wspoldzielony = TRUE AND transport_wlasny_samochod = FALSE THEN 'Transport współdzielony (bez auta)' WHEN transport_wlasny_samochod = TRUE AND transport_wspoldzielony = FALSE THEN 'Głównie własny samochód (bez shared)' ELSE 'Inny/Mieszany' END AS typ_transportu, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestniczacych_w_piknikach FROM participation_survey WHERE (transport_wspoldzielony = TRUE AND transport_wlasny_samochod = FALSE) OR (transport_wlasny_samochod = TRUE AND transport_wspoldzielony = FALSE) GROUP BY typ_transportu;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różnią się średnie wydatki na kulturę między respondentami z wykształceniem wyższym a tymi z wykształceniem średnim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wyksztalcenie IN ('wyższe', 'średnie') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie trzy najczęstsze skojarzenia z MIEJSCAMI kultury GZM (kategoria 1) mają osoby z segmentu 'Młodzi Uciekinierzy'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT skojarzenia_miejsca_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy'), 2) AS procent_wskazan FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy' AND skojarzenia_miejsca_gzm_1_kategoria IS NOT NULL AND skojarzenia_miejsca_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_miejsca_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) stwierdzenia 'Wypada być na bieżąco z kulturą' wśród osób w wieku 18-29 lat?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_bycie_na_biezaco = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_bycie_na_biezaco = '2' THEN 2 WHEN opinia_kultura_bycie_na_biezaco = '3' THEN 3 WHEN opinia_kultura_bycie_na_biezaco = '4' THEN 4 WHEN opinia_kultura_bycie_na_biezaco = '5' THEN 5 WHEN opinia_kultura_bycie_na_biezaco = '6' THEN 6 WHEN opinia_kultura_bycie_na_biezaco = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_bycie_na_biezaco FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30' AND opinia_kultura_bycie_na_biezaco IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Wojkowice częściej niż mieszkańcy gminy Bobrowniki uważają, że fotografia to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN kultura_fotografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_foto_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Wojkowice', 'Bobrowniki') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Mierzęcice częściej niż mieszkańcy gminy Psary odwiedzają kina?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Mierzęcice', 'Psary') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że nakłady publiczne na kulturę powinny być mniejsze (ocena 6-7), rzadziej odwiedzają muzea (przynajmniej raz w ciągu ostatnich 12 miesięcy)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Mniejsze wydatki)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_wydatki, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum_rocznie FROM participation_survey WHERE opinia_wydatki_publiczne_na_kulture IS NOT NULL AND czestotliwosc_muzeum IS NOT NULL GROUP BY opinia_wydatki;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców GZM wymienia 'Spodek' jako którekolwiek ze swoich pierwszych trzech skojarzeń z miejscami kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' OR skojarzenia_miejsca_gzm_2_kategoria = 'Spodek' OR skojarzenia_miejsca_gzm_3_kategoria = 'Spodek' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_spodek_top3 FROM participation_survey;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Zbrosławice i gminy Bobrowniki uważa, że 'telewizja' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_telewizja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tv_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy tradycyjne śląskie wydarzenia kulturalne są bardziej popularne wśród osób z niższym czy wyższym wykształceniem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wyksztalcenie = 'niższe niż średnie' THEN 'Niższe wykształcenie' WHEN wyksztalcenie IN ('średnie', 'wyższe') THEN 'Wyższe wykształcenie' END AS poziom_wyksztalcenia, ROUND(SUM(CASE WHEN (skojarzenia_wydarzenia_gzm_1_kategoria = 'festyny/jarmarki/pikniki' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%barbórk%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%górni%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%śląsk%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%trady%') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycyjne_slaskie FROM participation_survey WHERE wyksztalcenie IS NOT NULL GROUP BY poziom_wyksztalcenia;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między miastem Gliwice a wszystkimi gminami wiejskimi powiatu gliwickiego łącznie.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice', 'Rudziniec', 'Sośnicowice') THEN 'Gminy Wiejskie Pow. Gliwicki' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Gliwice' OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice', 'Rudziniec', 'Sośnicowice'))) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja HAVING lokalizacja IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób definiujących kulturę głównie jako 'Sztuka/artyzm/wyrażanie siebie', jaka jest średnia częstotliwość wizyt w kinie (skala 1-5) oraz średnia częstotliwość korzystania z kultury online (skala 1-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 5 WHEN czestotliwosc_kino = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN 4 WHEN czestotliwosc_kino = 'Dawniej niż w ciągu ostatnich 3 lat' THEN 3 WHEN czestotliwosc_kino = 'Nigdy, ale chciał(a)bym w przyszłości' THEN 2 WHEN czestotliwosc_kino = 'Nigdy i nie jestem tym zainteresowany(a)' THEN 1 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_kino_1_5, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online_1_7 FROM participation_survey WHERE definicja_kultury_kategoria = 'Sztuka/artyzm/wyrażanie siebie';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) dostępu do kultury w GZM wśród osób, które odwiedziły teatr w ciągu ostatnich 12 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' AND ocena_dostepu_do_kultury_gzm IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) istotności kultury wśród osób, które pracują wyłącznie zdalnie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE miejsce_wykonywania_pracy = 'wyłącznie w domu | zdalnie' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak istotne jest uczestnictwo w kulturze dla osób, które zetknęły się z twórczością lokalnego artysty choćby raz w porównaniu do tych, które się nie zetknęły w ogóle?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN kontakt_z_artysta_lokalnym IN ('tak, wielokrotnie', 'tak, raz czy dwa') THEN 'Zetknął/ęła się' ELSE 'Nie zetknął/ęła się' END AS kontakt_status, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE kontakt_z_artysta_lokalnym IS NOT NULL GROUP BY kontakt_status;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedzają domy kultury przynajmniej raz w roku, między mieszkańcami gminy Kobiór a mieszkańcami gminy Gierałtowice (pow. gliwicki).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę istotności kultury (1-7) między mieszkańcami zespołu dzielnic północnych i południowych Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT istotnosc_uczestnictwa_w_kulturze, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie mikołowskim osoby częściej odwiedzają kina czy teatry (przynajmniej raz na rok)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Kino (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' UNION ALL SELECT 'Teatr (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Psary odwiedził kino w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które uważają, że malarstwo to kultura, między mieszkańcami subregionu gliwickiego i bytomskiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_malarstwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_malarstwo_kultura FROM participation_survey WHERE subregion_metropolii_gzm IN ('GLIWICKI', 'BYTOMSKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Rudziniec i gminy Wyry jako źródło informacji o kulturze wskazuje radio?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_radio = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_radio FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie aktywności twórcze podejmują najczęściej osoby które uważają że kultura daje poczucie prestiżu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam')) SELECT aktywnosc_tworcza, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Gra na instrumencie' AS aktywnosc_tworcza, tworczosc_gra_na_instrumencie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Pisanie tekstów' AS aktywnosc_tworcza, tworczosc_pisanie_tekstow AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Robienie zdjęć' AS aktywnosc_tworcza, tworczosc_fotografia AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Rysowanie lub malowanie' AS aktywnosc_tworcza, tworczosc_rysowanie_malowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Szycie/haftowanie' AS aktywnosc_tworcza, tworczosc_szycie_haftowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Śpiewanie' AS aktywnosc_tworcza, tworczosc_spiew AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Komponowanie muzyki' AS aktywnosc_tworcza, tworczosc_komponowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Inna twórczość' AS aktywnosc_tworcza, tworczosc_inna AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Żadne z powyższych aktywności twórczych' AS aktywnosc_tworcza, tworczosc_zadna AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') ) subquery WHERE selected = TRUE GROUP BY aktywnosc_tworcza ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) stwierdzenia 'Lubię poznawać nowe miejsca związane z kulturą' wśród osób z segmentu 'Ludowi Tradycjonaliści'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_nowe_miejsca = '2' THEN 2 WHEN opinia_kultura_nowe_miejsca = '3' THEN 3 WHEN opinia_kultura_nowe_miejsca = '4' THEN 4 WHEN opinia_kultura_nowe_miejsca = '5' THEN 5 WHEN opinia_kultura_nowe_miejsca = '6' THEN 6 WHEN opinia_kultura_nowe_miejsca = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_nowe_miejsca FROM participation_survey WHERE segment_uczestnika = 'Ludowi Tradycjonaliści' AND opinia_kultura_nowe_miejsca IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W jakich aktywnościach w domach kultury najczęściej uczestniczą mieszkańcy Sosnowca (którzy odwiedzili dom kultury)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE) SELECT activity, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Spotkanie z artystą' AS activity, dom_kultury_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Odczyt / prelekcja' AS activity, dom_kultury_prelekcja AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Pokaz filmu' AS activity, dom_kultury_film AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Przedstawienie teatralne' AS activity, dom_kultury_teatr AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Koncert' AS activity, dom_kultury_koncert AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Wystawa' AS activity, dom_kultury_wystawa AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Inne' AS activity, dom_kultury_inne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE ) subquery WHERE selected = TRUE GROUP BY activity ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie aktywności twórcze podejmują najczęściej osoby, które często chodzą na koncerty (przynajmniej raz w roku)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') SELECT aktywnosc_tworcza, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Gra na instrumencie' AS aktywnosc_tworcza, tworczosc_gra_na_instrumencie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Pisanie tekstów' AS aktywnosc_tworcza, tworczosc_pisanie_tekstow AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Robienie zdjęć' AS aktywnosc_tworcza, tworczosc_fotografia AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Rysowanie lub malowanie' AS aktywnosc_tworcza, tworczosc_rysowanie_malowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Szycie/haftowanie' AS aktywnosc_tworcza, tworczosc_szycie_haftowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Śpiewanie' AS aktywnosc_tworcza, tworczosc_spiew AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Komponowanie muzyki' AS aktywnosc_tworcza, tworczosc_komponowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Inna twórczość' AS aktywnosc_tworcza, tworczosc_inna AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Żadne z powyższych aktywności twórczych' AS aktywnosc_tworcza, tworczosc_zadna AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' ) subquery WHERE selected = TRUE GROUP BY aktywnosc_tworcza ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które zgadzają się (ocena 6-7), że kultura jest dla wszystkich, między mieszkańcami powiatu bieruńsko-lędzińskiego a mieszkańcami zespołu dzielnic śródmiejskich Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneC AS ( SELECT opinia_kultura_dla_wszystkich, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') ) SELECT 'Powiat Bieruńsko-Lędziński' AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' UNION ALL SELECT 'Zespół dzielnic śródmiejskich KTW' AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM KatowiceZoneC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają gry komputerowe za część kultury, częściej korzystają z oferty domów kultury (przynajmniej raz w ciągu ostatnich 12 miesięcy)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT kultura_gry_komputerowe, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_dom_kultury_rocznie FROM participation_survey WHERE kultura_gry_komputerowe IN ('Tak', 'Nie') AND czestotliwosc_dom_kultury IS NOT NULL GROUP BY kultura_gry_komputerowe;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które czerpią informacje o kulturze głównie z prasy drukowanej, wydają średnio mniej na kulturę niż osoby czerpiące info głównie z lokalnych portali?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH InfoSource AS ( SELECT CASE WHEN informacja_prasa_drukowana = TRUE AND informacja_portale_lokalne = FALSE THEN 'Prasa (głównie)' WHEN informacja_portale_lokalne = TRUE AND informacja_prasa_drukowana = FALSE THEN 'Portale Lokalne (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo, wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE (informacja_prasa_drukowana = TRUE OR informacja_portale_lokalne = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT glowne_zrodlo, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM InfoSource WHERE glowne_zrodlo IN ('Prasa (głównie)', 'Portale Lokalne (głównie)') GROUP BY glowne_zrodlo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy GZM po 60 roku życia częściej sięgają po tradycyjne media (radio, prasa drukowana) niż cyfrowe formy kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kultura_domowa_radio = TRUE OR kultura_domowa_prasa = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_media_tradycyjne, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_media_cyfrowe FROM participation_survey WHERE grupa_wiekowa = '60 i więcej';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W subregionie bytomskim, jakie jest top 3 skojarzenie (kategoria 1) z wydarzeniami GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT skojarzenia_wydarzenia_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI'), 2) AS procent_wskazan FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' AND skojarzenia_wydarzenia_gzm_1_kategoria IS NOT NULL AND skojarzenia_wydarzenia_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_wydarzenia_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które śledzą profile twórców na Instagramie, częściej odwiedzają galerie sztuki (przynajmniej raz na rok) niż osoby, które tego nie robią?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT instagram_profile_tworcow, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galerie_rocznie FROM participation_survey WHERE instagram_profile_tworcow IS NOT NULL GROUP BY instagram_profile_tworcow;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedzają teatry przynajmniej raz na 3 lata, między mieszkańcami gminy Chełm Śląski a mieszkańcami gminy Rudziniec (pow. gliwicki).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_teatr IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z wyższym wykształceniem w GZM korzysta z oferty archiwów instytucji kultury (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_archiwa = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_archiwa_rocznie FROM participation_survey WHERE wyksztalcenie = 'wyższe';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) 'kultura pozwala się realizować' między osobami z segmentu 'Zdobywcy Wiedzy' i 'Sensualni'.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_samorealizacja = '2' THEN 2 WHEN opinia_kultura_samorealizacja = '3' THEN 3 WHEN opinia_kultura_samorealizacja = '4' THEN 4 WHEN opinia_kultura_samorealizacja = '5' THEN 5 WHEN opinia_kultura_samorealizacja = '6' THEN 6 WHEN opinia_kultura_samorealizacja = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_samorealizacja FROM participation_survey WHERE segment_uczestnika IN ('Zdobywcy Wiedzy', 'Sensualni') AND opinia_kultura_samorealizacja IS NOT NULL GROUP BY segment_uczestnika;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie działania w domach kultury (np. koncerty, filmy, wystawy) są najpopularniejsze wśród osób w wieku 30-39 lat, które odwiedziły dom kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE) SELECT aktywnosc_w_dk, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent_wskazan FROM ( SELECT 'Spotkanie z artystą' AS aktywnosc_w_dk, dom_kultury_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Odczyt / prelekcja' AS aktywnosc_w_dk, dom_kultury_prelekcja AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Pokaz filmu' AS aktywnosc_w_dk, dom_kultury_film AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Przedstawienie teatralne' AS aktywnosc_w_dk, dom_kultury_teatr AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Koncert' AS aktywnosc_w_dk, dom_kultury_koncert AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Wystawa' AS aktywnosc_w_dk, dom_kultury_wystawa AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Inne' AS aktywnosc_w_dk, dom_kultury_inne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE ) subquery WHERE selected = TRUE GROUP BY aktywnosc_w_dk ORDER BY procent_wskazan DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Rudzie Śląskiej i Świętochłowicach istnieją różnice pokoleniowe w sposobach korzystania z kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, CASE WHEN grupa_wiekowa IN ('Mniej niż 30', '30-39') THEN 'Młodsze pokolenia' WHEN grupa_wiekowa IN ('50-59', '60 i więcej') THEN 'Starsze pokolenia' ELSE 'Średnie pokolenie' END AS grupa_pokoleniowa, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino, ROUND(SUM(CASE WHEN kultura_domowa_internet = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS internet, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS piknik, ROUND(SUM(CASE WHEN kultura_domowa_ksiazki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS ksiazki FROM participation_survey WHERE miasto_powiat IN ('Ruda Śląska', 'Świętochłowice') AND grupa_wiekowa IS NOT NULL GROUP BY miasto_powiat, grupa_pokoleniowa HAVING grupa_pokoleniowa IN ('Młodsze pokolenia', 'Starsze pokolenia');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Rudziniec częściej niż mieszkańcy gminy Sośnicowice uczestniczą w piknikach/festynach (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_festyny_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Rudziniec', 'Sośnicowice') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia miesięczna kwota wydatków na kulturę wśród osób, które korzystały z oferty kulturalnej poza GZM w ciągu ostatnich 12 miesięcy, w porównaniu do tych, które nie korzystały?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT uczestnictwo_poza_gzm_czas, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL AND uczestnictwo_poza_gzm_czas IS NOT NULL GROUP BY uczestnictwo_poza_gzm_czas;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) stwierdzenia 'Lubię poznawać nowe miejsca związane z kulturą' wśród emerytów?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_nowe_miejsca = '2' THEN 2 WHEN opinia_kultura_nowe_miejsca = '3' THEN 3 WHEN opinia_kultura_nowe_miejsca = '4' THEN 4 WHEN opinia_kultura_nowe_miejsca = '5' THEN 5 WHEN opinia_kultura_nowe_miejsca = '6' THEN 6 WHEN opinia_kultura_nowe_miejsca = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_nowe_miejsca FROM participation_survey WHERE zatrudnienie_emeryt = TRUE AND opinia_kultura_nowe_miejsca IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między zespołem dzielnic wschodnich i zachodnich Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Ligota-Panewniki', 'Brynów Część Wschodnia - Os. Zgrzebnioka') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic wschodnich', 'Zespół dzielnic zachodnich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mężczyznami i kobietami w subregionie bytomskim.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' AND plec IN ('Kobieta', 'Mężczyzna') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY plec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) stwierdzenia 'Wypada być na bieżąco z kulturą' między mieszkańcami gminy Kobiór a mieszkańcami gminy Mierzęcice (pow. będziński).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_bycie_na_biezaco = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_bycie_na_biezaco = '2' THEN 2 WHEN opinia_kultura_bycie_na_biezaco = '3' THEN 3 WHEN opinia_kultura_bycie_na_biezaco = '4' THEN 4 WHEN opinia_kultura_bycie_na_biezaco = '5' THEN 5 WHEN opinia_kultura_bycie_na_biezaco = '6' THEN 6 WHEN opinia_kultura_bycie_na_biezaco = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_na_biezaco FROM participation_survey WHERE ((miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice')) AND opinia_kultura_bycie_na_biezaco IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie będzińskim osoby odwiedzające miejsca kultury poza GZM częściej wskazują Kraków jako cel?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN LOWER(miejsce_poza_gzm_tekst) LIKE '%kraków%' OR LOWER(miejsce_poza_gzm_tekst) LIKE '%krakow%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_krakow FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND uczestnictwo_poza_gzm_czas = TRUE AND miejsce_poza_gzm_tekst IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby z segmentu 'Wycofani' częściej niż osoby z segmentu 'Przymusowi Domatorzy' uważają, że w kulturze poruszane są mało istotne dla nich tematy (ocena 5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_nieistotne_tematy IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_nieistotne FROM participation_survey WHERE segment_uczestnika IN ('Wycofani', 'Przymusowi Domatorzy') GROUP BY segment_uczestnika;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy rodziny z dziećmi mieszkające na peryferiach GZM częściej napotykają bariery w dostępie do kultury związane z dojazdem niż rodziny z centrum?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH LocationCategories AS (SELECT id_uczestnika, waga_proby, bariera_dojazd, CASE WHEN miasto_powiat IN ('Katowice', 'Bytom', 'Chorzów', 'Siemianowice Śląskie', 'Świętochłowice', 'Ruda Śląska', 'Zabrze', 'Gliwice', 'Sosnowiec') THEN 'Centrum GZM' ELSE 'Peryferia GZM' END AS lokalizacja FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE) SELECT lokalizacja, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazdu FROM LocationCategories GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Katowic z dzielnic centralnych i bliskich centrum mają wyższe średnie miesięczne wydatki na kulturę niż mieszkańcy dzielnic bardziej oddalonych (peryferyjnych)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH DzielniceKatowic AS ( SELECT dzielnica_katowic, wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Koszutka', 'Os. Paderewskiego - Muchowiec', 'Bogucice', 'Załęże', 'Dąb', 'Wełnowiec-Józefowiec', 'Zawodzie', 'Brynów Część Wschodnia - Os. Zgrzebnioka') THEN 'Dzielnice centralne/bliskie centrum' WHEN dzielnica_katowic IN ('Zarzecze', 'Podlesie', 'Kostuchna', 'Murcki', 'Giszowiec', 'Dąbrówka Mała', 'Janów - Nikiszowiec', 'Ligota-Panewniki', 'Osiedle Tysiąclecia', 'Osiedle Witosa', 'Piotrowice - Ochojec', 'Szopienice-Burowiec', 'Załęska Hałda - Brynów Część Zachodnia') THEN 'Dzielnice peryferyjne/oddalone' ELSE NULL END AS typ_dzielnicy FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT typ_dzielnicy, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM DzielniceKatowic WHERE typ_dzielnicy IS NOT NULL GROUP BY typ_dzielnicy;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest przybliżony średni wiek respondentów uczestniczących w jakiejkolwiek formie kultury cyfrowej w porównaniu do tych, którzy nie uczestniczą?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH AgeMapping AS ( SELECT id_uczestnika, CASE grupa_wiekowa WHEN 'Mniej niż 30' THEN 25 WHEN '30-39' THEN 34.5 WHEN '40-49' THEN 44.5 WHEN '50-59' THEN 54.5 WHEN '60 i więcej' THEN 65 END AS mid_age, waga_proby FROM participation_survey ), DigitalParticipation AS ( SELECT id_uczestnika, ( cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE ) AS uczestniczy_cyfrowo FROM participation_survey ) SELECT dp.uczestniczy_cyfrowo, ROUND(SUM(am.mid_age * am.waga_proby) / SUM(am.waga_proby), 1) AS sredni_wiek FROM AgeMapping am JOIN DigitalParticipation dp ON am.id_uczestnika = dp.id_uczestnika GROUP BY dp.uczestniczy_cyfrowo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedzają pikniki/festyny przynajmniej raz w roku, między mieszkańcami gminy Ożarowice a mieszkańcami gminy Rudziniec (pow. gliwicki).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_festyny_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród mieszkańców zespołu dzielnic zachodnich Katowic, jaka jest średnia miesięczna kwota wydatków na kulturę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby dojeżdżające do pracy komunikacją miejską częściej korzystają z oferty kulturalnej w różnych miastach metropolii niż osoby korzystające z własnego samochodu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN transport_komunikacja_miejska = TRUE AND transport_wlasny_samochod = FALSE THEN 'Komunikacja miejska' WHEN transport_wlasny_samochod = TRUE AND transport_komunikacja_miejska = FALSE THEN 'Własny samochód' ELSE 'Transport mieszany/inny' END AS srodek_transportu, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_rozne_miasta FROM participation_survey WHERE zatrudnienie_pracujacy = TRUE GROUP BY srodek_transportu HAVING srodek_transportu IN ('Komunikacja miejska', 'Własny samochód');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Gierałtowice częściej niż mieszkańcy gminy Pilchowice odwiedzają miejsca kultury w Gliwicach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN miejsce_kultury_gliwice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedza_gliwice FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Ilu dokładnie respondentów (liczba rekordów) z Gliwic należy do grupy wiekowej 40-49 lat?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT COUNT(id_uczestnika) AS liczba_rekordow FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND grupa_wiekowa = '40-49';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic zachodnich Katowic i mieszkańców pobliskiego Chorzowa był ostatnio w kinie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneW AS ( SELECT ostatnio_kino, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Ligota-Panewniki', 'Brynów Część Wschodnia - Os. Zgrzebnioka') ) SELECT 'Zespół dzielnic zachodnich KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM KatowiceZoneW UNION ALL SELECT 'Chorzów (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Chorzów';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Chełm Śląski częściej niż mieszkańcy gminy Bojszowy (ten sam powiat) odwiedzili ostatnio (6 msc) biblioteki?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_biblioteka_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc IN ('Chełm Śląski', 'Bojszowy') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W zespole dzielnic południowych Katowic, jaka aktywność domowa związana z kulturą jest najpopularniejsza: czytanie książek czy oglądanie programów TV?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneS AS ( SELECT kultura_domowa_ksiazki, kultura_domowa_tv, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Czytanie książek' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_ksiazki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS UNION ALL SELECT 'Oglądanie programów TV' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_tv = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Które grupy wiekowe najczęściej myślą o Spodku gdy pyta się ich o GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek'), 2) AS procent FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób korzystających z oferty domów kultury w celu obejrzenia przedstawienia teatralnego między mieszkańcami Bytomia i Zabrza.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN dom_kultury_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_teatr_w_dk FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Zabrze') AND ostatnio_dom_kultury = TRUE GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Dąbrowy Górniczej odwiedził Pałac Kultury Zagłębia (jako dom kultury)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_domu_kultury = 'Pałac Kultury Zagłębia' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_pkz FROM participation_survey WHERE miasto_powiat = 'Dąbrowa Górnicza';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Sosnowcu osoby, które śledzą profile twórców w social mediach, częściej zetknęły się z twórczością lokalnego artysty?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN informacja_social_media_tworcy = TRUE THEN 'Śledzi twórców SM' ELSE 'Nie śledzi twórców SM' END AS sledzenie_sm, ROUND(SUM(CASE WHEN kontakt_z_artysta_lokalnym IN ('tak, wielokrotnie', 'tak, raz czy dwa') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kontakt_lokalny FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND informacja_social_media_tworcy IS NOT NULL GROUP BY sledzenie_sm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Bobrownik i Psar.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Bobrowniki', 'Psary') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Ilu respondentów (ważona liczba) napotykających bariery transportowe mimo to regularnie uczestniczy w wydarzeniach kulturalnych (muzeum lub teatr przynajmniej raz w roku)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN bariera_dojazd = TRUE AND (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') THEN waga_proby ELSE 0 END)) AS liczba_wazona_aktywnych_mimo_barier FROM participation_survey;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby korzystające z ofert domów kultury w celu obejrzenia filmu częściej odwiedzają też kina komercyjne (ostatnie 6 msc)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT dom_kultury_film, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE dom_kultury_film IS NOT NULL GROUP BY dom_kultury_film;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców powiatu tarnogórskiego i mieszkańców Giszowca (Katowice) był ostatnio w domu kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' THEN 'Powiat Tarnogórski' WHEN dzielnica_katowic = 'Giszowiec' THEN 'Giszowiec KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_dom_kultury FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski') OR (dzielnica_katowic = 'Giszowiec') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W powiecie pszczyńskim, które źródło informacji o kulturze jest najmniej popularne: radio czy telewizja?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Radio' AS zrodlo, ROUND(SUM(CASE WHEN informacja_radio = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' UNION ALL SELECT 'Telewizja' AS zrodlo, ROUND(SUM(CASE WHEN informacja_telewizja = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' ORDER BY procent ASC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy różne grupy wiekowe inaczej postrzegają to, czy nakłady na kulturę powinny być wyższe czy niższe?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('1 zupełnie się nie zgadzam', '2', '3') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_za_wiekszymi_wydatkami, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_za_mniejszymi_wydatkami FROM participation_survey WHERE opinia_wydatki_publiczne_na_kulture IS NOT NULL GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Ile kobiet bez wykształcenia wyższego deklaruje że kultura jest dla wszystkich?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, wyksztalcenie, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kobiety_kultura_dla_wszystkich FROM participation_survey WHERE plec = 'Kobieta' AND wyksztalcenie != 'wyższe' GROUP BY plec, wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami zespołu dzielnic śródmiejskich Katowic a resztą Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_muzeum, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Reszta Katowic' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM KatowiceZones GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) stwierdzenia 'Działalność kulturalna jest dla wszystkich' między mieszkańcami gminy Wyry a mieszkańcami gminy Gierałtowice.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_dla_wszystkich = '2' THEN 2 WHEN opinia_kultura_dla_wszystkich = '3' THEN 3 WHEN opinia_kultura_dla_wszystkich = '4' THEN 4 WHEN opinia_kultura_dla_wszystkich = '5' THEN 5 WHEN opinia_kultura_dla_wszystkich = '6' THEN 6 WHEN opinia_kultura_dla_wszystkich = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dla_wszystkich FROM participation_survey WHERE ((miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice')) AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które jako barierę wskazały brak czasu, pracuje w trybie częściowo zdalnym ('częściowo w miejscu pracy, częściowo w domu lub zdalnie')?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN miejsce_wykonywania_pracy = 'częściowo w miejscu pracy, częściowo w domu lub zdalnie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pracujacych_czesciowo_zdalnie FROM participation_survey WHERE bariera_brak_czasu = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Rudziniec i gminy Psary jako źródło informacji o kulturze wskazuje znajomych/rodzinę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_znajomi_rodzina = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_znajomi FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy kobiety z katowickiej części metropolii częściej niż mężczyźni korzystają z kultury w domu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceWomen AS ( SELECT SUM(waga_proby) AS women_weight FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Kobieta' ), KatowiceMen AS ( SELECT SUM(waga_proby) AS men_weight FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Mężczyzna' ), WomenActivities AS ( SELECT waga_proby, CASE WHEN kultura_domowa_tv = TRUE OR kultura_domowa_radio = TRUE OR kultura_domowa_podcasty = TRUE OR kultura_domowa_internet = TRUE OR kultura_domowa_prasa = TRUE OR kultura_domowa_ksiazki = TRUE OR kultura_domowa_inne = TRUE THEN TRUE ELSE FALSE END AS any_cultural_activity FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Kobieta' ), MenActivities AS ( SELECT waga_proby, CASE WHEN kultura_domowa_tv = TRUE OR kultura_domowa_radio = TRUE OR kultura_domowa_podcasty = TRUE OR kultura_domowa_internet = TRUE OR kultura_domowa_prasa = TRUE OR kultura_domowa_ksiazki = TRUE OR kultura_domowa_inne = TRUE THEN TRUE ELSE FALSE END AS any_cultural_activity FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Mężczyzna' ) SELECT 'Kobiety' AS grupa, ROUND( SUM(CASE WHEN any_cultural_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT women_weight FROM KatowiceWomen), 2 ) AS percentage FROM WomenActivities UNION ALL SELECT 'Mężczyźni' AS grupa, ROUND( SUM(CASE WHEN any_cultural_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT men_weight FROM KatowiceMen), 2 ) AS percentage FROM MenActivities ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób z Katowic, które NIGDY nie były w filharmonii/operze i NIE SĄ tym zainteresowane, jaki jest średni wiek?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH AgeMapping AS ( SELECT id_uczestnika, CASE grupa_wiekowa WHEN 'Mniej niż 30' THEN 25 WHEN '30-39' THEN 34.5 WHEN '40-49' THEN 44.5 WHEN '50-59' THEN 54.5 WHEN '60 i więcej' THEN 65 END AS mid_age, waga_proby FROM participation_survey ) SELECT ROUND(SUM(am.mid_age * am.waga_proby) / SUM(am.waga_proby), 1) AS sredni_wiek_niezainteresowanych FROM AgeMapping am JOIN participation_survey ps ON am.id_uczestnika = ps.id_uczestnika WHERE ps.miasto_powiat = 'Katowice' AND ps.czestotliwosc_filharmonia = 'Nigdy i nie jestem tym zainteresowany(a)';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Knurowa i Czeladzi był ostatnio w bibliotece?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Knurów' THEN 'Knurów (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Czeladź' THEN 'Czeladź (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_biblioteka FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Knurów') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Czeladź') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w dzielnicach Katowic o zabytkowej zabudowie (jak Nikiszowiec, Murcki czy Giszowiec) mieszkańcy częściej doceniają kulturę jako element tożsamości lokalnej?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN dzielnica_katowic IN ('Janów - Nikiszowiec', 'Giszowiec', 'Murcki') THEN 'Dzielnice zabytkowe' ELSE 'Pozostałe dzielnice' END AS typ_dzielnicy, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tozsamosc FROM participation_survey WHERE dzielnica_katowic IS NOT NULL GROUP BY typ_dzielnicy;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że taniec jest częścią kultury, częściej uczestniczą w koncertach (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT kultura_taniec, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE kultura_taniec IN ('Tak', 'Nie') GROUP BY kultura_taniec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które 'zdecydowanie' uważają, że najlepszy czas wolny daje dużo radości, częściej chodzą na koncerty (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wolny_czas_definicja_radosc = 'zdecydowanie tak' THEN 'Zdecydowanie radość' ELSE 'Mniej niż zdecydowanie' END AS priorytet_radosc, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE wolny_czas_definicja_radosc IS NOT NULL GROUP BY priorytet_radosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Chorzowa częściej odwiedzają zoo i parki rozrywki niż mieszkańcy innych miast metropolii?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Chorzów' THEN 'Chorzów' ELSE 'Inne miasta' END AS miasto, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE OR czestotliwosc_zoo = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_parki FROM participation_survey GROUP BY miasto;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Związek między wielkością miejscowości zamieszkania a preferencjami dotyczącymi rodzaju wydarzeń kulturalnych (dzielnicowe, miejskie, regionalne, ogólnopolskie).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN wydarzenie_dzielnicowe = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dzielnicowe, ROUND(SUM(CASE WHEN wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_miejskie, ROUND(SUM(CASE WHEN wydarzenie_regionalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_regionalne, ROUND(SUM(CASE WHEN wydarzenie_ogolnopolskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogolnopolskie FROM participation_survey GROUP BY wielkosc_miejscowosci ORDER BY wielkosc_miejscowosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy średnie miesięczne wydatki na kulturę są wyższe w zespole dzielnic śródmiejskich Katowic niż w zespole dzielnic południowych?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby w wieku 40-49 lat w subregionie katowickim częściej jako barierę wskazują brak czasu niż osoby w tym samym wieku w subregionie bytomskim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'BYTOMSKI' THEN 'Bytomski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey WHERE grupa_wiekowa = '40-49' AND subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI', 'BYTOMSKI') GROUP BY subregion_grupa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby w wieku 60+ częściej korzystają z wydarzeń kulturalnych online niż osoby w wieku 18-29 lat?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wydarzenia_online FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami Gliwic (miasto) a mieszkańcami Bierunia (gmina).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń' THEN 'Bieruń (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE (miasto_powiat = 'Gliwice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie gliwickim osoby uważające gotowanie za część kultury wydają średnio więcej na kulturę miesięcznie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT kultura_gotowanie, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND kultura_gotowanie IN ('Tak', 'Nie') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY kultura_gotowanie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedzają zoo przynajmniej raz na 3 lata, między mieszkańcami gminy Ożarowice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_zoo IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Tychów odwiedza Chorzów w celach kulturalnych, a jaki procent mieszkańców Chorzowa odwiedza Tychy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Mieszkańcy Tychów odwiedzający Chorzów' AS grupa, ROUND(SUM(CASE WHEN miejsce_kultury_chorzow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Tychy' UNION ALL SELECT 'Mieszkańcy Chorzowa odwiedzający Tychy' AS grupa, ROUND(SUM(CASE WHEN miejsce_kultury_tychy = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Chorzów';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) stwierdzenia 'Bez dostępu do kultury życie byłoby uboższe' wśród osób, które nie odwiedziły żadnej instytucji kultury w ostatnich 6 miesiącach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_ubozsze_zycie = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_ubozsze_zycie = '2' THEN 2 WHEN opinia_kultura_ubozsze_zycie = '3' THEN 3 WHEN opinia_kultura_ubozsze_zycie = '4' THEN 4 WHEN opinia_kultura_ubozsze_zycie = '5' THEN 5 WHEN opinia_kultura_ubozsze_zycie = '6' THEN 6 WHEN opinia_kultura_ubozsze_zycie = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_ubozsze FROM participation_survey WHERE ostatnio_zadne = TRUE AND opinia_kultura_ubozsze_zycie IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie platformy cyfrowe (YouTube, FB, Instagram) są najczęściej używane do celów kulturalnych przez osoby w wieku 30-39 lat?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39') SELECT platform, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'YouTube' AS platform, kultura_online_youtube AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' UNION ALL SELECT 'Facebook' AS platform, kultura_online_facebook AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' UNION ALL SELECT 'Instagram' AS platform, kultura_online_instagram AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' ) subquery WHERE selected = TRUE GROUP BY platform ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że urządzanie mieszkania to część kultury, częściej czytają prasę kulturalną (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT kultura_urzadzanie_mieszkania, ROUND(SUM(CASE WHEN czestotliwosc_prasa_kulturalna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czyta_prase_kult FROM participation_survey WHERE kultura_urzadzanie_mieszkania IN ('Tak', 'Nie') GROUP BY kultura_urzadzanie_mieszkania;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie jest prawdopodobieństwo (w procentach), że osoba odwiedzająca teatr (przynajmniej raz na 3 lata) odwiedza również muzea (przynajmniej raz na 3 lata)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH WeightedTheaterAttendeesTotal AS ( SELECT SUM(waga_proby) AS total_theater_weight FROM participation_survey WHERE czestotliwosc_teatr IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' ) ) SELECT ROUND( SUM(CASE WHEN czestotliwosc_muzeum IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' ) THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total_theater_weight FROM WeightedTheaterAttendeesTotal), 2) AS prawdopodobienstwo_procentowe FROM participation_survey WHERE czestotliwosc_teatr IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' );<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Pilchowice i gminy Ożarowice uważa, że 'fotografia' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_fotografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_foto_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Katowicach mężczyźni i kobiety w podobnym stopniu angażują się w twórczość artystyczną?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE miasto_powiat = 'Katowice' AND plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W Gliwicach, jaka jest średnia ocena (1-7) stwierdzenia 'Udział w wydarzeniach kulturalnych zapewnia przeżycia'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_przezycia = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przezycia = '2' THEN 2 WHEN opinia_kultura_przezycia = '3' THEN 3 WHEN opinia_kultura_przezycia = '4' THEN 4 WHEN opinia_kultura_przezycia = '5' THEN 5 WHEN opinia_kultura_przezycia = '6' THEN 6 WHEN opinia_kultura_przezycia = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przezycia FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND opinia_kultura_przezycia IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie bariery uczestnictwa w kulturze (procent wskazań dla każdej) są najczęściej wymieniane przez najmłodszą ('Mniej niż 30') i najstarszą ('60 i więcej') grupę wiekową?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_oferta, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_info, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dostep_fizyczny, ROUND(SUM(CASE WHEN bariera_nieznajomosc_oferty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_nieznajomosc FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia miesięczna kwota wydatków na kulturę w Będzinie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_bedzin FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Będzin' AND wydatki_na_kulture_kwota IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Psar i Ożarowic wskazuje 'mało atrakcyjną ofertę' jako barierę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_oferta FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Sosnowca częściej odwiedzają instytucje kultury w Katowicach niż mieszkańcy Bytomia?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN miejsce_kultury_katowice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_katowice FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Bytom') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie wydatki na kulturę między mieszkańcami zespołu dzielnic śródmiejskich i zespołu dzielnic zachodnich Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic zachodnich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy katowickich osiedli modernistycznych (np. Tysiąclecia, Paderewskiego, Witosa) mają inne preferencje dotyczące uczestnictwa w wydarzeniach kulturalnych (w ostatnich 6 msc) niż mieszkańcy starszych, robotniczych dzielnic Katowic (np. Nikiszowiec, Załęże)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceDistrictTypes AS ( SELECT dzielnica_katowic, ostatnio_teatr, ostatnio_koncert, ostatnio_kino, ostatnio_dom_kultury, ostatnio_zoo, ostatnio_spotkanie_z_artysta, waga_proby, CASE WHEN dzielnica_katowic IN ('Osiedle Tysiąclecia', 'Os. Paderewskiego - Muchowiec', 'Osiedle Witosa') THEN 'Osiedla modernistyczne (Kato)' WHEN dzielnica_katowic IN ('Śródmieście', 'Załęże', 'Janów - Nikiszowiec', 'Giszowiec', 'Szopienice-Burowiec', 'Bogucice', 'Dąb', 'Wełnowiec-Józefowiec', 'Zawodzie') THEN 'Stare dzielnice (Kato)' ELSE 'Inne/Nieklasyfikowane (Kato)' END AS typ_zabudowy FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT typ_zabudowy, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr_proc, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty_proc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino_proc, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS dom_kultury_proc, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS zoo_proc, ROUND(SUM(CASE WHEN ostatnio_spotkanie_z_artysta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS spotkania_artysta_proc FROM KatowiceDistrictTypes WHERE typ_zabudowy IN ('Osiedla modernistyczne (Kato)', 'Stare dzielnice (Kato)') GROUP BY typ_zabudowy;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia liczba różnych aktywności kulturalnych (mierzona roczną frekwencją), w których uczestniczy każda grupa segmentu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH AnnualParticipation AS ( SELECT id_uczestnika, waga_proby, segment_uczestnika, ( (czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_prasa_kulturalna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_nagrania_teatralne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_programy_kulturalne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_wyklady = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_wydarzenia_literackie = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_archiwa = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_zoo = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_rekonstrukcja_historyczna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int ) AS num_annual_activities FROM participation_survey WHERE segment_uczestnika IS NOT NULL ) SELECT segment_uczestnika, ROUND(SUM(num_annual_activities * waga_proby) / SUM(waga_proby), 2) AS srednia_liczba_aktywnosci_rocznie FROM AnnualParticipation GROUP BY segment_uczestnika ORDER BY srednia_liczba_aktywnosci_rocznie DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy emeryci w Gliwicach częściej niż emeryci w Bytomiu jako barierę wskazują wysokie ceny?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny FROM participation_survey WHERE zatrudnienie_emeryt = TRUE AND miasto_powiat IN ('Gliwice', 'Bytom') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic północnych Katowic i mieszkańców powiatu będzińskiego był ostatnio na koncercie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneN AS ( SELECT ostatnio_koncert, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') ) SELECT 'Zespół dzielnic północnych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM KatowiceZoneN UNION ALL SELECT 'Powiat Będziński' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE miasto_powiat = 'Powiat będziński';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę istotności uczestnictwa w kulturze (skala 1-7) między osobami, które jako główne źródło informacji wskazują znajomych/rodzinę, a tymi, które wskazują lokalne portale internetowe.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH InfoSource AS ( SELECT id_uczestnika, waga_proby, istotnosc_uczestnictwa_w_kulturze, CASE WHEN informacja_znajomi_rodzina = TRUE AND informacja_portale_lokalne = FALSE THEN 'Znajomi/Rodzina (głównie)' WHEN informacja_portale_lokalne = TRUE AND informacja_znajomi_rodzina = FALSE THEN 'Portale Lokalne (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo FROM participation_survey WHERE informacja_znajomi_rodzina = TRUE OR informacja_portale_lokalne = TRUE ) SELECT glowne_zrodlo, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM InfoSource WHERE glowne_zrodlo IN ('Znajomi/Rodzina (głównie)', 'Portale Lokalne (głównie)') AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY glowne_zrodlo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Nikiszowca bardziej cenią dziedzictwo kulturowe niż mieszkańcy innych katowickich dzielnic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN dzielnica_katowic = 'Janów - Nikiszowiec' THEN 'Nikiszowiec' ELSE 'Inne dzielnice Katowic' END AS grupa_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') OR definicja_kultury_kategoria = 'Dziedzictwo/historia/narodowość/regionalność/tożsamość' OR kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wartosc_dziedzictwa FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL GROUP BY grupa_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób śledzących profile instytucji kultury na Facebooku między zespołem dzielnic zachodnich i wschodnich Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT facebook_profile_instytucji, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN facebook_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_inst_fb FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic zachodnich', 'Zespół dzielnic wschodnich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które podejmują jakąkolwiek aktywność twórczą (np. gra na instrumencie, pisanie, fotografia etc.), częściej uważają, że kultura pozwala im się realizować (ocena 6-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN 'Podejmuje aktywność twórczą' ELSE 'Nie podejmuje aktywności twórczej' END AS status_tworczosci, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_samorealizacja FROM participation_survey GROUP BY status_tworczosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) stwierdzenia 'Konsumpcja kultury sprawia przyjemność' wśród osób z segmentu 'Młodzi Uciekinierzy'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosc FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy' AND opinia_kultura_przyjemnosc IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które korzystają z kultury poza GZM, częściej odwiedzają muzea (rocznie) niż osoby, które tego nie robią?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT uczestnictwo_poza_gzm_czas, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE uczestnictwo_poza_gzm_czas IS NOT NULL GROUP BY uczestnictwo_poza_gzm_czas;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między osobami z niepełnosprawnością słuchu a osobami z niepełnosprawnością wzroku.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN niepelnosprawnosc_sluch = TRUE THEN 'Niepełnosprawność słuchu' WHEN niepelnosprawnosc_wzrok = TRUE THEN 'Niepełnosprawność wzroku' END AS typ_niepelnosprawnosci, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_wzrok = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY typ_niepelnosprawnosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) dostępności kultury w GZM między mieszkańcami gminy Gierałtowice a mieszkańcami gminy Pilchowice.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice') AND ocena_dostepu_do_kultury_gzm IS NOT NULL GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród mieszkańców zespołu dzielnic zachodnich Katowic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ocena_dostepu_do_kultury_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że kultura daje poczucie przynależności (ocena 6-7), częściej uczestniczą w wydarzeniach regionalnych?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Przynależność)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_przynaleznosc, ROUND(SUM(CASE WHEN wydarzenie_regionalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wyd_regionalne FROM participation_survey WHERE opinia_kultura_przynaleznosc IS NOT NULL GROUP BY opinia_przynaleznosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Gierałtowice i gminy Bobrowniki uważa, że 'moralność' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_moralnosc = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moralnosc_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób wskazujących 'wysokie ceny' jako barierę między mieszkańcami Dąbrowy Górniczej a mieszkańcami Mierzęcic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Dąbrowa Górnicza' THEN 'Dąbrowa Górnicza (Miasto)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny FROM participation_survey WHERE (miasto_powiat = 'Dąbrowa Górnicza') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że wypada być na bieżąco z kulturą (ocena 6-7), częściej śledzą profile instytucji kultury na Instagramie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN opinia_kultura_bycie_na_biezaco IN ('6', '7 w pełni sie zgadzam') THEN 'Uważa, że wypada (6-7)' ELSE 'Nie uważa, że wypada / Mniej (1-5)' END AS opinia_status, ROUND(SUM(CASE WHEN instagram_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzacych_instytucje_ig FROM participation_survey WHERE opinia_kultura_bycie_na_biezaco IS NOT NULL GROUP BY opinia_status;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z wyższym wykształceniem w Zabrzu uważa, że moda to część kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kultura_moda = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moda_kultura FROM participation_survey WHERE miasto_powiat = 'Zabrze' AND wyksztalcenie = 'wyższe';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedziły Muzeum Śląskie, między mieszkańcami Katowic a mieszkańcami Bytomia.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum Śląskie w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_msl FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Bytom') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy wizyty w teatrze są popularniejsze wśród osób z wyższym wykształceniem mieszkających w Gliwicach czy w Katowicach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr FROM participation_survey WHERE wyksztalcenie = 'wyższe' AND miasto_powiat IN ('Gliwice', 'Katowice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Ilu studentów z Sosnowca/Bytomia preferuje wydarzenia regionalne a ilu miejskie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, event_type, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM ( SELECT miasto_powiat, 'Regionalne' AS event_type, wydarzenie_regionalne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Miejskie' AS event_type, wydarzenie_miejskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Dzielnicowe' AS event_type, wydarzenie_dzielnicowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Ogólnopolskie' AS event_type, wydarzenie_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Międzynarodowe' AS event_type, wydarzenie_miedzynarodowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Niezależne od podziałów admin.' AS event_type, wydarzenie_niezalezne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE ) subquery WHERE selected = TRUE GROUP BY miasto_powiat, event_type ORDER BY miasto_powiat, procent_w_miescie DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka kombinacja aktywności kulturalnych (roczna frekwencja: muzeum, teatr, koncert) jest najczęstsza (procentowo) wśród młodych profesjonalistów (30-39 lat, wyższe wykształcenie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH TargetGroup AS ( SELECT id_uczestnika, waga_proby, (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS museum_yr, (czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS theater_yr, (czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS concert_yr FROM participation_survey WHERE grupa_wiekowa = '30-39' AND wyksztalcenie = 'wyższe' ), TotalWeight AS ( SELECT SUM(waga_proby) AS total FROM TargetGroup ) SELECT museum_yr, theater_yr, concert_yr, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalWeight), 2) AS procent_kombinacji FROM TargetGroup GROUP BY museum_yr, theater_yr, concert_yr ORDER BY procent_kombinacji DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z powiatu pszczyńskiego uważa, że 'uprawianie ogrodu' to część kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kultura_ogrodnictwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogrod_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Gliwic odwiedzających muzea w ciągu ostatnich 6 miesięcy odwiedziło Muzeum w Gliwicach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum w Gliwicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_mgliwice_wsrod_odwiedzajacych FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND ostatnio_muzeum = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Zabrza i mieszkańców Zbrosławic odwiedza teatr przynajmniej raz w roku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Zabrze' THEN 'Zabrze (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_rocznie FROM participation_survey WHERE (miasto_powiat = 'Zabrze') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie miejsca w GZM są najczęsciej odwiedzane przez osoby które uczestniczą w kulturze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey) SELECT miejsce_w_gzm, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Bytom' AS miejsce_w_gzm, miejsce_kultury_bytom AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Chorzów' AS miejsce_w_gzm, miejsce_kultury_chorzow AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Dąbrowa Górnicza' AS miejsce_w_gzm, miejsce_kultury_dabrowa_gornicza AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Gliwice' AS miejsce_w_gzm, miejsce_kultury_gliwice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Katowice' AS miejsce_w_gzm, miejsce_kultury_katowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Mysłowice' AS miejsce_w_gzm, miejsce_kultury_myslowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Piekary Śląskie' AS miejsce_w_gzm, miejsce_kultury_piekary_slaskie AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Ruda Śląska' AS miejsce_w_gzm, miejsce_kultury_ruda_slaska AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Siemianowice Śląskie' AS miejsce_w_gzm, miejsce_kultury_siemianowice_slaskie AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Sosnowiec' AS miejsce_w_gzm, miejsce_kultury_sosnowiec AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Świętochłowice' AS miejsce_w_gzm, miejsce_kultury_swietochlowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Tychy' AS miejsce_w_gzm, miejsce_kultury_tychy AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Zabrze' AS miejsce_w_gzm, miejsce_kultury_zabrze AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Inne' AS miejsce_w_gzm, miejsce_kultury_inne AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Nie pamiętam' AS miejsce_w_gzm, miejsce_kultury_nie_pamietam AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Żadne' AS miejsce_w_gzm, miejsce_kultury_zadne AS selected, waga_proby FROM participation_survey ) subquery WHERE selected = TRUE GROUP BY miejsce_w_gzm ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest rozkład kategorii dla 'Innych problemów' jako barier uczestnictwa (pokaż top 3)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT bariera_inne_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE bariera_inne = TRUE), 2) AS procent FROM participation_survey WHERE bariera_inne = TRUE AND bariera_inne_kategoria IS NOT NULL AND bariera_inne_kategoria NOT IN ('Inne', 'Nie wiem, trudno powiedzieć') GROUP BY bariera_inne_kategoria ORDER BY procent DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Śródmieścia Katowic a mieszkańcami powiatu mikołowskiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN dzielnica_katowic = 'Śródmieście' THEN 'Śródmieście KTW (Dzielnica)' WHEN miasto_powiat = 'Powiat mikołowski' THEN 'Powiat Mikołowski' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (dzielnica_katowic = 'Śródmieście') OR (miasto_powiat = 'Powiat mikołowski') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób odwiedzających Bytom w celach kulturalnych między mieszkańcami Chorzowa i Zabrza.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN miejsce_kultury_bytom = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedza_bytom FROM participation_survey WHERE miasto_powiat IN ('Chorzów', 'Zabrze') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Tychów i powiatu pszczyńskiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE miasto_powiat IN ('Tychy', 'Powiat pszczyński') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) wpływu kultury na atrakcyjność regionu wśród mieszkańców subregionu sosnowieckiego?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_atrakcyjnosc_regionu = '2' THEN 2 WHEN opinia_kultura_atrakcyjnosc_regionu = '3' THEN 3 WHEN opinia_kultura_atrakcyjnosc_regionu = '4' THEN 4 WHEN opinia_kultura_atrakcyjnosc_regionu = '5' THEN 5 WHEN opinia_kultura_atrakcyjnosc_regionu = '6' THEN 6 WHEN opinia_kultura_atrakcyjnosc_regionu = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_atrakcyjnosc FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' AND opinia_kultura_atrakcyjnosc_regionu IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami Knurowa a resztą powiatu gliwickiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN gmina_miejscowosc = 'Knurów' THEN 'Knurów' ELSE 'Reszta Powiatu Gliwickiego' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' GROUP BY obszar;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie są średnie miesięczne wydatki na kulturę w katowickich dzielnicach Ligota-Panewniki i Piotrowice-Ochojec?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT dzielnica_katowic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE dzielnica_katowic IN ('Ligota-Panewniki', 'Piotrowice - Ochojec') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY dzielnica_katowic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Sosnowca inaczej definiują kulturę niż mieszkańcy Bytomia?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, definicja_kultury_kategoria, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Bytom') AND definicja_kultury_kategoria IS NOT NULL AND definicja_kultury_kategoria NOT IN ('Nie wiem, trudno powiedzieć') GROUP BY miasto_powiat, definicja_kultury_kategoria ORDER BY miasto_powiat, procent_w_miescie DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Bytomia a mieszkańcami mniejszych miejscowości o charakterze wiejskim z GZM.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom (Miasto)' WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Miejscowości i wsie' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Bytom') OR (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Śródmieścia Katowic i reszty Katowic był ostatnio w teatrze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN dzielnica_katowic = 'Śródmieście' THEN 'Śródmieście' ELSE 'Reszta Katowic' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Katowice' GROUP BY obszar;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie są główne sposoby dostępu do internetu w powiecie gliwickim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki') SELECT access_method, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'W domu' AS access_method, internet_w_domu AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' UNION ALL SELECT 'W pracy' AS access_method, internet_w_pracy AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' UNION ALL SELECT 'W telefonie komórkowym' AS access_method, internet_w_telefonie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' ) subquery WHERE selected = TRUE GROUP BY access_method ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Katowic, a jaki procent mieszkańców reszty GZM (bez Katowic) jest w stanie wymienić przynajmniej jednego twórcę kultury cyfrowej (na podstawie odpowiedzi na `znajomosc_tworcy_cyfrowego_1`)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN znajomosc_tworcy_cyfrowego_1 IS NOT NULL AND kategoria_tworcy_cyfrowego_1 != 'Nie wiem, trudno powiedzić' AND kategoria_tworcy_cyfrowego_1 != 'brak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_znajacych_tworce FROM participation_survey WHERE miasto_powiat IS NOT NULL GROUP BY obszar;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy GZM częściej uczestniczą w wydarzeniach muzycznych (koncerty/filharmonia) niż w życiu literackim (czytanie książek/wydarzenia literackie) przynajmniej raz w roku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Muzyka (Uczestnictwo roczne)' AS element, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey UNION ALL SELECT 'Literatura (Uczestnictwo roczne)' AS element, ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_wydarzenia_literackie = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które odwiedziły zoo w ciągu ostatnich 6 miesięcy, częściej wskazują rodzinę jako powód spędzania wolnego czasu (odp 'zdecydowanie tak')?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ostatnio_zoo, ROUND(SUM(CASE WHEN wolny_czas_definicja_rodzina = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rodzina_priorytet FROM participation_survey WHERE ostatnio_zoo IS NOT NULL GROUP BY ostatnio_zoo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie 3 formy kultury cyfrowej są najpopularniejsze wśród osób w wieku 30-39 lat w subregionie tyskim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI') SELECT digital_form, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wydarzenia kulturalne online' AS digital_form, cyfrowa_kultura_wydarzenia_online AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Interaktywne wystawy' AS digital_form, cyfrowa_kultura_wystawy_interaktywne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Sztuka nowych mediów' AS digital_form, cyfrowa_kultura_nowe_media AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Podcasty' AS digital_form, cyfrowa_kultura_podcasty AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Social Media (YT/TikTok)' AS digital_form, cyfrowa_kultura_social_media AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Wsparcie finansowe artystów GZM' AS digital_form, cyfrowa_kultura_wsparcie_artystow AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Interaktywne instalacje dźwiękowe' AS digital_form, cyfrowa_kultura_instalacje_dzwiekowe AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Gry komputerowe i gaming' AS digital_form, cyfrowa_kultura_gry AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'VR / Immersja' AS digital_form, cyfrowa_kultura_vr AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Inne formy cyfrowe' AS digital_form, cyfrowa_kultura_inne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Żadne z wymienionych form' AS digital_form, cyfrowa_kultura_zadne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' ) subquery WHERE selected = TRUE GROUP BY digital_form ORDER BY percentage DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w subregionie tyskim bariera 'brak oferty lokalnej' jest częściej wskazywana przez osoby mieszkające na wsi niż w miastach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wielkosc_miejscowosci = 'wieś' THEN 'Wieś' ELSE 'Miasto' END AS typ_miejscowosci, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_lokalna FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' GROUP BY typ_miejscowosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Pilchowice i gminy Zbrosławice wskazuje 'problemy z dojazdem' jako barierę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy gminy Siewierz częściej niż mieszkańcy gminy Czeladź odwiedzili ostatnio (6 msc) bibliotekę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_biblioteka_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Siewierz', 'Czeladź') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy istnieje różnica między mieszkańcami Katowic i Gliwic w tym, jak postrzegają wpływ kultury na relacje międzyludzkie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pozytywne_relacje FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak rozkłada się preferencja skali wydarzeń kulturalnych (procentowo) w różnych grupach wiekowych?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT grupa_wiekowa, SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa IS NOT NULL GROUP BY grupa_wiekowa) SELECT p.grupa_wiekowa, sub.preference_type, ROUND(SUM(CASE WHEN sub.selected = TRUE THEN p.waga_proby ELSE 0 END) * 100.0 / MAX(twt.total), 2) AS percentage FROM participation_survey p JOIN ( SELECT id_uczestnika, 'Dzielnicowe' AS preference_type, wydarzenie_dzielnicowe AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Miejskie' AS preference_type, wydarzenie_miejskie AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Regionalne' AS preference_type, wydarzenie_regionalne AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Ogólnopolskie' AS preference_type, wydarzenie_ogolnopolskie AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Międzynarodowe' AS preference_type, wydarzenie_miedzynarodowe AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Niezależne od podziałów admin.' AS preference_type, wydarzenie_niezalezne AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Trudno powiedzieć' AS preference_type, wydarzenie_brak_opinii AS selected FROM participation_survey ) sub ON p.id_uczestnika = sub.id_uczestnika JOIN total_weight_target twt ON p.grupa_wiekowa = twt.grupa_wiekowa WHERE sub.selected = TRUE AND p.grupa_wiekowa IS NOT NULL GROUP BY p.grupa_wiekowa, sub.preference_type ORDER BY p.grupa_wiekowa, percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Tychów odwiedził Teatr Rozrywki w Chorzowie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Rozrywki w Chorzowie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_trozrywki FROM participation_survey WHERE miasto_powiat = 'Tychy';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) stwierdzenia 'Konsumpcja kultury sprawia przyjemność' między Mierzęcicami a Wyrami.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosc FROM participation_survey WHERE ((miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry')) AND opinia_kultura_przyjemnosc IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent segmentu 'Konsumenci Kultury Instytucjonalnej' odwiedził zarówno teatr, jak i muzeum w ciągu ostatniego roku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' AND czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_i_muzeum_rocznie FROM participation_survey WHERE segment_uczestnika = 'Konsumenci Kultury Instytucjonalnej';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami gminy Rudziniec a mieszkańcami gminy Ożarowice (pow. tarnogórski).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak rozkłada się status zatrudnienia wśród osób z wykształceniem wyższym?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE wyksztalcenie = 'wyższe') SELECT employment_status, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Bezrobotny/nie pracuje/zajmuje się domem' AS employment_status, zatrudnienie_bezrobotny AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Zatrudniony/-a' AS employment_status, zatrudnienie_pracujacy AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Samozatrudniony/-a' AS employment_status, zatrudnienie_samozatrudniony AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Uczy się/studiuje' AS employment_status, zatrudnienie_student AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Rencista/-ka' AS employment_status, zatrudnienie_rencista AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Emeryt/-ka' AS employment_status, zatrudnienie_emeryt AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' ) subquery WHERE selected = TRUE GROUP BY employment_status ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Katowic i subregionu tyskiego zgadza się (ocena 6-7), że kultura jest dla wszystkich?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_dla_wszystkich FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'TYSKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby samozatrudnione częściej niż osoby zatrudnione na etacie śledzą profile twórców na Facebooku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH EmploymentStatus AS ( SELECT CASE WHEN zatrudnienie_samozatrudniony = TRUE THEN 'Samozatrudniony' WHEN zatrudnienie_pracujacy = TRUE THEN 'Zatrudniony na etacie' ELSE 'Inny status' END AS status_zatrudnienia, facebook_profile_tworcow, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE OR zatrudnienie_pracujacy = TRUE ) SELECT status_zatrudnienia, ROUND(SUM(CASE WHEN facebook_profile_tworcow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzacych_tworcow_fb FROM EmploymentStatus GROUP BY 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) istotności kultury między mieszkańcami Tychów a mieszkańcami gminy Kobiór.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Tychy' THEN 'Tychy (Miasto)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE (miasto_powiat = 'Tychy') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami zespołu dzielnic północnych i południowych Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które deklarują, że najlepszy czas wolny pozwala im stworzyć coś własnymi rękoma ('zdecydowanie tak'), częściej odwiedzają domy kultury (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wolny_czas_definicja_rekodzielo = 'zdecydowanie tak' THEN 'Zdecydowanie rękodzieło' ELSE 'Mniej niż zdecydowanie' END AS priorytet_rekodzielo, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE wolny_czas_definicja_rekodzielo IS NOT NULL GROUP BY priorytet_rekodzielo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie jest najczęstsze skojarzenie z wydarzeniami kulturalnymi GZM wśród osób w wieku 60+?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT skojarzenia_wydarzenia_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE grupa_wiekowa = '60 i więcej'), 2) AS procent_wskazan FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' AND skojarzenia_wydarzenia_gzm_1_kategoria IS NOT NULL AND skojarzenia_wydarzenia_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_wydarzenia_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które jako barierę wskazały problemy z dojazdem, korzysta głównie z komunikacji miejskiej?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN transport_komunikacja_miejska = TRUE AND transport_wlasny_samochod = FALSE AND transport_komunikacja_regionalna = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_glownie_kom_miejska FROM participation_survey WHERE bariera_dojazd = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent właścicieli firm z sektora MŚP w GZM jest zainteresowany sponsorowaniem kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN zainteresowanie_sponsorowaniem_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zainteresowanych_sponsorowaniem FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) istotności kultury wśród mieszkańców powiatu bieruńsko-lędzińskiego?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Katowic i Gliwic uważa, że patriotyzm to część kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Rudzie Śląskiej osoby śledzące profile instytucji w social mediach częściej odwiedzają muzea (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN informacja_social_media_instytucje = TRUE THEN 'Śledzi inst. SM' ELSE 'Nie śledzi inst. SM' END AS sledzenie_sm, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE miasto_powiat = 'Ruda Śląska' AND informacja_social_media_instytucje IS NOT NULL GROUP BY sledzenie_sm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób zgadzających się (ocena 5-7), że dzięki kulturze można nawiązywać relacje, między zespołem dzielnic śródmiejskich i północnych Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT opinia_kultura_relacje_miedzyludzkie, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') THEN 'Zespół dzielnic północnych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_relacje FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic północnych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród osób, które nie odwiedziły żadnego miejsca kultury poza swoim miastem zamieszkania?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE uczestnictwo_miejsce_zamieszkania = TRUE AND uczestnictwo_miejsce_pracy = FALSE AND uczestnictwo_inne_miejsce_gzm = FALSE AND uczestnictwo_poza_gzm = FALSE AND ocena_dostepu_do_kultury_gzm IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie są średnie miesięczne wydatki na kulturę w regionie bytomskim i sosnowieckim GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Psary i gminy Kobiór wskazuje 'brak czasu' jako barierę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby pracujące w sektorze kultury częściej umniejszają rolę kultury w życiu społecznym i prywatnym?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT praca_w_sektorze_kultury, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') OR opinia_kultura_dla_wszystkich IN ('1', '2', '3', '4') OR opinia_kultura_bycie_na_biezaco IN ('1', '2', '3', '4') OR opinia_kultura_relacje_miedzyludzkie IN ('1', '2', '3', '4') OR opinia_kultura_przezycia IN ('1', '2', '3', '4') OR opinia_kultura_nowe_miejsca IN ('1', '2', '3', '4') OR opinia_kultura_atrakcyjnosc_regionu IN ('1', '2', '3', '4') OR opinia_kultura_przynaleznosc IN ('1', '2', '3', '4') OR opinia_kultura_samorealizacja IN ('1', '2', '3', '4') OR opinia_kultura_sens_zycia IN ('1', '2', '3', '4') OR opinia_kultura_prestiz IN ('1', '2', '3', '4') OR opinia_kultura_przyjemnosc IN ('1', '2', '3', '4') OR opinia_kultura_ubozsze_zycie IN ('1', '2', '3', '4') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_negatywnych_opinii FROM participation_survey GROUP BY praca_w_sektorze_kultury;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W zespole dzielnic wschodnich Katowic, czy mieszkańcy częściej korzystają z oferty Biblioteki Śląskiej (implikowane przez 'biblioteka') niż Teatru Śląskiego?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneE AS ( SELECT ostatnio_biblioteka, kategoria_odwiedzonego_teatru, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') ) SELECT 'Biblioteka (ost. 6 msc)' AS instytucja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE UNION ALL SELECT 'Teatr Śląski (ost. wizyta)' AS instytucja, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Śląski im. Stanisława Wyspiańskiego w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W zespole dzielnic zachodnich Katowic, które źródło informacji o kulturze jest najpopularniejsze: plakaty czy znajomi/rodzina?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneW AS ( SELECT informacja_plakaty, informacja_znajomi_rodzina, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') ) SELECT 'Plakaty/Ogłoszenia' AS zrodlo, ROUND(SUM(CASE WHEN informacja_plakaty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneW UNION ALL SELECT 'Znajomi/Rodzina' AS zrodlo, ROUND(SUM(CASE WHEN informacja_znajomi_rodzina = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneW;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby w wieku 30-39 lat częściej niż osoby 50-59 lat korzystają z oferty bibliotek w celach innych niż wypożyczanie książek?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(CASE WHEN biblioteka_wypozyczanie_innych_rzeczy = TRUE OR biblioteka_spotkanie_z_artysta = TRUE OR biblioteka_prelekcja = TRUE OR biblioteka_wystawa = TRUE OR biblioteka_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_inne_cele_bibl FROM participation_survey WHERE grupa_wiekowa IN ('30-39', '50-59') GROUP BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak wygląda rozkład wydatków na kulturę wśród osób z wyższym wykształceniem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wydatki_na_kulture_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wyksztalcenie = 'wyższe'), 2) AS procent FROM participation_survey WHERE wyksztalcenie = 'wyższe' GROUP BY wydatki_na_kulture_kategoria ORDER BY CASE wydatki_na_kulture_kategoria WHEN 'Mniej niż 50' THEN 1 WHEN '50-99' THEN 2 WHEN '100-149' THEN 3 WHEN '150-199' THEN 4 WHEN '200-249' THEN 5 WHEN '250 i więcej' THEN 6 WHEN 'Zero / Nie wiem, trudno powiedzieć' THEN 7 END;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które czerpią informacje o kulturze od znajomych i rodziny, częściej uczestniczą w piknikach i festynach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT informacja_znajomi_rodzina, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czestotliwosc_piknik, ROUND(SUM(CASE WHEN czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czestotliwosc_festyn FROM participation_survey GROUP BY informacja_znajomi_rodzina;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób w GZM, które opiekują się dzieckiem poniżej 13 r.ż., wskazuje 'opiekę nad inną osobą' jako barierę w uczestnictwie w kulturze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN bariera_opieka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_opieka FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie pszczyńskim osoby częściej odwiedzają Muzeum Zamkowe w Pszczynie (jako muzeum) niż inne muzea?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Muzeum Zamkowe Pszczyna' AS muzeum, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum Zamkowe w Pszczynie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wskazan FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' AND ostatnio_muzeum = TRUE UNION ALL SELECT 'Inne Muzea' AS muzeum, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum != 'Muzeum Zamkowe w Pszczynie' AND ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wskazan FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' AND ostatnio_muzeum = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Które z tradycyjnych form spędzania czasu w domu (czytanie książek, prasa, tv, radio) dominują wśród osób z najwyższymi zarobkami?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł') SELECT aktywnosc_domowa, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Czytanie książek dla przyjemności' AS aktywnosc_domowa, kultura_domowa_ksiazki AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Czytanie prasy drukowanej' AS aktywnosc_domowa, kultura_domowa_prasa AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Oglądanie programów w TV' AS aktywnosc_domowa, kultura_domowa_tv AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Słuchanie audycji w radiu' AS aktywnosc_domowa, kultura_domowa_radio AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Żadne z powyższych form uczestnictwa w kulturze w domu' AS aktywnosc_domowa, kultura_domowa_zadne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' ) subquery WHERE selected = TRUE GROUP BY aktywnosc_domowa ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest rozkład odpowiedzi na pytanie o częstotliwość wizyt w kinie wśród mieszkańców dzielnicy Katowic: Osiedle Tysiąclecia?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT czestotliwosc_kino, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE dzielnica_katowic = 'Osiedle Tysiąclecia'), 2) AS procent_odpowiedzi FROM participation_survey WHERE dzielnica_katowic = 'Osiedle Tysiąclecia' AND czestotliwosc_kino IS NOT NULL GROUP BY czestotliwosc_kino ORDER BY CASE czestotliwosc_kino WHEN 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 1 WHEN 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN 2 WHEN 'Dawniej niż w ciągu ostatnich 3 lat' THEN 3 WHEN 'Nigdy, ale chciał(a)bym w przyszłości' THEN 4 WHEN 'Nigdy i nie jestem tym zainteresowany(a)' THEN 5 ELSE 6 END;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które zgadzają się (ocena 5-7), że kultura jest dla wszystkich, między mieszkańcami Tychów a mieszkańcami Lędzin\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Tychy' THEN 'Tychy (Miasto)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Lędziny' THEN 'Lędziny (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE (miasto_powiat = 'Tychy') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Lędziny') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które korzystają z transportu pieszego jako jednego ze środków, częściej uczestniczą w kulturze w miejscu zamieszkania?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT transport_pieszo, ROUND(SUM(CASE WHEN uczestnictwo_miejsce_zamieszkania = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_lokalnie FROM participation_survey WHERE transport_pieszo IS NOT NULL GROUP BY transport_pieszo;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedziły ostatnio (6 msc) zoo, między mieszkańcami zespołu dzielnic północnych i południowych Katowic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_zoo, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_6msc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które jako powód braku uczestnictwa wskazują 'wysoką cenę biletów', między mieszkańcami Bytomia i Tychów.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN powod_braku_uczestnictwa_kategoria = 'Wysoka cena biletów' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_cena FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Tychy') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Katowic częściej wybierają kulturę wysoką (opera, filharmonia, galerie) niż mieszkańcy miast satelickich jak Mikołów czy Mysłowice?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' WHEN miasto_powiat IN ('Mysłowice', 'Powiat mikołowski') THEN 'Miasta satelickie' END AS typ_miasta, ROUND(SUM(CASE WHEN czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR ostatnio_filharmonia = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_wysoka FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Mysłowice', 'Powiat mikołowski') GROUP BY typ_miasta;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które preferują wydarzenia o zasięgu miejskim, między mieszkańcami Gliwic a mieszkańcami sąsiedniej gminy Rudziniec.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_preferuje_miejskie FROM participation_survey WHERE (miasto_powiat = 'Gliwice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Które miasto ma najwyższy odsetek osób które uważają że lubią poznawać nowe miejsca związane z kulturą?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_lubiacych_nowe_miejsca FROM participation_survey WHERE opinia_kultura_nowe_miejsca IS NOT NULL GROUP BY miasto_powiat ORDER BY procent_lubiacych_nowe_miejsca DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedzają kino przynajmniej raz na 3 lata, między mieszkańcami gminy Pilchowice a mieszkańcami gminy Wyry (pow. mikołowski).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_kino IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie wydarzenia kulturalne najchętniej odwiedzają mieszkańcy dzielnic o charakterze poprzemysłowym w Katowicach (w tym Murcki) w porównaniu do pozostałych dzielnic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceDzielnice AS ( SELECT id_uczestnika, waga_proby, dzielnica_katowic, ostatnio_teatr, ostatnio_koncert, ostatnio_muzeum, ostatnio_piknik, ostatnio_kino, CASE WHEN dzielnica_katowic IN ('Szopienice-Burowiec', 'Wełnowiec-Józefowiec', 'Załęże', 'Dąb', 'Janów - Nikiszowiec', 'Dąbrówka Mała', 'Bogucice', 'Zawodzie', 'Załęska Hałda - Brynów Część Zachodnia', 'Murcki') THEN 'Poprzemysłowe' WHEN dzielnica_katowic IN ('Osiedle Tysiąclecia', 'Osiedle Witosa', 'Kostuchna', 'Ligota-Panewniki', 'Piotrowice - Ochojec', 'Podlesie', 'Giszowiec', 'Koszutka', 'Śródmieście', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Os. Paderewskiego - Muchowiec', 'Zarzecze') THEN 'Pozostałe' ELSE NULL END AS typ_dzielnicy FROM participation_survey WHERE dzielnica_katowic IS NOT NULL ) SELECT typ_dzielnicy, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzea, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS pikniki, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino FROM KatowiceDzielnice WHERE typ_dzielnicy IN ('Poprzemysłowe', 'Pozostałe') GROUP BY typ_dzielnicy;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie tarnogórskim osoby z wykształceniem wyższym częściej odwiedzają muzea niż osoby z wykształceniem niższym niż średnie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Kto chętniej korzysta z instagrama, mieszkańcy Bytomia czy Gliwic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN (kultura_online_instagram = TRUE OR instagram_profile_instytucji = TRUE OR instagram_profile_tworcow = TRUE OR instagram_profile_instytucji_miejskich = TRUE) THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uzytkownikow_instagrama FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Gliwice') GROUP BY miasto_powiat ORDER BY procent_uzytkownikow_instagrama DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie aktywności kulturalne (ostatnio_*) były najczęściej podejmowane przez mieszkańców Zabrza w ostatnich 6 miesiącach (top 5)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Zabrze') SELECT activity_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wizyta w kinie' AS activity_type, ostatnio_kino AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w teatrze' AS activity_type, ostatnio_teatr AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Uczestnictwo w koncercie' AS activity_type, ostatnio_koncert AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w muzeum / galerii sztuki' AS activity_type, ostatnio_muzeum AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w parku rozrywki' AS activity_type, ostatnio_park_rozrywki AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w domu kultury / centrum kultury' AS activity_type, ostatnio_dom_kultury AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w bibliotece' AS activity_type, ostatnio_biblioteka AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w zoo' AS activity_type, ostatnio_zoo AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w filharmonii lub operze' AS activity_type, ostatnio_filharmonia AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Uczestnictwo w spotkaniu z artystą' AS activity_type, ostatnio_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Udział w pikniku / festynie' AS activity_type, ostatnio_piknik AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Inna aktywność' AS activity_type, ostatnio_inna_aktywnosc AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Żadna z powyższych' AS activity_type, ostatnio_zadne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' ) subquery WHERE selected = TRUE GROUP BY activity_type ORDER BY percentage DESC LIMIT 5;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Piekar Śląskich i mieszkańców Radzionkowa był ostatnio w muzeum?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Piekary Śląskie' THEN 'Piekary Śląskie (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków' THEN 'Radzionków (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE (miasto_powiat = 'Piekary Śląskie') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnią ocenę (1-7) wiedzy o ofercie kulturalnej GZM między ludźmi z Kobióra a ludźmi ze Zbrosławic.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE ((miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice')) AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Chorzowa śledzi profile instytucji kultury na Twitterze/X?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN twitter_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_inst_twitter FROM participation_survey WHERE miasto_powiat = 'Chorzów';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które uważają, że 'uprawianie ogrodu' to kultura, między mieszkańcami gminy Psary a mieszkańcami gminy Ożarowice.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_ogrodnictwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogrod_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Który subregion GZM ma najwyższy odsetek mieszkańców uważających, że konsumpcja kultury sprawia im przyjemność (ocena 6-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czerpiacych_przyjemnosc FROM participation_survey WHERE opinia_kultura_przyjemnosc IS NOT NULL GROUP BY subregion_metropolii_gzm ORDER BY procent_czerpiacych_przyjemnosc DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób zgadzających się (ocena 6-7), że konsumpcja kultury sprawia przyjemność, między mieszkańcami Sosnowca i Rudy Śląskiej.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_przyjemnosc FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Ruda Śląska') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy kobiety w Zagłębiu częściej uczestniczą w wydarzeniach kulturalnych niż mężczyźni?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE OR ostatnio_koncert = TRUE OR ostatnio_muzeum = TRUE OR ostatnio_kino = TRUE OR ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestnictwa FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Dąbrowa Górnicza', 'Powiat będziński') AND plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różni się odsetek osób zgadzających się (ocena 5-7) ze stwierdzeniem 'Nakłady publiczne na kulturę powinny być mniejsze, są ważniejsze potrzeby' między pracownikami sektora kultury a pozostałymi respondentami?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT praca_w_sektorze_kultury, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_na_mniejsze_wydatki FROM participation_survey WHERE praca_w_sektorze_kultury IS NOT NULL GROUP BY praca_w_sektorze_kultury;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób mieszkających na wsi uważa, że dostęp do kultury w Metropolii GZM jest co najmniej wystarczający (ocena 5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('5', '6', '7 w pełni wystarczający') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ocena_dostepu_5_7 FROM participation_survey WHERE wielkosc_miejscowosci = 'wieś';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby korzystające z kultury głównie w domu częściej uważają, że jest wiele ważniejszych rzeczy niż kultura (ocena 5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN preferowane_miejsce_dom = TRUE AND preferowane_miejsce_instytucja_kultury = FALSE AND preferowane_miejsce_przestrzen_publiczna = FALSE AND preferowane_miejsce_przestrzen_tymczasowa = FALSE AND preferowane_miejsce_stadion = FALSE AND preferowane_miejsce_pub_klub = FALSE THEN 'Głównie w domu' ELSE 'Poza domem / Mieszane' END AS preferencja_miejsca, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_wazniejsze FROM participation_survey GROUP BY preferencja_miejsca HAVING preferencja_miejsca = 'Głównie w domu';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w kinie, między próbą mieszkańców Katowic a próbą mieszkańców subregionu katowickiego (bez Katowic).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Siemianowic Śląskich odwiedził ostatnio (6 msc) dom kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_6msc FROM participation_survey WHERE miasto_powiat = 'Siemianowice Śląskie';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie wydatki na kulturę między osobami w wieku 30-39 lat a osobami w wieku 60+ w subregionie tyskim.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa IN ('30-39', '60 i więcej') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z powiatu będzińskiego uważa, że działalność kulturalna podnosi atrakcyjność regionu (ocena 5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc_regionu FROM participation_survey WHERE miasto_powiat = 'Powiat będziński';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób, które nigdy nie były w filharmonii, jaki procent chciałby pójść w przyszłości?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_filharmonia = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN czestotliwosc_filharmonia IN ('Nigdy, ale chciał(a)bym w przyszłości', 'Nigdy i nie jestem tym zainteresowany(a)') THEN waga_proby ELSE 0 END), 2) AS procent_chcialby_pojsc FROM participation_survey WHERE czestotliwosc_filharmonia IN ('Nigdy, ale chciał(a)bym w przyszłości', 'Nigdy i nie jestem tym zainteresowany(a)');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Bytomia i reszty GZM był ostatnio w domu kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_dom_kultury FROM participation_survey GROUP BY obszar;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób korzystających wyłącznie z transportu publicznego (miejskiego lub regionalnego, bez innych środków) odwiedzało miejsca kultury w innych miastach/gminach GZM niż miejsce zamieszkania w ciągu ostatnich 12 miesięcy? Porównaj z osobami korzystającymi wyłącznie z własnego samochodu.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH TransportGroups AS ( SELECT id_uczestnika, waga_proby, uczestnictwo_inne_miejsce_gzm, CASE WHEN (transport_komunikacja_miejska = TRUE OR transport_komunikacja_regionalna = TRUE) AND transport_wlasny_samochod = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN 'Tylko transport publiczny' WHEN transport_wlasny_samochod = TRUE AND transport_komunikacja_miejska = FALSE AND transport_komunikacja_regionalna = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN 'Tylko własny samochód' ELSE 'Inny/Mieszany' END AS typ_transportu FROM participation_survey ) SELECT typ_transportu, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_inne_miasta_gzm FROM TransportGroups WHERE typ_transportu IN ('Tylko transport publiczny', 'Tylko własny samochód') GROUP BY typ_transportu;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) wiedzy o ofercie kulturalnej GZM wśród mieszkańców zespołu dzielnic północnych Katowic?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT wiedza_o_ofercie_kulturalnej_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic północnych';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które odwiedzają miejsca kultury w różnych miastach GZM (poza swoim), częściej zgadzają się, że kultura podnosi atrakcyjność regionu (ocena 6-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT uczestnictwo_inne_miejsce_gzm, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc FROM participation_survey WHERE uczestnictwo_inne_miejsce_gzm IS NOT NULL GROUP BY uczestnictwo_inne_miejsce_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różnią się wydatki na kulturę między Dąbrową Górniczą a Sosnowcem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki, ROUND(STDDEV(wydatki_na_kulture_kwota), 2) AS odchylenie_standardowe FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Dąbrowa Górnicza') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami miasta Gliwice a mieszkańcami powiatu gliwickiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE miasto_powiat IN ('Gliwice', 'Powiat gliwicki') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Rudy Śląskiej a mieszkańcami gminy Wyry (pow. mikołowski).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Ruda Śląska' THEN 'Ruda Śląska (Miasto)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Ruda Śląska') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak często mieszkańcy centrum Katowic i Piotrowic chodzą do galerii sztuki?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT dzielnica_katowic, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Przynajmniej raz w ciągu ostatnich 12 miesięcy\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Dawniej niż w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Dawniej niż w ciągu ostatnich 3 lat\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Nigdy, ale chciał(a)bym w przyszłości\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Nigdy i nie jestem tym zainteresowany(a)' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Nigdy i nie jestem tym zainteresowany(a)\" FROM participation_survey WHERE dzielnica_katowic IN ('Śródmieście', 'Piotrowice - Ochojec') AND czestotliwosc_galeria_sztuki IS NOT NULL GROUP BY dzielnica_katowic ORDER BY dzielnica_katowic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Wyry i gminy Zbrosławice wskazuje 'brak oferty lokalnej' jako barierę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_lokalna FROM participation_survey WHERE (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy na Śląsku młodzi ludzie są bardziej zainteresowani kulturą lokalną niż w Zagłębiu?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH SlaskZaglebie AS ( SELECT id_uczestnika, waga_proby, grupa_wiekowa, uczestnictwo_miejsce_zamieszkania, opinia_kultura_przynaleznosc, CASE WHEN miasto_powiat IN ('Bytom', 'Chorzów', 'Gliwice', 'Katowice', 'Mysłowice', 'Piekary Śląskie', 'Ruda Śląska', 'Siemianowice Śląskie', 'Świętochłowice', 'Tychy', 'Zabrze', 'Powiat gliwicki', 'Powiat mikołowski', 'Powiat pszczyński', 'Powiat tarnogórski', 'Powiat bieruńsko-lędziński') THEN 'Śląsk' WHEN miasto_powiat IN ('Sosnowiec', 'Dąbrowa Górnicza', 'Powiat będziński') THEN 'Zagłębie' ELSE 'Inne' END AS region FROM participation_survey WHERE miasto_powiat IS NOT NULL ) SELECT region, ROUND(SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' AND (uczestnictwo_miejsce_zamieszkania = TRUE OR opinia_kultura_przynaleznosc IN ('5', '6', '7 w pełni sie zgadzam')) THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' THEN waga_proby ELSE 0 END), 2) AS procent_mlodych_zainteresowanych FROM SlaskZaglebie WHERE region IN ('Śląsk', 'Zagłębie') AND grupa_wiekowa = 'Mniej niż 30' GROUP BY region;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Katowic z zespołu dzielnic śródmiejskich uważa, że 'umiejętność rozmawiania z innymi' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT kultura_umiejetnosc_rozmowy, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN kultura_umiejetnosc_rozmowy = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rozmowa_kultura FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic śródmiejskich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie środki transportu są najczęściej używane przez studentów w Katowicach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE) SELECT transport_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Komunikacja miejska (autobus, tramwaj)' AS transport_type, transport_komunikacja_miejska AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Komunikacja regionalna (kolej)' AS transport_type, transport_komunikacja_regionalna AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Własny samochód' AS transport_type, transport_wlasny_samochod AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Własny rower' AS transport_type, transport_wlasny_rower AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Pojazd na minuty (rower, hulajnoga)' AS transport_type, transport_wspoldzielony AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Pieszo' AS transport_type, transport_pieszo AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Inaczej' AS transport_type, transport_inny AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE ) subquery WHERE selected = TRUE GROUP BY transport_type ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie kombinacje barier (np. cena+brak czasu, dojazd+brak informacji) są najczęstsze wśród osób z niepełnosprawnością ruchową?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH TargetGroup AS ( SELECT id_uczestnika, waga_proby, bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji FROM participation_survey WHERE niepelnosprawnosc_ruch = TRUE ), TotalWeight AS ( SELECT SUM(waga_proby) AS total FROM TargetGroup ) SELECT bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalWeight), 2) AS procent_kombinacji FROM TargetGroup GROUP BY bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji ORDER BY procent_kombinacji DESC LIMIT 5;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent respondentów o wysokich dochodach (powyżej 9000 zł) wspiera finansowo artystów z GZM (poprzez platformy cyfrowe)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN cyfrowa_kultura_wsparcie_artystow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wspierajacych_artystow FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Zbrosławice i gminy Pilchowice uważa, że 'taniec' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_taniec = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_taniec_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie formy uczestnictwa w kulturze w domu (TV, radio, podcasty, internet, prasa, książki) są najpopularniejsze wśród emerytów?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE zatrudnienie_emeryt = TRUE) SELECT aktywnosc_domowa, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Oglądanie programów w TV' AS aktywnosc_domowa, kultura_domowa_tv AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie audycji w radiu' AS aktywnosc_domowa, kultura_domowa_radio AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie podcastów' AS aktywnosc_domowa, kultura_domowa_podcasty AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Oglądanie/czytanie treści w Internecie' AS aktywnosc_domowa, kultura_domowa_internet AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie prasy drukowanej' AS aktywnosc_domowa, kultura_domowa_prasa AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie książek dla przyjemności' AS aktywnosc_domowa, kultura_domowa_ksiazki AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Inne aktywności' AS aktywnosc_domowa, kultura_domowa_inne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Żadne z powyższych form uczestnictwa w kulturze w domu' AS aktywnosc_domowa, kultura_domowa_zadne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE ) subquery WHERE selected = TRUE GROUP BY aktywnosc_domowa ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest średni miesięczny wydatek na kulturę wśród osób z wyższym wykształceniem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS sredni_wydatek_kultura FROM participation_survey WHERE wyksztalcenie = 'wyższe';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie formy cyfrowej kultury są najpopularniejsze wśród osób poniżej 30 lat w subregionie gliwickim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH SubregionData AS (SELECT waga_proby, cyfrowa_kultura_wydarzenia_online, cyfrowa_kultura_wystawy_interaktywne, cyfrowa_kultura_nowe_media, cyfrowa_kultura_podcasty, cyfrowa_kultura_social_media, cyfrowa_kultura_gry, cyfrowa_kultura_vr FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND grupa_wiekowa = 'Mniej niż 30') SELECT 'Social Media (YT/TikTok)' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_social_media = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Gry komputerowe' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_gry = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Podcasty' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_podcasty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Wydarzenia Online' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'VR/Immersja' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Sztuka Nowych Mediów' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_nowe_media = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Interaktywne Wystawy Online' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_wystawy_interaktywne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData ORDER BY procent DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Świętochłowicach osoby z wykształceniem średnim częściej niż osoby z wykształceniem wyższym odwiedzają pikniki/festyny (ostatnie 6 msc)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_piknik_6msc FROM participation_survey WHERE miasto_powiat = 'Świętochłowice' AND wyksztalcenie IN ('średnie', 'wyższe') GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie bieruńsko-lędzińskim osoby częściej odwiedzają pikniki/festyny (rocznie) niż koncerty (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT 'Pikniki/Festyny (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' UNION ALL SELECT 'Koncerty (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Katowic, którzy odwiedzili ostatnio (6 msc) spotkanie z artystą, częściej deklarują twórczość własną (np. pisanie, fotografia)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ostatnio_spotkanie_z_artysta, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE miasto_powiat = 'Katowice' AND ostatnio_spotkanie_z_artysta IS NOT NULL GROUP BY ostatnio_spotkanie_z_artysta;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy 'brak czasu' jest częściej wskazywaną barierą (% wskazań) przez osoby o dochodach powyżej 6000 zł netto miesięcznie w porównaniu do osób o dochodach do 3500 zł netto?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN przedzial_wynagrodzenia IN ('powyżej 9000 zł') THEN 'Powyżej 9000 zł' WHEN przedzial_wynagrodzenia = 'do 3500 zł' THEN 'Do 3500 zł' ELSE 'Inny/Nie podano' END AS grupa_dochodowa, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_brak_czasu FROM participation_survey WHERE przedzial_wynagrodzenia NOT IN ('nie wiem, trudno powiedzieć', 'odmowa odpowiedzi') AND przedzial_wynagrodzenia IS NOT NULL GROUP BY grupa_dochodowa HAVING grupa_dochodowa IN ('Powyżej 9000 zł', 'Do 3500 zł');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różnią się używane środki transportu (procentowo) między osobami często (rocznie) i rzadziej odwiedzającymi muzea?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH ParticipationGroup AS ( SELECT id_uczestnika, CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Często (Muzeum rocznie)' ELSE 'Rzadziej (Muzeum < 1/rok)' END AS participation_freq FROM participation_survey WHERE czestotliwosc_muzeum IS NOT NULL ), total_weight_target AS ( SELECT pg.participation_freq, SUM(p.waga_proby) AS total FROM participation_survey p JOIN ParticipationGroup pg ON p.id_uczestnika = pg.id_uczestnika GROUP BY pg.participation_freq ) SELECT pg.participation_freq, sub.transport_type, ROUND(SUM(CASE WHEN sub.selected = TRUE THEN p.waga_proby ELSE 0 END) * 100.0 / MAX(twt.total), 2) AS percentage FROM participation_survey p JOIN ( SELECT id_uczestnika, 'Komunikacja miejska' AS transport_type, transport_komunikacja_miejska AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Własny samochód' AS transport_type, transport_wlasny_samochod AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Pieszo' AS transport_type, transport_pieszo AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Komunikacja regionalna' AS transport_type, transport_komunikacja_regionalna AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Własny rower' AS transport_type, transport_wlasny_rower AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Transport współdzielony' AS transport_type, transport_wspoldzielony AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Inny' AS transport_type, transport_inny AS selected FROM participation_survey ) sub ON p.id_uczestnika = sub.id_uczestnika JOIN ParticipationGroup pg ON p.id_uczestnika = pg.id_uczestnika JOIN total_weight_target twt ON pg.participation_freq = twt.participation_freq WHERE sub.selected = TRUE GROUP BY pg.participation_freq, sub.transport_type ORDER BY pg.participation_freq, percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Które grupy demograficzne (wiek, wykształcenie) najczęściej występują wśród osób o wysokich wydatkach na kulturę (250 zł i więcej miesięcznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH HighSpenders AS ( SELECT grupa_wiekowa, wyksztalcenie, waga_proby FROM participation_survey WHERE wydatki_na_kulture_kategoria = '250 i więcej' ), TotalHighSpendersWeight AS ( SELECT SUM(waga_proby) AS total FROM HighSpenders ) SELECT grupa_wiekowa, wyksztalcenie, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalHighSpendersWeight), 2) AS procent_wsrod_wydajacych_duzo FROM HighSpenders GROUP BY grupa_wiekowa, wyksztalcenie ORDER BY procent_wsrod_wydajacych_duzo DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które często odwiedzają galerie sztuki (przynajmniej raz w ciągu 12 miesięcy), częściej wskazują 'Sztuka/artyzm/wyrażanie siebie' jako swoją definicję kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Odwiedza galerie rocznie' ELSE 'Nie odwiedza galerii rocznie' END AS status_odwiedzin_galerii, ROUND(SUM(CASE WHEN definicja_kultury_kategoria = 'Sztuka/artyzm/wyrażanie siebie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_definiujacych_jako_sztuka FROM participation_survey WHERE czestotliwosc_galeria_sztuki IS NOT NULL AND definicja_kultury_kategoria IS NOT NULL GROUP BY status_odwiedzin_galerii;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób, które preferują wydarzenia o zasięgu międzynarodowym, jaki procent odwiedził Katowice w celach kulturalnych w ciągu ostatnich 12 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN miejsce_kultury_katowice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_katowice FROM participation_survey WHERE wydarzenie_miedzynarodowe = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby czerpiące informacje o kulturze z mediów społecznościowych (profile instytucji, twórców lub inne) wydają miesięcznie więcej na kulturę niż osoby niekorzystające z tych źródeł? Porównaj średnie wydatki (kwota).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN informacja_social_media_instytucje = TRUE OR informacja_social_media_tworcy = TRUE OR informacja_social_media_inne = TRUE THEN 'Użytkownik Social Media (info kult.)' ELSE 'Nie używa Social Media do info kult.' END AS grupa_uzytkownikow, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_uzytkownikow;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby często czytające książki dla przyjemności (przynajmniej raz w ciągu ostatnich 12 miesięcy) rzadziej wskazują 'brak zainteresowania ofertą' jako powód nieuczestniczenia w kulturze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Czyta książki rocznie' ELSE 'Nie czyta książek rocznie' END AS status_czytelnika, ROUND(SUM(CASE WHEN powod_braku_uczestnictwa_kategoria = 'Brak ochoty/nie interesuje mnie to' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wskazujacy_brak_zainteresowania FROM participation_survey WHERE powod_braku_uczestnictwa_kategoria IS NOT NULL AND czestotliwosc_czytanie_ksiazek IS NOT NULL GROUP BY status_czytelnika;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy zespołu dzielnic wschodnich Katowic (np. Nikiszowiec, Giszowiec) częściej doceniają kulturę jako element tożsamości lokalnej niż mieszkańcy zespołu dzielnic śródmiejskich?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT opinia_kultura_przynaleznosc, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_doceniajacy_tozsamosc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic wschodnich', 'Zespół dzielnic śródmiejskich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w bibliotece, między mieszkańcami subregionu sosnowieckiego a resztą GZM.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN subregion_metropolii_gzm = 'SOSNOWIECKI' THEN 'Subregion Sosnowiecki' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_biblioteka FROM participation_survey GROUP BY obszar;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które w ciągu ostatnich 6 miesięcy odwiedziły park rozrywki, między mieszkańcami subregionu tyskiego a katowickiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Tyski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_park_rozrywki FROM participation_survey WHERE subregion_metropolii_gzm IN ('TYSKI', 'KATOWICE', 'KATOWICKI') GROUP BY subregion_grupa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różni się postrzeganie 'gotowania' i 'mody' jako części kultury między kobietami a mężczyznami?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, ROUND(SUM(CASE WHEN kultura_gotowanie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_gotowanie_kultura, ROUND(SUM(CASE WHEN kultura_moda = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moda_kultura FROM participation_survey WHERE plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Wyry i gminy Psary wskazuje 'niewystarczającą ilość informacji' jako barierę?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_info FROM participation_survey WHERE (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób uważających, że 'jest wiele ważniejszych rzeczy niż kultura' (ocena 6-7), jaki procent odwiedził ostatnio (6 msc) kino?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE opinia_wazniejsze_rzeczy_niz_kultura IN ('6', '7 w pełni sie zgadzam');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Zabrza, którzy odwiedzili teatr, wybrało Teatr Nowy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Nowy w Zabrzu' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wybral_tnowy FROM participation_survey WHERE miasto_powiat = 'Zabrze' AND ostatnio_teatr = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Piekar Śląskich częściej uczestniczą w piknikach/festynach niż mieszkańcy Świętochłowic (w ostatnich 6 msc)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_6msc FROM participation_survey WHERE miasto_powiat IN ('Piekary Śląskie', 'Świętochłowice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic południowych Katowic i mieszkańców Mysłowic był ostatnio w teatrze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneS AS ( SELECT ostatnio_teatr, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Zespół dzielnic południowych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM KatowiceZoneS UNION ALL SELECT 'Mysłowice (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Mysłowice';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent 'Innych' barier uczestnictwa (odpowiedź tekstowa) wspomina o 'pandemii' lub 'covid'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN LOWER(bariera_inne_tekst) LIKE '%pandemi%' OR LOWER(bariera_inne_tekst) LIKE '%covid%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN bariera_inne = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wspomnien_pandemii FROM participation_survey WHERE bariera_inne = TRUE AND bariera_inne_tekst IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród osób, które jako główną barierę wskazują problemy z dojazdem?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE bariera_dojazd = TRUE AND ocena_dostepu_do_kultury_gzm IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby ceniące 'praktyczność' w wolnym czasie (ocena 5-7) rzadziej cenią 'nowość' (ocena 1-3)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH PracticalGroup AS ( SELECT id_uczestnika, waga_proby FROM participation_survey WHERE wolny_czas_definicja_praktycznosc IN ('5', '6', '7 w pełni sie zgadzam') ), TotalPracticalWeight AS ( SELECT SUM(waga_proby) AS total FROM PracticalGroup ) SELECT ROUND(SUM(CASE WHEN ps.wolny_czas_definicja_nowosc IN ('1 zupełnie się nie zgadzam', '2', '3') THEN pg.waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM TotalPracticalWeight), 2) AS procent_nie_ceniacych_nowosci FROM PracticalGroup pg JOIN participation_survey ps ON pg.id_uczestnika = ps.id_uczestnika WHERE ps.wolny_czas_definicja_nowosc IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Z jakich źródeł informacji o kulturze korzystają najczęściej osoby, które odwiedziły teatr w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE ostatnio_teatr = TRUE) SELECT source, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Prasa drukowana' AS source, informacja_prasa_drukowana AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Plakaty/ogłoszenia/reklamy' AS source, informacja_plakaty AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Lokalne portale/strony' AS source, informacja_portale_lokalne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnopolskie portale/strony' AS source, informacja_portale_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile instytucji w mediach społecznościowych' AS source, informacja_social_media_instytucje AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile twórców w mediach społecznościowych' AS source, informacja_social_media_tworcy AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne profile w mediach społecznościowych' AS source, informacja_social_media_inne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Od znajomych/rodziny' AS source, informacja_znajomi_rodzina AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Radio' AS source, informacja_radio AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Telewizja' AS source, informacja_telewizja AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Strony internetowe instytucji kultury' AS source, informacja_strony_instytucji AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnotematyczne strony internetowe' AS source, informacja_strony_ogolne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne źródła' AS source, informacja_inne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Żadne z powyższych źródeł informacji' AS source, informacja_zadne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE ) subquery WHERE selected = TRUE GROUP BY source ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób korzystających z kultury cyfrowej przez podcasty, jaki procent również czyta książki dla przyjemności (przynajmniej raz w ciągu ostatnich 12 miesięcy)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czytajacych_ksiazki FROM participation_survey WHERE cyfrowa_kultura_podcasty = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w powiecie mikołowskim osoby z wykształceniem wyższym częściej niż osoby ze średnim odwiedzają koncerty (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND wyksztalcenie IN ('wyższe', 'średnie') GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób w GZM korzystających z Internetu w telefonie komórkowym odwiedził galerię sztuki w ciągu ostatnich 12 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galeria_rocznie FROM participation_survey WHERE internet_w_telefonie = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Chorzowa i Zabrza był ostatnio w teatrze?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat IN ('Chorzów', 'Zabrze') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców mniejszych gmin wiejskich i mieszkańców Katowic korzysta z kultury online 'bardzo często' (ocena 7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Mniejsze gminy wiejskie' WHEN miasto_powiat = 'Katowice' THEN 'Katowice (Miasto)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_online_czesto FROM participation_survey WHERE (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) OR (miasto_powiat = 'Katowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Chełm Śląski i gminy Bojszowy uważa, że gry komputerowe to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN kultura_gry_komputerowe = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_gry_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc IN ('Chełm Śląski', 'Bojszowy') GROUP BY gmina_miejscowosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Świętochłowic a mieszkańcami powiatu tarnogórskiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat IN ('Świętochłowice', 'Powiat tarnogórski') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Zabrza mają inne bariery uczestnictwa w kulturze niż mieszkańcy Sosnowca?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS dojazd, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS czas, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS oferta FROM participation_survey WHERE miasto_powiat IN ('Zabrze', 'Sosnowiec') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców mniejszych miast (poniżej 100 tys. mieszkańców) preferuje wydarzenia o zasięgu dzielnicowym lub miejskim, w porównaniu do mieszkańców największych miast (powyżej 200 tys. mieszkańców)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wielkosc_miejscowosci IN ('miasto poniżej 20 tys. mieszkańców', 'miasto 20 - 99 tys. mieszkańców') THEN 'Miasta < 100 tys.' WHEN wielkosc_miejscowosci = 'miasto powyżej 200 tys. mieszkańców' THEN 'Miasta > 200 tys.' ELSE 'Inne' END AS typ_miasta, ROUND(SUM(CASE WHEN wydarzenie_dzielnicowe = TRUE OR wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_preferujacych_lokalne FROM participation_survey WHERE wielkosc_miejscowosci IN ('miasto poniżej 20 tys. mieszkańców', 'miasto 20 - 99 tys. mieszkańców', 'miasto powyżej 200 tys. mieszkańców') GROUP BY typ_miasta;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jakie 3 formy spędzania wolnego czasu są najważniejsze (ocena 'zdecydowanie tak') dla osób z segmentu 'Konsumenci Kultury Instytucjonalnej'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH SegmentData AS (SELECT * FROM participation_survey WHERE segment_uczestnika = 'Konsumenci Kultury Instytucjonalnej') SELECT 'Użyteczny/Praktyczny' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_praktycznosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Poczucie dumy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_duma = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Tworzenie rękodzieła' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rekodzielo = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Daje radość' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_radosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Czas z rodziną' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rodzina = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Potrzeby bliskich' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_potrzeby_bliskich = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Zakupy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_zakupy = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Jest nowością' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_nowosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Samopoznanie' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_samopoznanie = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData ORDER BY procent DESC LIMIT 3;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które jako pierwsze skojarzenie z miejscami GZM podają 'Teatr', między mieszkańcami subregionu tyskiego i gliwickiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'teatr' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_teatr FROM participation_survey WHERE subregion_metropolii_gzm IN ('TYSKI', 'GLIWICKI') GROUP BY subregion_metropolii_gzm;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jak różni się średnia ocena (1-7) 'kultura jest dla wszystkich' między mężczyznami i kobietami w Chorzowie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT plec, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_dla_wszystkich = '2' THEN 2 WHEN opinia_kultura_dla_wszystkich = '3' THEN 3 WHEN opinia_kultura_dla_wszystkich = '4' THEN 4 WHEN opinia_kultura_dla_wszystkich = '5' THEN 5 WHEN opinia_kultura_dla_wszystkich = '6' THEN 6 WHEN opinia_kultura_dla_wszystkich = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dla_wszystkich FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND plec IN ('Kobieta', 'Mężczyzna') AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY plec;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób 'zupełnie niezgadzających się' (ocena 1), że kultura jest dla wszystkich, występuje w grupie z wykształceniem podstawowym vs wyższym?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zupelnie_sie_nie_zgadza FROM participation_survey WHERE wyksztalcenie IN ('niższe niż średnie', 'wyższe') AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest średni miesięczny wydatek na kulturę wśród studentów w Katowicach w porównaniu do studentów w Gliwicach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS sredni_wydatek_studenci FROM participation_survey WHERE zatrudnienie_student = TRUE AND miasto_powiat IN ('Katowice', 'Gliwice') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent segmentów 'Zdobywcy Wiedzy' i 'Aspirujący Mainstream' zgadza się (ocena 5-7) ze stwierdzeniem 'Działalność kulturalna i artystyczna podnosi atrakcyjność mojego regionu'?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgadzajacych_sie FROM participation_survey WHERE segment_uczestnika IN ('Zdobywcy Wiedzy', 'Aspirujący Mainstream') GROUP BY segment_uczestnika;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia częstotliwość (skala 1-7) korzystania z kultury online wśród osób, które jako główne źródło informacji wskazują profile instytucji w social mediach?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH InfoSource AS ( SELECT CASE WHEN informacja_social_media_instytucje = TRUE AND informacja_social_media_tworcy = FALSE AND informacja_social_media_inne = FALSE THEN 'SM Instytucje (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo, czestotliwosc_kultura_online, waga_proby FROM participation_survey WHERE informacja_social_media_instytucje = TRUE OR informacja_social_media_tworcy = TRUE OR informacja_social_media_inne = TRUE ) SELECT ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online FROM InfoSource WHERE glowne_zrodlo = 'SM Instytucje (głównie)' AND czestotliwosc_kultura_online IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest związek między uczestnictwem w kulturze (mierzonym roczną aktywnością w muzeach) a postrzeganą jakością życia (średnia ocena poczucia sensu, przyjemności)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Aktywny w muzeach (rocznie)' ELSE 'Nieaktywny w muzeach (rocznie)' END AS uczestnictwo_muzea, ROUND(SUM(CASE WHEN opinia_kultura_sens_zycia = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_sens_zycia = '2' THEN 2 WHEN opinia_kultura_sens_zycia = '3' THEN 3 WHEN opinia_kultura_sens_zycia = '4' THEN 4 WHEN opinia_kultura_sens_zycia = '5' THEN 5 WHEN opinia_kultura_sens_zycia = '6' THEN 6 WHEN opinia_kultura_sens_zycia = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_sens_zycia, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci FROM participation_survey WHERE czestotliwosc_muzeum IS NOT NULL AND opinia_kultura_sens_zycia IS NOT NULL AND opinia_kultura_przyjemnosc IS NOT NULL GROUP BY uczestnictwo_muzea;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców miasta Zabrze i gminy Pyskowice był ostatnio w kinie?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Zabrze' THEN 'Zabrze (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pyskowice' THEN 'Pyskowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (miasto_powiat = 'Zabrze') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pyskowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w Tychach osoby uważające, że moralność jest częścią kultury, częściej odwiedzają kościoły (implikowane przez kulturę religijną) niż osoby uważające inaczej?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT kultura_moralnosc, ROUND(SUM(CASE WHEN kultura_religia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_religia_jako_kultura FROM participation_survey WHERE miasto_powiat = 'Tychy' AND kultura_moralnosc IN ('Tak', 'Nie') GROUP BY kultura_moralnosc;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób w GZM, które często korzystają z kultury online (ocena 6-7), również często odwiedza kino (przynajmniej raz w roku)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie_wsrod_czestych_online FROM participation_survey WHERE czestotliwosc_kultura_online IN ('6', '7 bardzo często');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które uważają, że 'sposób, jak się do siebie zwracamy' to kultura, między mieszkańcami Dąbrowy Górniczej i Zabrza.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN kultura_sposob_zwracania_sie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sposob_zwracania FROM participation_survey WHERE miasto_powiat IN ('Dąbrowa Górnicza', 'Zabrze') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gminy Psary i gminy Pilchowice uważa, że 'muzyka rozrywkowa' to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_muzyka_rozrywkowa = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzyka_rozryw_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest rozkład preferencji miejsc uczestnictwa w kulturze (dom, instytucja, przestrzeń publiczna etc.) wśród osób samozatrudnionych?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE) SELECT preference_location, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'W domu' AS preference_location, preferowane_miejsce_dom AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W siedzibie instytucji kultury' AS preference_location, preferowane_miejsce_instytucja_kultury AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W przestrzeni publicznej' AS preference_location, preferowane_miejsce_przestrzen_publiczna AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W tymczasowo zaaranżowanej przestrzeni' AS preference_location, preferowane_miejsce_przestrzen_tymczasowa AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Na stadionie' AS preference_location, preferowane_miejsce_stadion AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W pubie/klubie/restauracji' AS preference_location, preferowane_miejsce_pub_klub AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Inne miejsce' AS preference_location, preferowane_miejsce_inne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Żadne z powyższych' AS preference_location, preferowane_miejsce_zadne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE ) subquery WHERE selected = TRUE GROUP BY preference_location ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami Bytomia a mieszkańcami Tarnowskich Gór.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry' THEN 'Tarnowskie Góry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (miasto_powiat = 'Bytom') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy młodzi mieszkańcy (poniżej 30 lat) podregionu tyskiego chętniej uczestniczą w piknikach i festynach niż ich rówieśnicy z innych części GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Podregion tyski' ELSE 'Pozostałe podregiony' END AS podregion, ROUND(SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' AND (ostatnio_piknik = TRUE OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' THEN waga_proby ELSE 0 END), 2) AS procent_mlodych_uczestniczacych FROM participation_survey GROUP BY podregion;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców wsi i mieszkańców Chorzowa odwiedza filharmonię/operę przynajmniej raz na 3 lata?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Miejscowości i wsie' WHEN miasto_powiat = 'Chorzów' THEN 'Chorzów (Miasto)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_filharmonia IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_filharmonia_3lata FROM participation_survey WHERE (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) OR (miasto_powiat = 'Chorzów') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z niepełnosprawnością ruchową korzysta z jakiejkolwiek cyfrowej formy kultury (wymienionej w pytaniu `cyfrowa_kultura_*`), w porównaniu do osób bez zadeklarowanych niepełnosprawności?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN niepelnosprawnosc_ruch = TRUE THEN 'Niepełnosprawność ruchowa' WHEN niepelnosprawnosc_zadna = TRUE THEN 'Brak zadeklarowanych niepełnosprawności' ELSE 'Inne/Nie dotyczy' END AS status_niepelnosprawnosci, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_z_kultury_cyfrowej FROM participation_survey WHERE niepelnosprawnosc_ruch = TRUE OR niepelnosprawnosc_zadna = TRUE GROUP BY status_niepelnosprawnosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby samozatrudnione w Rudzie Śląskiej wydają średnio więcej na kulturę niż osoby pracujące na etacie w tym samym mieście?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH EmploymentStatus AS ( SELECT CASE WHEN zatrudnienie_samozatrudniony = TRUE THEN 'Samozatrudniony' WHEN zatrudnienie_pracujacy = TRUE THEN 'Zatrudniony na etacie' ELSE 'Inny status' END AS status_zatrudnienia, wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE miasto_powiat = 'Ruda Śląska' AND (zatrudnienie_samozatrudniony = TRUE OR zatrudnienie_pracujacy = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT status_zatrudnienia, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM EmploymentStatus GROUP BY status_zatrudnienia;<end_of_turn>\n"}
