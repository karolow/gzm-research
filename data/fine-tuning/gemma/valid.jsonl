{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy miast na prawach powiatu częściej uczestniczą w kulturze niż mieszkańcy pozostałych obszarów GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat IN ('Bytom', 'Chorzów', 'Dąbrowa Górnicza', 'Gliwice', 'Katowice', 'Mysłowice', 'Piekary Śląskie', 'Ruda Śląska', 'Siemianowice Śląskie', 'Sosnowiec', 'Świętochłowice', 'Tychy', 'Zabrze') THEN 'Miasta na prawach powiatu' ELSE 'Pozostałe obszary GZM' END AS typ_jednostki, ROUND(SUM(CASE WHEN (ostatnio_teatr = TRUE OR ostatnio_koncert = TRUE OR ostatnio_muzeum = TRUE OR ostatnio_kino = TRUE OR ostatnio_piknik = TRUE OR ostatnio_dom_kultury = TRUE) THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestnictwa FROM participation_survey GROUP BY typ_jednostki;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w subregionie gliwickim osoby z wykształceniem wyższym częściej niż osoby ze średnim śledzą profile twórców na YouTube?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN youtube_profile_tworcow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_yt_tworcow FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND wyksztalcenie IN ('wyższe', 'średnie') GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób w GZM z niepełnosprawnością słuchu odwiedził kino w ciągu ostatnich 12 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie FROM participation_survey WHERE niepelnosprawnosc_sluch = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy dużych miast konurbacji górnośląskiej mają bardziej krytyczne zdanie o dostępności oferty kulturalnej niż mieszkańcy mniejszych miast?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wielkosc_miejscowosci = 'miasto powyżej 200 tys. mieszkańców' THEN 'Duże miasta (>200 tys.)' ELSE 'Mniejsze miasta i wsie' END AS wielkosc_miasta, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('1 całkowicie niewystarczający', '2', '3') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_krytycznych FROM participation_survey GROUP BY wielkosc_miasta;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które odwiedziły Teatr Śląski, między mieszkańcami Katowic a mieszkańcami Sosnowca.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Śląski im. Stanisława Wyspiańskiego w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_tsl FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Sosnowiec') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które często odwiedzają rekonstrukcje historyczne (rocznie), częściej uważają patriotyzm za część kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN czestotliwosc_rekonstrukcja_historyczna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Uczestnik rekonstrukcji (rocznie)' ELSE 'Nieuczestniczący (rocznie)' END AS status_rekonstrukcji, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE czestotliwosc_rekonstrukcja_historyczna IS NOT NULL GROUP BY status_rekonstrukcji;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest rozkład województw zamieszkania respondentów?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wojewodztwo, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wojewodztwo IS NOT NULL), 2) AS procent FROM participation_survey WHERE wojewodztwo IS NOT NULL GROUP BY wojewodztwo ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Który subregion GZM ma najwyższy odsetek osób odwiedzających muzea (rocznie)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE subregion_metropolii_gzm != 'Inny' AND czestotliwosc_muzeum IS NOT NULL GROUP BY subregion_metropolii_gzm ORDER BY procent_muzea_rocznie DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób, które odwiedziły Chorzów w celach kulturalnych w ciągu ostatnich 12 miesięcy, jakie było najczęściej odwiedzane inne miasto GZM w tym samym okresie poza Katowicami?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH ChorzowVisitors AS ( SELECT id_uczestnika, waga_proby FROM participation_survey WHERE miejsce_kultury_chorzow = TRUE ), UnpivotedVisits AS ( SELECT id_uczestnika, 'Bytom' AS city_name FROM participation_survey WHERE miejsce_kultury_bytom = TRUE UNION ALL SELECT id_uczestnika, 'Dąbrowa Górnicza' FROM participation_survey WHERE miejsce_kultury_dabrowa_gornicza = TRUE UNION ALL SELECT id_uczestnika, 'Gliwice' FROM participation_survey WHERE miejsce_kultury_gliwice = TRUE UNION ALL SELECT id_uczestnika, 'Katowice' FROM participation_survey WHERE miejsce_kultury_katowice = TRUE UNION ALL SELECT id_uczestnika, 'Mysłowice' FROM participation_survey WHERE miejsce_kultury_myslowice = TRUE UNION ALL SELECT id_uczestnika, 'Piekary Śląskie' FROM participation_survey WHERE miejsce_kultury_piekary_slaskie = TRUE UNION ALL SELECT id_uczestnika, 'Ruda Śląska' FROM participation_survey WHERE miejsce_kultury_ruda_slaska = TRUE UNION ALL SELECT id_uczestnika, 'Siemianowice Śląskie' FROM participation_survey WHERE miejsce_kultury_siemianowice_slaskie = TRUE UNION ALL SELECT id_uczestnika, 'Sosnowiec' FROM participation_survey WHERE miejsce_kultury_sosnowiec = TRUE UNION ALL SELECT id_uczestnika, 'Świętochłowice' FROM participation_survey WHERE miejsce_kultury_swietochlowice = TRUE UNION ALL SELECT id_uczestnika, 'Tychy' FROM participation_survey WHERE miejsce_kultury_tychy = TRUE UNION ALL SELECT id_uczestnika, 'Zabrze' FROM participation_survey WHERE miejsce_kultury_zabrze = TRUE UNION ALL SELECT id_uczestnika, 'Inne' FROM participation_survey WHERE miejsce_kultury_inne = TRUE ) SELECT uv.city_name AS inne_odwiedzone_miasto, SUM(cv.waga_proby) AS wazona_liczba_odwiedzin FROM UnpivotedVisits uv JOIN ChorzowVisitors cv ON uv.id_uczestnika = cv.id_uczestnika WHERE uv.city_name NOT IN ('Chorzów', 'Katowice') GROUP BY uv.city_name ORDER BY wazona_liczba_odwiedzin DESC LIMIT 1;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena istotności kultury (1-7) dla osób bez zadeklarowanych niepełnosprawności, pracujących na etacie i mieszkających na wsi?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE niepelnosprawnosc_zadna = TRUE AND zatrudnienie_pracujacy = TRUE AND wielkosc_miejscowosci = 'wieś' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki jest rozkład deklarowanych niepełnosprawności wśród osób w wieku 60+?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '60 i więcej') SELECT disability_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wzrokowa' AS disability_type, niepelnosprawnosc_wzrok AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Słuchowa' AS disability_type, niepelnosprawnosc_sluch AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Ruchowa' AS disability_type, niepelnosprawnosc_ruch AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Inny typ' AS disability_type, niepelnosprawnosc_inna AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Żadna z powyższych' AS disability_type, niepelnosprawnosc_zadna AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' ) subquery WHERE selected = TRUE GROUP BY disability_type ORDER BY percentage DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W subregionie tyskim, jaki jest odsetek osób, które jako pierwsze skojarzenie z miejscami kultury GZM wymieniają NOSPR?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'NOSPR' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_nospr FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Tarnowskich Gór częściej chodzą na koncery niż mieszkańcy innych miejscowości w powiecie tarnogórskim?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH PTTG AS (SELECT id_uczestnika, gmina_miejscowosc, czestotliwosc_koncert, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc IS NOT NULL) SELECT CASE WHEN gmina_miejscowosc = 'Tarnowskie Góry' THEN 'Tarnowskie Góry' ELSE 'Inne gminy w powiecie TG' END AS miejsce, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM PTTG GROUP BY miejsce;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób preferujących uczestnictwo w kulturze w przestrzeni publicznej (parki, ulice) faktycznie brało udział w pikniku/festynie w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestniczacych_w_piknikach FROM participation_survey WHERE preferowane_miejsce_przestrzen_publiczna = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena dostępu do kultury w GZM (skala 1-7) wśród osób oceniających swoją wiedzę o ofercie kulturalnej jako niską (1-3) w porównaniu do osób oceniających ją jako wysoką (5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN wiedza_o_ofercie_kulturalnej_gzm IN ('1 bardzo niska', '2', '3') THEN 'Niska wiedza (1-3)' WHEN wiedza_o_ofercie_kulturalnej_gzm IN ('5', '6', '7 bardzo wysoka') THEN 'Wysoka wiedza (5-7)' ELSE 'Średnia/brak oceny' END AS poziom_wiedzy, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL GROUP BY poziom_wiedzy HAVING poziom_wiedzy IN ('Niska wiedza (1-3)', 'Wysoka wiedza (5-7)');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby z niepełnosprawnością w Katowicach mają lepszy dostęp do kultury niż osoby z niepełnosprawnością w mniejszych miastach GZM?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Mniejsze miasta GZM' END AS wielkosc_miasta, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dostep, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('5', '6', '7 w pełni wystarczający') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dobry_dostep FROM participation_survey WHERE (niepelnosprawnosc_ruch = TRUE OR niepelnosprawnosc_wzrok = TRUE OR niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_inna = TRUE) GROUP BY wielkosc_miasta;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców mniejszych miejscowości/gmin wiejskich uważa, że tradycja to kultura?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycja_kultura FROM participation_survey WHERE gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice');<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia miesięczna kwota wydatków na kulturę w gminie Łaziska Górne (pow. mikołowski)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Łaziska Górne' AND wydatki_na_kulture_kwota IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami gminy Chełm Śląski a mieszkańcami gminy Mierzęcice (pow. będziński).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Bobrownik i Kobióra odwiedza galerie sztuki przynajmniej raz na 3 lata?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galeria_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców zespołu dzielnic południowych Katowic odwiedził ostatnio (6 msc) park rozrywki?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_park_rozrywki, waga_proby, CASE WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_park_rozrywki_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic południowych';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami powiatu gliwickiego i powiatu będzińskiego.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat IN ('Powiat gliwicki', 'Powiat będziński') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które uważają, że kultura jest dla wszystkich, częściej odwiedzają teatry niż osoby, które się z tym nie zgadzają?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Kultura dla wszystkich)' WHEN opinia_kultura_dla_wszystkich IN ('1 zupełnie się nie zgadzam', '2', '3') THEN 'Nie zgadza się (Kultura dla wszystkich)' ELSE 'Neutralny/Brak opinii' END AS opinia_status, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_teatr_rocznie FROM participation_survey WHERE opinia_kultura_dla_wszystkich IS NOT NULL AND czestotliwosc_teatr IS NOT NULL GROUP BY opinia_status HAVING opinia_status != 'Neutralny/Brak opinii';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Katowic z zespołu dzielnic zachodnich odwiedził ostatnio (6 msc) koncert?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT ostatnio_koncert, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncert_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób, które nie mają dostępu do internetu w domu, odwiedziło bibliotekę w ciągu ostatnich 6 miesięcy?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_biblioteke FROM participation_survey WHERE internet_w_domu = FALSE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami katowickiej dzielnicy Piotrowice-Ochojec a mieszkańcami Mikołowa.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN dzielnica_katowic = 'Piotrowice - Ochojec' THEN 'Piotrowice-Ochojec (Dzielnica KTW)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Mikołów' THEN 'Mikołów (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (dzielnica_katowic = 'Piotrowice - Ochojec') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Mikołów') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców Sosnowca, którzy odwiedzili teatr, był w Teatrze Zagłębia?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Zagłębia w Sosnowcu' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wybral_tzaglebia FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_teatr = TRUE;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy dla osób z wyższym wykształceniem opiekujących się dziećmi poniżej 13 r.ż., uczestnictwo w kulturze jest równie istotne jak dla osób z wykształceniem niższym niż średnie opiekujących się dziećmi? Porównaj średnią ocenę istotności (skala 1-7).\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT wyksztalcenie, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY wyksztalcenie;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaka jest średnia ocena wiedzy o ofercie kulturalnej (1-7) wśród osób, które jako barierę wskazały niewystarczającą ilość informacji?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE bariera_brak_informacji = TRUE AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców gmin Mierzęcice i Gierałtowice czyta książki dla przyjemności przynajmniej raz w roku?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czyta_ksiazki_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') GROUP BY lokalizacja;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy w zespole dzielnic wschodnich Katowic mieszkańcy częściej odwiedzają muzea niż kina (ostatnie 6 msc)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZoneE AS ( SELECT ostatnio_muzeum, ostatnio_kino, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') ) SELECT 'Muzea (ost. 6 msc)' AS aktywnosc, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE UNION ALL SELECT 'Kina (ost. 6 msc)' AS aktywnosc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE ORDER BY procent DESC;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: W Katowicach, czy mieszkańcy zespołu dzielnic północnych częściej jako barierę wskazują problemy z dojazdem niż mieszkańcy zespołu dzielnic śródmiejskich?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH KatowiceZones AS ( SELECT bariera_dojazd, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic śródmiejskich') GROUP BY zona_dzielnic;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy osoby, które w ciągu ostatnich 6 miesięcy były w filharmonii lub operze, częściej zgadzają się ze stwierdzeniem, że uczestnictwo w kulturze daje poczucie prestiżu (ocena 5-7)?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN ostatnio_filharmonia = TRUE THEN 'Był(a) w filharmonii/operze (ost. 6 msc)' ELSE 'Nie był(a) w filharmonii/operze (ost. 6 msc)' END AS status_wizyty, ROUND(SUM(CASE WHEN opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_prestiz FROM participation_survey WHERE ostatnio_filharmonia IS NOT NULL AND opinia_kultura_prestiz IS NOT NULL GROUP BY status_wizyty;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj odsetek osób w wieku poniżej 30 lat i 60+ lat, które uważają, że 'to, jak traktujemy inne narody' jest częścią kultury.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT grupa_wiekowa, ROUND(SUM(CASE WHEN kultura_traktowanie_narodow = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_traktowanie_kultura FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Porównaj średnie miesięczne wydatki na kulturę między osobami z niepełnosprawnością słuchu LUB wzroku a osobami bez tych niepełnosprawności.\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT CASE WHEN niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_wzrok = TRUE THEN 'Słuch LUB Wzrok' ELSE 'Bez tych niepełnosprawności' END AS grupa_niepelnosprawnosci, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_niepelnosprawnosci;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Wśród osób poniżej 30 lat, czy większy procent korzysta z gier komputerowych czy z podcastów jako formy kultury cyfrowej?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30') SELECT 'Gry komputerowe i gaming' AS digital_form, ROUND(SUM(CASE WHEN cyfrowa_kultura_gry = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30' UNION ALL SELECT 'Podcasty' AS digital_form, ROUND(SUM(CASE WHEN cyfrowa_kultura_podcasty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent osób z wykształceniem podstawowym uważa, że pornografia to część kultury?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN kultura_pornografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_porno_kultura FROM participation_survey WHERE wyksztalcenie = 'niższe niż średnie';<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Bytomia i Rudy Śląskiej różnią się pod względem wydatków na kulturę w porównaniu do średniej dla całej metropolii?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nWITH MetroAvg AS (SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS avg_wydatki FROM participation_survey) SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki, (SELECT avg_wydatki FROM MetroAvg) AS srednia_metropolii, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby) - (SELECT avg_wydatki FROM MetroAvg), 2) AS roznica FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Ruda Śląska') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Czy mieszkańcy Zabrza częściej niż mieszkańcy Gliwic chodzą na koncerty?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT miasto_powiat, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty FROM participation_survey WHERE miasto_powiat IN ('Zabrze', 'Gliwice') GROUP BY miasto_powiat;<end_of_turn>\n"}
{"text": "<start_of_turn>user\nTranslate the following natural language query to SQL Question: Jaki procent mieszkańców GZM słyszało o określeniu Górnośląsko-Zagłębiowska Metropolia?\n\nGenerate only the SQL query.\n<end_of_turn>\n<start_of_turn>model\nSELECT ROUND(SUM(CASE WHEN znajomosc_metropolii_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_znajacych_termin FROM participation_survey;<end_of_turn>\n"}
