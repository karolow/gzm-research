{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy dla osób z wyższym wykształceniem opiekujących się dziećmi poniżej 13 r.ż., uczestnictwo w kulturze jest równie istotne jak dla osób z wykształceniem niższym niż średnie opiekujących się dziećmi? Porównaj średnią ocenę istotności (skala 1-7)."}, {"role": "assistant", "content": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY wyksztalcenie;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent mieszkańców gminy Psary i gminy Kobiór wskazuje 'brak czasu' jako barierę?"}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy w dzielnicach Katowic o zabytkowej zabudowie (jak Nikiszowiec, Murcki czy Giszowiec) mieszkańcy częściej doceniają kulturę jako element tożsamości lokalnej?"}, {"role": "assistant", "content": "SELECT CASE WHEN dzielnica_katowic IN ('Janów - Nikiszowiec', 'Giszowiec', 'Murcki') THEN 'Dzielnice zabytkowe' ELSE 'Pozostałe dzielnice' END AS typ_dzielnicy, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tozsamosc FROM participation_survey WHERE dzielnica_katowic IS NOT NULL GROUP BY typ_dzielnicy;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy mieszkańcy gminy Gierałtowice częściej niż mieszkańcy gminy Pilchowice odwiedzają miejsca kultury w Gliwicach?"}, {"role": "assistant", "content": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN miejsce_kultury_gliwice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedza_gliwice FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice') GROUP BY gmina_miejscowosc;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Wśród osób z wykształceniem wyższym, jaki procent tych, którzy pracują w miejscu zamieszkania, odwiedziło muzeum w ciągu ostatnich 12 miesięcy, w porównaniu do tych, którzy pracują poza miejscem zamieszkania?"}, {"role": "assistant", "content": "SELECT praca_w_miejscu_zamieszkania, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum_rocznie FROM participation_survey WHERE wyksztalcenie = 'wyższe' AND praca_w_miejscu_zamieszkania IS NOT NULL AND czestotliwosc_muzeum IS NOT NULL GROUP BY praca_w_miejscu_zamieszkania;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami zespołu dzielnic śródmiejskich Katowic a resztą Katowic."}, {"role": "assistant", "content": "WITH KatowiceZones AS ( SELECT ostatnio_muzeum, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Reszta Katowic' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM KatowiceZones GROUP BY zona_dzielnic;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy firmy MŚP, które już sponsorowały kulturę, częściej mają siedzibę w Katowicach niż w innych miastach GZM?"}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Inne miasta GZM' END AS lokalizacja_firmy, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE AND sponsorowanie_kultury = TRUE), 2) AS procent_firm_sponsorujacych FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE AND sponsorowanie_kultury = TRUE GROUP BY lokalizacja_firmy;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jak częstotliwość uczestnictwa w kulturze (np. muzea, teatr) koreluje z posiadaniem dostępu do internetu w domu?"}, {"role": "assistant", "content": "SELECT internet_w_domu, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_rocznie FROM participation_survey WHERE internet_w_domu IS NOT NULL GROUP BY internet_w_domu;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: W zespole dzielnic południowych Katowic, jaka aktywność domowa związana z kulturą jest najpopularniejsza: czytanie książek czy oglądanie programów TV?"}, {"role": "assistant", "content": "WITH KatowiceZoneS AS ( SELECT kultura_domowa_ksiazki, kultura_domowa_tv, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Czytanie książek' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_ksiazki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS UNION ALL SELECT 'Oglądanie programów TV' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_tv = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS ORDER BY procent DESC;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj średnie wydatki na kulturę między osobami w wieku 30-39 lat a osobami w wieku 60+ w subregionie tyskim."}, {"role": "assistant", "content": "SELECT grupa_wiekowa, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa IN ('30-39', '60 i więcej') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_wiekowa;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami Gliwic (miasto) a mieszkańcami Bierunia (gmina)."}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń' THEN 'Bieruń (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE (miasto_powiat = 'Gliwice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń') GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj średnią ocenę (1-7) wiedzy o ofercie kulturalnej GZM między ludźmi z Kobióra a ludźmi ze Zbrosławic."}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE ((miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice')) AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent mieszkańców gminy Wyry i gminy Zbrosławice wskazuje 'brak oferty lokalnej' jako barierę?"}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_lokalna FROM participation_survey WHERE (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy w Tychach osoby uważające, że moralność jest częścią kultury, częściej odwiedzają kościoły (implikowane przez kulturę religijną) niż osoby uważające inaczej?"}, {"role": "assistant", "content": "SELECT kultura_moralnosc, ROUND(SUM(CASE WHEN kultura_religia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_religia_jako_kultura FROM participation_survey WHERE miasto_powiat = 'Tychy' AND kultura_moralnosc IN ('Tak', 'Nie') GROUP BY kultura_moralnosc;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy mieszkańcy Sosnowca inaczej definiują kulturę niż mieszkańcy Bytomia?"}, {"role": "assistant", "content": "SELECT miasto_powiat, definicja_kultury_kategoria, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Bytom') AND definicja_kultury_kategoria IS NOT NULL AND definicja_kultury_kategoria NOT IN ('Nie wiem, trudno powiedzieć') GROUP BY miasto_powiat, definicja_kultury_kategoria ORDER BY miasto_powiat, procent_w_miescie DESC;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy osoby, które często odwiedzają galerie sztuki (przynajmniej raz w ciągu 12 miesięcy), częściej wskazują 'Sztuka/artyzm/wyrażanie siebie' jako swoją definicję kultury?"}, {"role": "assistant", "content": "SELECT CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Odwiedza galerie rocznie' ELSE 'Nie odwiedza galerii rocznie' END AS status_odwiedzin_galerii, ROUND(SUM(CASE WHEN definicja_kultury_kategoria = 'Sztuka/artyzm/wyrażanie siebie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_definiujacych_jako_sztuka FROM participation_survey WHERE czestotliwosc_galeria_sztuki IS NOT NULL AND definicja_kultury_kategoria IS NOT NULL GROUP BY status_odwiedzin_galerii;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Z jakich źródeł informacji o kulturze korzystają najczęściej osoby, które odwiedziły teatr w ciągu ostatnich 6 miesięcy?"}, {"role": "assistant", "content": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE ostatnio_teatr = TRUE) SELECT source, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Prasa drukowana' AS source, informacja_prasa_drukowana AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Plakaty/ogłoszenia/reklamy' AS source, informacja_plakaty AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Lokalne portale/strony' AS source, informacja_portale_lokalne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnopolskie portale/strony' AS source, informacja_portale_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile instytucji w mediach społecznościowych' AS source, informacja_social_media_instytucje AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile twórców w mediach społecznościowych' AS source, informacja_social_media_tworcy AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne profile w mediach społecznościowych' AS source, informacja_social_media_inne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Od znajomych/rodziny' AS source, informacja_znajomi_rodzina AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Radio' AS source, informacja_radio AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Telewizja' AS source, informacja_telewizja AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Strony internetowe instytucji kultury' AS source, informacja_strony_instytucji AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnotematyczne strony internetowe' AS source, informacja_strony_ogolne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne źródła' AS source, informacja_inne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Żadne z powyższych źródeł informacji' AS source, informacja_zadne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE ) subquery WHERE selected = TRUE GROUP BY source ORDER BY percentage DESC;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: W subregionie bytomskim, jakie jest top 3 skojarzenie (kategoria 1) z wydarzeniami GZM?"}, {"role": "assistant", "content": "SELECT skojarzenia_wydarzenia_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI'), 2) AS procent_wskazan FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' AND skojarzenia_wydarzenia_gzm_1_kategoria IS NOT NULL AND skojarzenia_wydarzenia_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_wydarzenia_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent osób mieszkających na wsi uważa, że dostęp do kultury w Metropolii GZM jest co najmniej wystarczający (ocena 5-7)?"}, {"role": "assistant", "content": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('5', '6', '7 w pełni wystarczający') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ocena_dostepu_5_7 FROM participation_survey WHERE wielkosc_miejscowosci = 'wieś';"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jakie 3 formy spędzania wolnego czasu są najważniejsze (ocena 'zdecydowanie tak') dla osób z segmentu 'Konsumenci Kultury Instytucjonalnej'?"}, {"role": "assistant", "content": "WITH SegmentData AS (SELECT * FROM participation_survey WHERE segment_uczestnika = 'Konsumenci Kultury Instytucjonalnej') SELECT 'Użyteczny/Praktyczny' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_praktycznosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Poczucie dumy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_duma = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Tworzenie rękodzieła' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rekodzielo = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Daje radość' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_radosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Czas z rodziną' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rodzina = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Potrzeby bliskich' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_potrzeby_bliskich = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Zakupy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_zakupy = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Jest nowością' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_nowosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Samopoznanie' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_samopoznanie = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData ORDER BY procent DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jakie formy uczestnictwa w kulturze w domu (TV, radio, podcasty, internet, prasa, książki) są najpopularniejsze wśród emerytów?"}, {"role": "assistant", "content": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE zatrudnienie_emeryt = TRUE) SELECT aktywnosc_domowa, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Oglądanie programów w TV' AS aktywnosc_domowa, kultura_domowa_tv AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie audycji w radiu' AS aktywnosc_domowa, kultura_domowa_radio AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie podcastów' AS aktywnosc_domowa, kultura_domowa_podcasty AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Oglądanie/czytanie treści w Internecie' AS aktywnosc_domowa, kultura_domowa_internet AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie prasy drukowanej' AS aktywnosc_domowa, kultura_domowa_prasa AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie książek dla przyjemności' AS aktywnosc_domowa, kultura_domowa_ksiazki AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Inne aktywności' AS aktywnosc_domowa, kultura_domowa_inne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Żadne z powyższych form uczestnictwa w kulturze w domu' AS aktywnosc_domowa, kultura_domowa_zadne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE ) subquery WHERE selected = TRUE GROUP BY aktywnosc_domowa ORDER BY procent DESC;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Ilu studentów z Sosnowca/Bytomia preferuje wydarzenia regionalne a ilu miejskie?"}, {"role": "assistant", "content": "SELECT miasto_powiat, event_type, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM ( SELECT miasto_powiat, 'Regionalne' AS event_type, wydarzenie_regionalne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Miejskie' AS event_type, wydarzenie_miejskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Dzielnicowe' AS event_type, wydarzenie_dzielnicowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Ogólnopolskie' AS event_type, wydarzenie_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Międzynarodowe' AS event_type, wydarzenie_miedzynarodowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Niezależne od podziałów admin.' AS event_type, wydarzenie_niezalezne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE ) subquery WHERE selected = TRUE GROUP BY miasto_powiat, event_type ORDER BY miasto_powiat, procent_w_miescie DESC;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy w powiecie mikołowskim osoby częściej odwiedzają kina czy teatry (przynajmniej raz na rok)?"}, {"role": "assistant", "content": "SELECT 'Kino (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' UNION ALL SELECT 'Teatr (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski';"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj średnią ocenę (1-7) istotności kultury między mieszkańcami Tychów a mieszkańcami gminy Kobiór."}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Tychy' THEN 'Tychy (Miasto)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE (miasto_powiat = 'Tychy') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy w Świętochłowicach osoby z wykształceniem średnim częściej niż osoby z wykształceniem wyższym odwiedzają pikniki/festyny (ostatnie 6 msc)?"}, {"role": "assistant", "content": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_piknik_6msc FROM participation_survey WHERE miasto_powiat = 'Świętochłowice' AND wyksztalcenie IN ('średnie', 'wyższe') GROUP BY wyksztalcenie;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj odsetek osób, które jako źródło informacji o kulturze wskazują portale lokalne, między mieszkańcami gminy Mierzęcice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński)."}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_portale_lokalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_portale_lokalne FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Czy mieszkańcy Katowic, którzy odwiedzili ostatnio (6 msc) spotkanie z artystą, częściej deklarują twórczość własną (np. pisanie, fotografia)?"}, {"role": "assistant", "content": "SELECT ostatnio_spotkanie_z_artysta, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE miasto_powiat = 'Katowice' AND ostatnio_spotkanie_z_artysta IS NOT NULL GROUP BY ostatnio_spotkanie_z_artysta;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaka jest średnia ocena (1-7) dostępu do kultury w GZM wśród osób, które odwiedziły teatr w ciągu ostatnich 12 miesięcy?"}, {"role": "assistant", "content": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' AND ocena_dostepu_do_kultury_gzm IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jakie bariery uczestnictwa w kulturze (procent wskazań dla każdej) są najczęściej wymieniane przez najmłodszą ('Mniej niż 30') i najstarszą ('60 i więcej') grupę wiekową?"}, {"role": "assistant", "content": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_oferta, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_info, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dostep_fizyczny, ROUND(SUM(CASE WHEN bariera_nieznajomosc_oferty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_nieznajomosc FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent osób, które nie mają dostępu do internetu w domu, odwiedziło bibliotekę w ciągu ostatnich 6 miesięcy?"}, {"role": "assistant", "content": "SELECT ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_biblioteke FROM participation_survey WHERE internet_w_domu = FALSE;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Wśród mieszkańców zespołu dzielnic zachodnich Katowic, jaka jest średnia miesięczna kwota wydatków na kulturę?"}, {"role": "assistant", "content": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jak uczestnictwo w kulturze i jej postrzeganie (np. średnia ocena przyjemności, odsetek odwiedzających muzea rocznie) różni się między rodzicami małych dzieci a pozostałymi osobami?"}, {"role": "assistant", "content": "SELECT opieka_nad_dzieckiem AS ma_dzieci_ponizej_13, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE opieka_nad_dzieckiem IS NOT NULL GROUP BY opieka_nad_dzieckiem;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent mieszkańców powiatu tarnogórskiego i mieszkańców Giszowca (Katowice) był ostatnio w domu kultury?"}, {"role": "assistant", "content": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' THEN 'Powiat Tarnogórski' WHEN dzielnica_katowic = 'Giszowiec' THEN 'Giszowiec KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_dom_kultury FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski') OR (dzielnica_katowic = 'Giszowiec') GROUP BY lokalizacja;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Sosnowca a mieszkańcami zespołu dzielnic wschodnich Katowic."}, {"role": "assistant", "content": "WITH KatowiceZoneE AS ( SELECT wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT 'Sosnowiec (Miasto)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Zespół dzielnic wschodnich KTW' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM KatowiceZoneE;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Które grupy wiekowe najczęściej myślą o Spodku gdy pyta się ich o GZM?"}, {"role": "assistant", "content": "SELECT grupa_wiekowa, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek'), 2) AS procent FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami miasta Gliwice a mieszkańcami powiatu gliwickiego."}, {"role": "assistant", "content": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE miasto_powiat IN ('Gliwice', 'Powiat gliwicki') GROUP BY miasto_powiat;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent osób w GZM, które opiekują się dzieckiem poniżej 13 r.ż., wskazuje 'opiekę nad inną osobą' jako barierę w uczestnictwie w kulturze?"}, {"role": "assistant", "content": "SELECT ROUND(SUM(CASE WHEN bariera_opieka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_opieka FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE;"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent mieszkańców Katowic z zespołu dzielnic śródmiejskich uważa, że 'umiejętność rozmawiania z innymi' to kultura?"}, {"role": "assistant", "content": "WITH KatowiceZones AS ( SELECT kultura_umiejetnosc_rozmowy, waga_proby, CASE WHEN dzielnica_katowic IN ('Śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN kultura_umiejetnosc_rozmowy = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rozmowa_kultura FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic śródmiejskich';"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaki procent mieszkańców Katowic z zespołu dzielnic zachodnich odwiedził ostatnio (6 msc) koncert?"}, {"role": "assistant", "content": "WITH KatowiceZones AS ( SELECT ostatnio_koncert, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncert_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';"}]}
{"messages": [{"role": "system", "content": "You are an AI assistant that translates natural language queries into SQL. Generate only the SQL query."}, {"role": "user", "content": "Translate the following natural language query to SQL. Question: Jaka jest średnia ocena (1-7) wiedzy o ofercie kulturalnej GZM wśród mieszkańców zespołu dzielnic północnych Katowic?"}, {"role": "assistant", "content": "WITH KatowiceZones AS ( SELECT wiedza_o_ofercie_kulturalnej_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic północnych';"}]}
