{
    "$schema": "eval_dataset_schema.json",
    "cases": [
        {
            "name": "1",
            "inputs": "Kto chętniej korzysta z instagrama, mieszkańcy Bytomia czy Gliwic?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN (kultura_online_instagram = TRUE OR instagram_profile_instytucji = TRUE OR instagram_profile_tworcow = TRUE OR instagram_profile_instytucji_miejskich = TRUE) THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uzytkownikow_instagrama FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Gliwice') GROUP BY miasto_powiat ORDER BY procent_uzytkownikow_instagrama DESC;",
                "result": "miasto_powiat|procent_uzytkownikow_instagrama\nBytom|11.11\nGliwice|5.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": ""
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "2",
            "inputs": "Jak często mieszkańcy centrum Katowic i Piotrowic chodzą do galerii sztuki?",
            "expected_output": {
                "sql_query": "SELECT dzielnica_katowic, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Przynajmniej raz w ciągu ostatnich 12 miesięcy\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Dawniej niż w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Dawniej niż w ciągu ostatnich 3 lat\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Nigdy, ale chciał(a)bym w przyszłości\", ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Nigdy i nie jestem tym zainteresowany(a)' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS \"Nigdy i nie jestem tym zainteresowany(a)\" FROM participation_survey WHERE dzielnica_katowic IN ('śródmieście', 'Piotrowice - Ochojec') AND czestotliwosc_galeria_sztuki IS NOT NULL GROUP BY dzielnica_katowic ORDER BY dzielnica_katowic;",
                "result": "dzielnica_katowic|Przynajmniej raz w ciągu ostatnich 12 miesięcy|Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat|Dawniej niż w ciągu ostatnich 3 lat|Nigdy, ale chciał(a)bym w przyszłości|Nigdy i nie jestem tym zainteresowany(a)\nPiotrowice - Ochojec|27.34|9.62|27.2|6.3|29.55\nśródmieście|36.23|6.57|38.23|9.26|9.7"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Assume that 'centrum Katowic' maps to 'Śródmieście' and 'Piotrowice' maps to 'Piotrowice - Ochojec'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "3",
            "inputs": "Jakie bariery uniemożliwiają seniorom z subregionu tyskie uczestnictwo w kulturze?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN bariera_wysokie_ceny = TRUE THEN 'Wysokie ceny' WHEN bariera_dojazd = TRUE THEN 'Problemy z dojazdem' WHEN bariera_nieatrakcyjna_oferta = TRUE THEN 'Mało atrakcyjna oferta' WHEN bariera_brak_informacji = TRUE THEN 'Niewystarczająca ilość informacji' WHEN bariera_dostep_fizyczny = TRUE THEN 'Trudności z fizycznym dostępem' WHEN bariera_godziny_otwarcia = TRUE THEN 'Mało dogodne godziny otwarcia' WHEN bariera_brak_czasu = TRUE THEN 'Brak czasu' WHEN bariera_opieka = TRUE THEN 'Opieka nad inną osobą' WHEN bariera_niska_jakosc = TRUE THEN 'Mało atrakcyjna jakościowo oferta' WHEN bariera_dostepnosc_biletow = TRUE THEN 'Niska dostępność biletów' WHEN bariera_brak_oferty_lokalnej = TRUE THEN 'Brak oferty lokalnej' WHEN bariera_nieznajomosc_oferty = TRUE THEN 'Nie znam oferty lokalnej' WHEN bariera_inne = TRUE THEN 'Inne' ELSE 'Brak barier' END AS bariera, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa = '60 i więcej'), 2) AS procent FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa = '60 i więcej' GROUP BY bariera ORDER BY procent DESC;",
                "result": "bariera|procent\nWysokie ceny|52.49\nBrak barier|12.38\nNie znam oferty lokalnej|10.18\nBrak czasu|6.56\nMało atrakcyjna oferta|5.81\nProblemy z dojazdem|4.24\nNiewystarczająca ilość informacji|3.11\nOpieka nad inną osobą|2.04\nNiska dostępność biletów|1.05\nBrak oferty lokalnej|0.64\nTrudności z fizycznym dostępem|0.56\nMało atrakcyjna jakościowo oferta|0.5\nMało dogodne godziny otwarcia|0.45"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Assumes senior maps to '60 i więcej'. Addresses multiple potential barriers, providing a comprehensive view."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "4",
            "inputs": "Jaki procent mężczyzn w Sosnowcu uważa że w kulturze poruszane są mało istotne dla nich tematy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_nieistotne_tematy IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_mezczyzn_nieistotne_tematy FROM participation_survey WHERE plec = 'Mężczyzna' AND miasto_powiat = 'Sosnowiec';",
                "result": "procent_mezczyzn_nieistotne_tematy\n25.84"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Maps 'agree that culture addresses irrelevant topics' to options 5, 6 and '7 w pełni sie zgadzam'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "5",
            "inputs": "Które miasto ma najwyższy odsetek osób które uważają że lubią poznawać nowe miejsca związane z kulturą?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_lubiacych_nowe_miejsca FROM participation_survey WHERE opinia_kultura_nowe_miejsca IS NOT NULL GROUP BY miasto_powiat ORDER BY procent_lubiacych_nowe_miejsca DESC LIMIT 1;",
                "result": "miasto_powiat|procent_lubiacych_nowe_miejsca\nPowiat pszczyński|78.07"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Maps 'Lubią poznawać nowe miejsca związane z kulturą' to options 5, 6 and '7 w pełni sie zgadzam'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "6",
            "inputs": "Jaki jest średni miesięczny wydatek na kulturę wśród osób z wyższym wykształceniem?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS sredni_wydatek_kultura FROM participation_survey WHERE wyksztalcenie = 'wyższe';",
                "result": "sredni_wydatek_kultura\n121.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Simple average calculation."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "7",
            "inputs": "Czy kobiety z katowickiej części metropolii częściej niż mężczyźni korzystają z kultury w domu?",
            "expected_output": {
                "sql_query": "WITH KatowiceWomen AS ( SELECT SUM(waga_proby) AS women_weight FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Kobieta' ), KatowiceMen AS ( SELECT SUM(waga_proby) AS men_weight FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Mężczyzna' ), WomenActivities AS ( SELECT waga_proby, CASE WHEN kultura_domowa_tv = TRUE OR kultura_domowa_radio = TRUE OR kultura_domowa_podcasty = TRUE OR kultura_domowa_internet = TRUE OR kultura_domowa_prasa = TRUE OR kultura_domowa_ksiazki = TRUE OR kultura_domowa_inne = TRUE THEN TRUE ELSE FALSE END AS any_cultural_activity FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Kobieta' ), MenActivities AS ( SELECT waga_proby, CASE WHEN kultura_domowa_tv = TRUE OR kultura_domowa_radio = TRUE OR kultura_domowa_podcasty = TRUE OR kultura_domowa_internet = TRUE OR kultura_domowa_prasa = TRUE OR kultura_domowa_ksiazki = TRUE OR kultura_domowa_inne = TRUE THEN TRUE ELSE FALSE END AS any_cultural_activity FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND plec = 'Mężczyzna' ) SELECT 'Kobiety' AS grupa, ROUND( SUM(CASE WHEN any_cultural_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT women_weight FROM KatowiceWomen), 2 ) AS percentage FROM WomenActivities UNION ALL SELECT 'Mężczyźni' AS grupa, ROUND( SUM(CASE WHEN any_cultural_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT men_weight FROM KatowiceMen), 2 ) AS percentage FROM MenActivities ORDER BY percentage DESC;",
                "result": "grupa|percentage\nKobiety|87.37\nMężczyźni|80.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Updated to combine subregion_metropolii_gzm 'KATOWICE' and 'KATOWICKI' as per user instruction for 'katowicka część metropolii'. Original expected_result is kept but will change based on the updated query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "8",
            "inputs": "Które grupy wiekowe najczęściej myślą o Spodku gdy pyta się ich o GZM?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek'), 2) AS procent FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent\n30-39|23.22\n40-49|25.3\n50-59|18.74\n60 i więcej|15.9\nMniej niż 30|16.83"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Age distribution for Spodek."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "9",
            "inputs": "Ilu studentów z Sosnowca/Bytomia preferuje wydarzenia regionalne a ilu miejskie?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, event_type, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM ( SELECT miasto_powiat, 'Regionalne' AS event_type, wydarzenie_regionalne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Miejskie' AS event_type, wydarzenie_miejskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Dzielnicowe' AS event_type, wydarzenie_dzielnicowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Ogólnopolskie' AS event_type, wydarzenie_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Międzynarodowe' AS event_type, wydarzenie_miedzynarodowe AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE UNION ALL SELECT miasto_powiat, 'Niezależne od podziałów admin.' AS event_type, wydarzenie_niezalezne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Sosnowiec') AND zatrudnienie_student = TRUE ) subquery WHERE selected = TRUE GROUP BY miasto_powiat, event_type ORDER BY miasto_powiat, procent_w_miescie DESC;",
                "result": "miasto_powiat|event_type|procent_w_miescie\nBytom|Miejskie|43.67\nBytom|Regionalne|19.9\nBytom|Dzielnicowe|11.23\nBytom|Ogólnopolskie|11.23\nBytom|Międzynarodowe|7.85\nBytom|Niezależne od podziałów admin.|6.13\nSosnowiec|Miejskie|37.83\nSosnowiec|Regionalne|22.17\nSosnowiec|Dzielnicowe|20.0\nSosnowiec|Niezależne od podziałów admin.|13.74\nSosnowiec|Ogólnopolskie|4.33\nSosnowiec|Międzynarodowe|1.93"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": ""
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "10",
            "inputs": "Z jakich źródeł informacji o kulturze korzystają najczęściej osoby które jeżdżą na rowerze?",
            "expected_output": {
                "sql_query": "WITH total AS (SELECT SUM(waga_proby) AS total_weight FROM participation_survey WHERE transport_wlasny_rower = TRUE) SELECT source, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total_weight FROM total), 2) AS percentage FROM ( SELECT 'Prasa drukowana' AS source, informacja_prasa_drukowana AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Plakaty/ogłoszenia/reklamy' AS source, informacja_plakaty AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Lokalne portale/strony' AS source, informacja_portale_lokalne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Ogólnopolskie portale/strony' AS source, informacja_portale_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Profile instytucji w mediach społecznościowych' AS source, informacja_social_media_instytucje AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Profile twórców w mediach społecznościowych' AS source, informacja_social_media_tworcy AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Inne profile w mediach społecznościowych' AS source, informacja_social_media_inne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Od znajomych/rodziny' AS source, informacja_znajomi_rodzina AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Radio' AS source, informacja_radio AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Telewizja' AS source, informacja_telewizja AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Strony internetowe instytucji kultury' AS source, informacja_strony_instytucji AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Ogólnotematyczne strony internetowe' AS source, informacja_strony_ogolne AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Inne źródła' AS source, informacja_inne_zrodla AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE UNION ALL SELECT 'Żadne z powyższych źródeł informacji' AS source, informacja_zadne_zrodla AS selected, waga_proby FROM participation_survey WHERE transport_wlasny_rower = TRUE ) subquery GROUP BY source ORDER BY percentage DESC;",
                "result": "source|percentage\nOd znajomych/rodziny|47.34\nPlakaty/ogłoszenia/reklamy|39.74\nLokalne portale/strony|30.91\nTelewizja|24.63\nOgólnopolskie portale/strony|20.36\nRadio|20.26\nProfile instytucji w mediach społecznościowych|20.26\nŻadne z powyższych źródeł informacji|19.59\nProfile twórców w mediach społecznościowych|16.85\nStrony internetowe instytucji kultury|16.22\nInne profile w mediach społecznościowych|15.72\nPrasa drukowana|15.31\nOgólnotematyczne strony internetowe|10.27\nInne źródła|0.21"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Comprehensive analysis of information sources."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "11",
            "inputs": "Jakie aktywności twórcze podejmują najczęściej osoby które uważają że kultura daje poczucie prestiżu?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam')) SELECT aktywnosc_tworcza, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Gra na instrumencie' AS aktywnosc_tworcza, tworczosc_gra_na_instrumencie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Pisanie tekstów' AS aktywnosc_tworcza, tworczosc_pisanie_tekstow AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Robienie zdjęć' AS aktywnosc_tworcza, tworczosc_fotografia AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Rysowanie lub malowanie' AS aktywnosc_tworcza, tworczosc_rysowanie_malowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Szycie/haftowanie' AS aktywnosc_tworcza, tworczosc_szycie_haftowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Śpiewanie' AS aktywnosc_tworcza, tworczosc_spiew AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Komponowanie muzyki' AS aktywnosc_tworcza, tworczosc_komponowanie AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Inna twórczość' AS aktywnosc_tworcza, tworczosc_inna AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') UNION ALL SELECT 'Żadne z powyższych aktywności twórczych' AS aktywnosc_tworcza, tworczosc_zadna AS selected, waga_proby FROM participation_survey WHERE opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') ) subquery WHERE selected = TRUE GROUP BY aktywnosc_tworcza ORDER BY procent DESC;",
                "result": "aktywnosc_tworcza|procent\nŻadne z powyższych aktywności twórczych|28.95\nRobienie zdjęć|10.87\nRysowanie lub malowanie|5.23\nSzycie/haftowanie|4.4\nGra na instrumencie|3.68\nŚpiewanie|3.6\nPisanie tekstów|2.28\nInna twórczość|2.05\nKomponowanie muzyki|1.21"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Maps 'kultura daje poczucie prestiżu' to options 5, 6 and '7 w pełni sie zgadzam'. Comprehensive overview of creative activities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "12",
            "inputs": "Ile kobiet bez wykształcenia wyższego deklaruje że kultura jest dla wszystkich?",
            "expected_output": {
                "sql_query": "SELECT plec, wyksztalcenie, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kobiety_kultura_dla_wszystkich FROM participation_survey WHERE plec = 'Kobieta' AND wyksztalcenie != 'wyższe' GROUP BY plec, wyksztalcenie;",
                "result": "plec|wyksztalcenie|procent_kobiety_kultura_dla_wszystkich\nKobieta|średnie|69.34\nKobieta|niższe niż średnie|58.02"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Maps 'kultura dla wszystkich' to options 5, 6 and '7 w pełni sie zgadzam'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "13",
            "inputs": "Jaki odsetek osób uważa że religia to kultura w Gliwicach i w Dąbrowie Górniczej?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN kultura_religia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_religia FROM participation_survey WHERE miasto_powiat IN ('Gliwice', 'Dąbrowa Górnicza') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_kultura_religia\nDąbrowa Górnicza|82.05\nGliwice|69.88"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": ""
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "14",
            "inputs": "Porównaj, jak postrzegają kulturę cyfrową osoby samozatrudnione i pracujące dla kogoś.",
            "expected_output": {
                "sql_query": "WITH Pracujacy AS ( SELECT SUM(waga_proby) AS pracujacy_weight FROM participation_survey WHERE zatrudnienie_pracujacy = TRUE ), Samozatrudnieni AS ( SELECT SUM(waga_proby) AS samozatrudnieni_weight FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE ), PracujacyDigital AS ( SELECT waga_proby, CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE THEN TRUE ELSE FALSE END AS any_digital_activity FROM participation_survey WHERE zatrudnienie_pracujacy = TRUE ), SamozatrudnieniDigital AS ( SELECT waga_proby, CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE THEN TRUE ELSE FALSE END AS any_digital_activity FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE ) SELECT 'Pracujący' AS grupa, ROUND( SUM(CASE WHEN any_digital_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / ( SELECT pracujacy_weight FROM Pracujacy ), 2 ) AS percentage FROM PracujacyDigital UNION ALL SELECT 'Samozatrudnieni' AS grupa, ROUND( SUM(CASE WHEN any_digital_activity = TRUE THEN waga_proby ELSE 0 END) * 100.0 / ( SELECT samozatrudnieni_weight FROM Samozatrudnieni ), 2 ) AS percentage FROM SamozatrudnieniDigital ORDER BY percentage DESC;",
                "result": "grupa|percentage\nSamozatrudnieni|78.57\nPracujący|55.85"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": ""
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "15",
            "inputs": "Które z tradycyjnych form spędzania czasu w domu (czytanie książek, prasa, tv, radio) dominują wśród osób z najwyższymi zarobkami?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł') SELECT aktywnosc_domowa, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Czytanie książek dla przyjemności' AS aktywnosc_domowa, kultura_domowa_ksiazki AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Czytanie prasy drukowanej' AS aktywnosc_domowa, kultura_domowa_prasa AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Oglądanie programów w TV' AS aktywnosc_domowa, kultura_domowa_tv AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Słuchanie audycji w radiu' AS aktywnosc_domowa, kultura_domowa_radio AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' UNION ALL SELECT 'Żadne z powyższych form uczestnictwa w kulturze w domu' AS aktywnosc_domowa, kultura_domowa_zadne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł' ) subquery WHERE selected = TRUE GROUP BY aktywnosc_domowa ORDER BY procent DESC;",
                "result": "aktywnosc_domowa|procent\nCzytanie książek dla przyjemności|52.4\nOglądanie programów w TV|46.14\nSłuchanie audycji w radiu|30.51\nCzytanie prasy drukowanej|24.54\nŻadne z powyższych form uczestnictwa w kulturze w domu|8.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Comprehensive query focused on activity preferences based on high income levels."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "16",
            "inputs": "Jakie są główne bariery w uczestnictwie w kulturze dla osób niepełnosprawnych ruchowo w porównaniu do reszty populacji?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN niepelnosprawnosc_ruch = TRUE THEN 'Niepełnosprawni ruchowo' ELSE 'Pozostali' END AS grupa, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wysokie_ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dojazd, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_nieatrakcyjna_oferta, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_brak_informacji, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dostep_fizyczny, ROUND(SUM(CASE WHEN bariera_godziny_otwarcia = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_godziny_otwarcia, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_brak_czasu, ROUND(SUM(CASE WHEN bariera_opieka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_opieka, ROUND(SUM(CASE WHEN bariera_niska_jakosc = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_niska_jakosc, ROUND(SUM(CASE WHEN bariera_dostepnosc_biletow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dostepnosc_biletow, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_brak_oferty_lokalnej, ROUND(SUM(CASE WHEN bariera_nieznajomosc_oferty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_nieznajomosc_oferty, ROUND(SUM(CASE WHEN bariera_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_inne, ROUND(SUM(CASE WHEN bariera_zadne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zadne FROM participation_survey GROUP BY grupa;",
                "result": "grupa|procent_wysokie_ceny|procent_dojazd|procent_nieatrakcyjna_oferta|procent_brak_informacji|procent_dostep_fizyczny|procent_godziny_otwarcia|procent_brak_czasu|procent_opieka|procent_niska_jakosc|procent_dostepnosc_biletow|procent_brak_oferty_lokalnej|procent_nieznajomosc_oferty|procent_inne|procent_zadne\nNiepełnosprawni ruchowo|49.47|23.39|9.62|17.8|15.89|11.68|30.59|19.35|9.21|12.05|3.16|9.33|5.59|3.71\nPozostali|42.62|13.61|15.36|16.31|3.21|8.95|40.65|6.34|8.96|10.67|1.9|6.12|1.01|15.38"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Focuses on main barriers (cena, dojazd, brak czasu) for a targeted demographic comparison."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "17",
            "inputs": "Jakie grupy wiekowe korzystają z internetu w określony sposób?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN internet_w_domu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom, ROUND(SUM(CASE WHEN internet_w_pracy = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_praca, ROUND(SUM(CASE WHEN internet_w_telefonie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_telefon, ROUND(SUM(CASE WHEN internet_w_domu = TRUE OR internet_w_pracy = TRUE OR internet_w_telefonie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogolny FROM participation_survey GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_dom|procent_praca|procent_telefon|procent_ogolny\n30-39|98.51|80.75|99.19|99.81\n40-49|97.42|77.47|98.81|99.62\n50-59|93.34|60.86|97.44|99.03\n60 i więcej|70.58|20.39|78.22|82.35\nMniej niż 30|98.28|65.19|99.35|99.75"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": ""
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "18",
            "inputs": "Czy osoby pracujące w sektorze kultury częściej umniejszają rolę kultury w życiu społecznym i prywatnym?",
            "expected_output": {
                "sql_query": "SELECT praca_w_sektorze_kultury, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') OR opinia_kultura_dla_wszystkich IN ('1', '2', '3', '4') OR opinia_kultura_bycie_na_biezaco IN ('1', '2', '3', '4') OR opinia_kultura_relacje_miedzyludzkie IN ('1', '2', '3', '4') OR opinia_kultura_przezycia IN ('1', '2', '3', '4') OR opinia_kultura_nowe_miejsca IN ('1', '2', '3', '4') OR opinia_kultura_atrakcyjnosc_regionu IN ('1', '2', '3', '4') OR opinia_kultura_przynaleznosc IN ('1', '2', '3', '4') OR opinia_kultura_samorealizacja IN ('1', '2', '3', '4') OR opinia_kultura_sens_zycia IN ('1', '2', '3', '4') OR opinia_kultura_prestiz IN ('1', '2', '3', '4') OR opinia_kultura_przyjemnosc IN ('1', '2', '3', '4') OR opinia_kultura_ubozsze_zycie IN ('1', '2', '3', '4') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_negatywnych_opinii FROM participation_survey GROUP BY praca_w_sektorze_kultury;",
                "result": "praca_w_sektorze_kultury|procent_negatywnych_opinii\nFalse|91.32\n<NA>|91.16\nTrue|81.54"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Negative sentiment for positive statements (culture importance, relations, self-realization) is 1-4; for negative statement (more important things than culture) is 5-7. Includes 13 opinion dimensions."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "19",
            "inputs": "Jakie miejsca w GZM są najczęsciej odwiedzane przez osoby które uczestniczą w kulturze?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey) SELECT miejsce_w_gzm, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Bytom' AS miejsce_w_gzm, miejsce_kultury_bytom AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Chorzów' AS miejsce_w_gzm, miejsce_kultury_chorzow AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Dąbrowa Górnicza' AS miejsce_w_gzm, miejsce_kultury_dabrowa_gornicza AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Gliwice' AS miejsce_w_gzm, miejsce_kultury_gliwice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Katowice' AS miejsce_w_gzm, miejsce_kultury_katowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Mysłowice' AS miejsce_w_gzm, miejsce_kultury_myslowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Piekary Śląskie' AS miejsce_w_gzm, miejsce_kultury_piekary_slaskie AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Ruda Śląska' AS miejsce_w_gzm, miejsce_kultury_ruda_slaska AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Siemianowice Śląskie' AS miejsce_w_gzm, miejsce_kultury_siemianowice_slaskie AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Sosnowiec' AS miejsce_w_gzm, miejsce_kultury_sosnowiec AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Świętochłowice' AS miejsce_w_gzm, miejsce_kultury_swietochlowice AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Tychy' AS miejsce_w_gzm, miejsce_kultury_tychy AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Zabrze' AS miejsce_w_gzm, miejsce_kultury_zabrze AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Inne' AS miejsce_w_gzm, miejsce_kultury_inne AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Nie pamiętam' AS miejsce_w_gzm, miejsce_kultury_nie_pamietam AS selected, waga_proby FROM participation_survey UNION ALL SELECT 'Żadne' AS miejsce_w_gzm, miejsce_kultury_zadne AS selected, waga_proby FROM participation_survey ) subquery WHERE selected = TRUE GROUP BY miejsce_w_gzm ORDER BY procent DESC;",
                "result": "miejsce_w_gzm|procent\nKatowice|42.34\nChorzów|22.28\nGliwice|15.87\nŻadne|13.52\nSosnowiec|11.87\nZabrze|11.21\nBytom|10.32\nTychy|8.62\nInne|8.04\nDąbrowa Górnicza|7.97\nRuda Śląska|6.33\nMysłowice|5.0\nPiekary Śląskie|3.7\nSiemianowice Śląskie|2.69\nŚwiętochłowice|2.57\nNie pamiętam|1.89"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Focus on engagement, requires a comprehensive query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "20",
            "inputs": "Związek między wielkością miejscowości zamieszkania a preferencjami dotyczącymi rodzaju wydarzeń kulturalnych (dzielnicowe, miejskie, regionalne, ogólnopolskie).",
            "expected_output": {
                "sql_query": "SELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN wydarzenie_dzielnicowe = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dzielnicowe, ROUND(SUM(CASE WHEN wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_miejskie, ROUND(SUM(CASE WHEN wydarzenie_regionalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_regionalne, ROUND(SUM(CASE WHEN wydarzenie_ogolnopolskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogolnopolskie FROM participation_survey GROUP BY wielkosc_miejscowosci ORDER BY wielkosc_miejscowosci;",
                "result": "wielkosc_miejscowosci|procent_dzielnicowe|procent_miejskie|procent_regionalne|procent_ogolnopolskie\nmiasto  poniżej 20 tys. mieszkańców|15.01|39.17|34.05|8.27\nmiasto 100 - 199 tys. mieszkańców|26.01|63.12|26.47|10.8\nmiasto 20 - 99 tys. mieszkańców|13.65|53.15|23.66|11.16\nmiasto powyżej 200 tys. mieszkańców|24.59|66.08|24.39|16.8\nwieś|16.21|50.63|16.99|6.99"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Multiple answers are possible."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "21",
            "inputs": "Czy osoby, które czerpią informacje o kulturze od znajomych i rodziny, częściej uczestniczą w piknikach i festynach?",
            "expected_output": {
                "sql_query": "SELECT informacja_znajomi_rodzina, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czestotliwosc_piknik, ROUND(SUM(CASE WHEN czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czestotliwosc_festyn FROM participation_survey GROUP BY informacja_znajomi_rodzina;",
                "result": "informacja_znajomi_rodzina|procent_pikniki|procent_czestotliwosc_piknik|procent_czestotliwosc_festyn\nFalse|32.71|38.8|38.79\nTrue|60.48|58.74|58.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Comprehensive exploration, direct and clear."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "22",
            "inputs": "Jak wygląda rozkład wydatków na kulturę wśród osób z wyższym wykształceniem?",
            "expected_output": {
                "sql_query": "SELECT wydatki_na_kulture_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wyksztalcenie = 'wyższe'), 2) AS procent FROM participation_survey WHERE wyksztalcenie = 'wyższe' GROUP BY wydatki_na_kulture_kategoria ORDER BY CASE wydatki_na_kulture_kategoria WHEN 'Mniej niż 50' THEN 1 WHEN '50-99' THEN 2 WHEN '100-149' THEN 3 WHEN '150-199' THEN 4 WHEN '200-249' THEN 5 WHEN '250 i więcej' THEN 6 WHEN 'Zero / Nie wiem, trudno powiedzieć' THEN 7 END;",
                "result": "wydatki_na_kulture_kategoria|procent\nMniej niż 50|16.3\n50-99|23.11\n100-149|21.14\n150-199|5.54\n200-249|12.85\n250 i więcej|12.28\nZero / Nie wiem, trudno powiedzieć|8.79"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Similar to a question related to average spending, but this time we're looking at the distribution of spending across different categories."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "23",
            "inputs": "Czy dla osób z wyższym wykształceniem opiekujących się dziećmi poniżej 13 r.ż., uczestnictwo w kulturze jest równie istotne jak dla osób z wykształceniem niższym niż średnie opiekujących się dziećmi? Porównaj średnią ocenę istotności (skala 1-7).",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|srednia_istotnosc\nwyższe|5.05\nniższe niż średnie|4.04"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Konwertuje skalę tekstową 'istotnosc_uczestnictwa_w_kulturze' na wartości numeryczne 1-7 w celu obliczenia średniej ważonej dla określonych grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "24",
            "inputs": "Jaki procent osób preferujących uczestnictwo w kulturze w przestrzeni publicznej (parki, ulice) faktycznie brało udział w pikniku/festynie w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestniczacych_w_piknikach FROM participation_survey WHERE preferowane_miejsce_przestrzen_publiczna = TRUE;",
                "result": "procent_uczestniczacych_w_piknikach\n69.07"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza odsetek uczestników pikników w podgrupie preferującej przestrzeń publiczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "25",
            "inputs": "Czy osoby czerpiące informacje o kulturze z mediów społecznościowych (profile instytucji, twórców lub inne) wydają miesięcznie więcej na kulturę niż osoby niekorzystające z tych źródeł? Porównaj średnie wydatki (kwota).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN informacja_social_media_instytucje = TRUE OR informacja_social_media_tworcy = TRUE OR informacja_social_media_inne = TRUE THEN 'Użytkownik Social Media (info kult.)' ELSE 'Nie używa Social Media do info kult.' END AS grupa_uzytkownikow, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_uzytkownikow;",
                "result": "grupa_uzytkownikow|srednie_wydatki_na_kulture\nUżytkownik Social Media (info kult.)|127.26\nNie używa Social Media do info kult.|105.9"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje średnie ważone wydatki między grupami zdefiniowanymi przez korzystanie z mediów społecznościowych jako źródła informacji o kulturze."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "26",
            "inputs": "Jakie bariery uczestnictwa w kulturze (procent wskazań dla każdej) są najczęściej wymieniane przez najmłodszą ('Mniej niż 30') i najstarszą ('60 i więcej') grupę wiekową?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_oferta, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_info, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dostep_fizyczny, ROUND(SUM(CASE WHEN bariera_nieznajomosc_oferty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_nieznajomosc FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_bariera_ceny|procent_bariera_dojazd|procent_bariera_oferta|procent_bariera_info|procent_bariera_czas|procent_bariera_dostep_fizyczny|procent_bariera_nieznajomosc\nMniej niż 30|41.56|16.78|17.65|14.96|45.08|3.4|5.34\n60 i więcej|49.36|16.99|13.85|16.58|26.21|5.94|9.46"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje procentowe wskazania dla wybranych barier między dwiema skrajnymi grupami wiekowymi. Główne bariery to ceny, dojazd, oferta, informacja, czas, dostęp fizyczny i nieznajomość oferty."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "27",
            "inputs": "Wśród osób definiujących kulturę głównie jako 'Sztuka/artyzm/wyrażanie siebie', jaka jest średnia częstotliwość wizyt w kinie (skala 1-5) oraz średnia częstotliwość korzystania z kultury online (skala 1-7)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 5 WHEN czestotliwosc_kino = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN 4 WHEN czestotliwosc_kino = 'Dawniej niż w ciągu ostatnich 3 lat' THEN 3 WHEN czestotliwosc_kino = 'Nigdy, ale chciał(a)bym w przyszłości' THEN 2 WHEN czestotliwosc_kino = 'Nigdy i nie jestem tym zainteresowany(a)' THEN 1 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_kino_1_5, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online_1_7 FROM participation_survey WHERE definicja_kultury_kategoria = 'Sztuka/artyzm/wyrażanie siebie';",
                "result": "srednia_czestotliwosc_kino_1_5|srednia_czestotliwosc_online_1_7\n4.24|3.62"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Konwertuje obie skale częstotliwości na wartości numeryczne (1-5 dla kina, 1-7 dla online) w celu obliczenia średniej ważonej dla specyficznej grupy respondentów."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "28",
            "inputs": "Jaki procent osób korzystających wyłącznie z transportu publicznego (miejskiego lub regionalnego, bez innych środków) odwiedzało miejsca kultury w innych miastach/gminach GZM niż miejsce zamieszkania w ciągu ostatnich 12 miesięcy? Porównaj z osobami korzystającymi wyłącznie z własnego samochodu.",
            "expected_output": {
                "sql_query": "WITH TransportGroups AS ( SELECT id_uczestnika, waga_proby, uczestnictwo_inne_miejsce_gzm, CASE WHEN (transport_komunikacja_miejska = TRUE OR transport_komunikacja_regionalna = TRUE) AND transport_wlasny_samochod = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN 'Tylko transport publiczny' WHEN transport_wlasny_samochod = TRUE AND transport_komunikacja_miejska = FALSE AND transport_komunikacja_regionalna = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN 'Tylko własny samochód' ELSE 'Inny/Mieszany' END AS typ_transportu FROM participation_survey ) SELECT typ_transportu, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_inne_miasta_gzm FROM TransportGroups WHERE typ_transportu IN ('Tylko transport publiczny', 'Tylko własny samochód') GROUP BY typ_transportu;",
                "result": "typ_transportu|procent_odwiedzajacych_inne_miasta_gzm\nTylko własny samochód|32.66\nTylko transport publiczny|17.48"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Precyzyjnie filtruje osoby używające *wyłącznie* transportu publicznego oraz *wyłącznie* własnego samochodu, sprawdzając czy inne opcje transportu są oznaczone jako FALSE. Porównuje odsetek odwiedzających inne miejsca w GZM między tymi dwoma grupami."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "29",
            "inputs": "Jaki procent segmentów 'Zdobywcy Wiedzy' i 'Aspirujący Mainstream' zgadza się (ocena 5-7) ze stwierdzeniem 'Działalność kulturalna i artystyczna podnosi atrakcyjność mojego regionu'?",
            "expected_output": {
                "sql_query": "SELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgadzajacych_sie FROM participation_survey WHERE segment_uczestnika IN ('Zdobywcy Wiedzy', 'Aspirujący Mainstream') GROUP BY segment_uczestnika;",
                "result": "segment_uczestnika|procent_zgadzajacych_sie\nZdobywcy Wiedzy|78.38\nAspirujący Mainstream|77.78"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje procent zgody (oceny 5-7) na temat wpływu kultury na atrakcyjność regionu między dwoma segmentami."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "30",
            "inputs": "Czy osoby opiekujące się osobą zależną (chorą, niepełnosprawną) częściej zgadzają się (ocena 5-7) ze stwierdzeniem 'Jest wiele ważniejszych rzeczy niż kultura' w porównaniu do osób nieopiekujących się taką osobą? Pokaż procenty.",
            "expected_output": {
                "sql_query": "SELECT opieka_nad_osoba_zalezna, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_wazniejsze_rzeczy FROM participation_survey GROUP BY opieka_nad_osoba_zalezna;",
                "result": "opieka_nad_osoba_zalezna|procent_zgody_wazniejsze_rzeczy\nFalse|41.78\nTrue|40.26"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje procent zgody (oceny 5-7) ze stwierdzeniem o priorytetach między osobami opiekującymi się a nieopiekującymi się osobą zależną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "31",
            "inputs": "Jaki procent mieszkańców Katowic, a jaki procent mieszkańców reszty GZM (bez Katowic) jest w stanie wymienić przynajmniej jednego twórcę kultury cyfrowej (na podstawie odpowiedzi na `znajomosc_tworcy_cyfrowego_1`)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN znajomosc_tworcy_cyfrowego_1 IS NOT NULL AND kategoria_tworcy_cyfrowego_1 != 'Nie wiem, trudno powiedzić' AND kategoria_tworcy_cyfrowego_1 != 'brak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_znajacych_tworce FROM participation_survey WHERE miasto_powiat IS NOT NULL GROUP BY obszar;",
                "result": "obszar|procent_znajacych_tworce\nReszta GZM|3.95\nKatowice|5.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Zakłada, że podanie jakiejkolwiek kategorii twórcy (innej niż 'Nie wiem...' lub 'brak') oznacza znajomość co najmniej jednego. Porównuje Katowice z resztą GZM (używając `miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "32",
            "inputs": "Jak istotne jest uczestnictwo w kulturze dla osób, które zetknęły się z twórczością lokalnego artysty choćby raz w porównaniu do tych, które się nie zetknęły w ogóle?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN kontakt_z_artysta_lokalnym IN ('tak, wielokrotnie', 'tak, raz czy dwa') THEN 'Zetknął/ęła się' ELSE 'Nie zetknął/ęła się' END AS kontakt_status, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE kontakt_z_artysta_lokalnym IS NOT NULL GROUP BY kontakt_status;",
                "result": "kontakt_status|srednia_istotnosc\nZetknął/ęła się|5.6\nNie zetknął/ęła się|4.4"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje średnią ważoną ocenę istotności kultury między grupami zdefiniowanymi przez kontakt z lokalnym artystą. Konwertuje skalę istotności na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "33",
            "inputs": "Czy 'brak czasu' jest częściej wskazywaną barierą (% wskazań) przez osoby o dochodach powyżej 6000 zł netto miesięcznie w porównaniu do osób o dochodach do 3500 zł netto?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN przedzial_wynagrodzenia IN ('powyżej 9000 zł') THEN 'Powyżej 9000 zł' WHEN przedzial_wynagrodzenia = 'do 3500 zł' THEN 'Do 3500 zł' ELSE 'Inny/Nie podano' END AS grupa_dochodowa, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_brak_czasu FROM participation_survey WHERE przedzial_wynagrodzenia NOT IN ('nie wiem, trudno powiedzieć', 'odmowa odpowiedzi') AND przedzial_wynagrodzenia IS NOT NULL GROUP BY grupa_dochodowa HAVING grupa_dochodowa IN ('Powyżej 9000 zł', 'Do 3500 zł');",
                "result": "grupa_dochodowa|procent_bariera_brak_czasu\nPowyżej 9000 zł|42.72\nDo 3500 zł|39.45"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Tworzy grupy dochodowe na podstawie przedziałów, wyklucza brak odpowiedzi i porównuje częstość występowania bariery 'brak czasu'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "34",
            "inputs": "Jaki procent mieszkańców mniejszych miast (poniżej 100 tys. mieszkańców) preferuje wydarzenia o zasięgu dzielnicowym lub miejskim, w porównaniu do mieszkańców największych miast (powyżej 200 tys. mieszkańców)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wielkosc_miejscowosci IN ('miasto poniżej 20 tys. mieszkańców', 'miasto 20 - 99 tys. mieszkańców') THEN 'Miasta < 100 tys.' WHEN wielkosc_miejscowosci = 'miasto powyżej 200 tys. mieszkańców' THEN 'Miasta > 200 tys.' ELSE 'Inne' END AS typ_miasta, ROUND(SUM(CASE WHEN wydarzenie_dzielnicowe = TRUE OR wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_preferujacych_lokalne FROM participation_survey WHERE wielkosc_miejscowosci IN ('miasto poniżej 20 tys. mieszkańców', 'miasto 20 - 99 tys. mieszkańców', 'miasto powyżej 200 tys. mieszkańców') GROUP BY typ_miasta;",
                "result": "typ_miasta|procent_preferujacych_lokalne\nMiasta < 100 tys.|59.14\nMiasta > 200 tys.|72.66"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje preferencje dotyczące lokalnych wydarzeń (dzielnicowych lub miejskich) między mieszkańcami miast różnej wielkości."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "35",
            "inputs": "Jaki odsetek osób pracujących wyłącznie zdalnie ('wyłącznie w domu | zdalnie') uczestniczy w kulturze wyłącznie w miejscu zamieszkania, w porównaniu do osób pracujących wyłącznie poza domem ('wyłącznie w miejscu pracy | poza domem')?",
            "expected_output": {
                "sql_query": "SELECT miejsce_wykonywania_pracy, ROUND(SUM(CASE WHEN uczestnictwo_miejsce_zamieszkania = TRUE AND uczestnictwo_miejsce_pracy = FALSE AND uczestnictwo_inne_miejsce_gzm = FALSE AND uczestnictwo_poza_gzm = FALSE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tylko_w_miejscu_zamieszkania FROM participation_survey WHERE miejsce_wykonywania_pracy IN ('wyłącznie w domu | zdalnie', 'wyłącznie w miejscu pracy | poza domem') GROUP BY miejsce_wykonywania_pracy;",
                "result": "miejsce_wykonywania_pracy|procent_tylko_w_miejscu_zamieszkania\nwyłącznie w miejscu pracy | poza domem|40.35\nwyłącznie w domu | zdalnie|28.32"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Precyzyjnie definiuje 'uczestnictwo wyłącznie w miejscu zamieszkania' przez sprawdzenie pozostałych lokalizacji jako FALSE. Porównuje dwie skrajne grupy trybu pracy."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "36",
            "inputs": "Jaka jest średnia ocena dostępu do kultury w GZM (skala 1-7) wśród osób oceniających swoją wiedzę o ofercie kulturalnej jako niską (1-3) w porównaniu do osób oceniających ją jako wysoką (5-7)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wiedza_o_ofercie_kulturalnej_gzm IN ('1 bardzo niska', '2', '3') THEN 'Niska wiedza (1-3)' WHEN wiedza_o_ofercie_kulturalnej_gzm IN ('5', '6', '7 bardzo wysoka') THEN 'Wysoka wiedza (5-7)' ELSE 'Średnia/brak oceny' END AS poziom_wiedzy, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL GROUP BY poziom_wiedzy HAVING poziom_wiedzy IN ('Niska wiedza (1-3)', 'Wysoka wiedza (5-7)');",
                "result": "poziom_wiedzy|srednia_ocena_dostepu\nNiska wiedza (1-3)|4.04\nWysoka wiedza (5-7)|5.37"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Bada korelację między samooceną wiedzy a oceną dostępności kultury, grupując respondentów wg poziomu wiedzy i konwertując skale na numeryczne dla średniej."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "37",
            "inputs": "Jaki procent osób z niepełnosprawnością ruchową korzysta z jakiejkolwiek cyfrowej formy kultury (wymienionej w pytaniu `cyfrowa_kultura_*`), w porównaniu do osób bez zadeklarowanych niepełnosprawności?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN niepelnosprawnosc_ruch = TRUE THEN 'Niepełnosprawność ruchowa' WHEN niepelnosprawnosc_zadna = TRUE THEN 'Brak zadeklarowanych niepełnosprawności' ELSE 'Inne/Nie dotyczy' END AS status_niepelnosprawnosci, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_z_kultury_cyfrowej FROM participation_survey WHERE niepelnosprawnosc_ruch = TRUE OR niepelnosprawnosc_zadna = TRUE GROUP BY status_niepelnosprawnosci;",
                "result": "status_niepelnosprawnosci|procent_korzystajacych_z_kultury_cyfrowej\nNiepełnosprawność ruchowa|50.72\nBrak zadeklarowanych niepełnosprawności|53.5"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Definiuje korzystanie z kultury cyfrowej jako zaznaczenie przynajmniej jednej z opcji `cyfrowa_kultura_*`. Porównuje grupę z niepełnosprawnością ruchową z grupą deklarującą brak niepełnosprawności."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "38",
            "inputs": "Jaka jest średnia miesięczna kwota wydatków na kulturę wśród osób, które korzystały z oferty kulturalnej poza GZM w ciągu ostatnich 12 miesięcy, w porównaniu do tych, które nie korzystały?",
            "expected_output": {
                "sql_query": "SELECT uczestnictwo_poza_gzm_czas, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL AND uczestnictwo_poza_gzm_czas IS NOT NULL GROUP BY uczestnictwo_poza_gzm_czas;",
                "result": "uczestnictwo_poza_gzm_czas|srednie_miesieczne_wydatki\nFalse|99.83\nTrue|158.24"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje średnie ważone wydatki na kulturę między osobami podróżującymi za kulturą poza GZM a tymi, którzy tego nie robią. Wyklucza brak danych o wydatkach lub o uczestnictwie poza GZM."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "39",
            "inputs": "Jaki procent osób czerpiących informacje z plakatów/ogłoszeń na mieście odwiedziło muzeum/galerię sztuki w ciągu ostatnich 6 miesięcy, w porównaniu do osób czerpiących informacje z lokalnych portali internetowych?",
            "expected_output": {
                "sql_query": "SELECT 'Plakaty/Ogłoszenia na mieście' AS zrodlo_informacji, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum FROM participation_survey WHERE informacja_plakaty = TRUE UNION ALL SELECT 'Lokalne portale internetowe' AS zrodlo_informacji, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum FROM participation_survey WHERE informacja_portale_lokalne = TRUE;",
                "result": "zrodlo_informacji|procent_odwiedzajacych_muzeum\nPlakaty/Ogłoszenia na mieście|9.43\nLokalne portale internetowe|13.27"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje efektywność dwóch różnych kanałów informacji (plakaty vs portale lokalne) w kontekście wizyt w muzeach/galeriach w ciągu ostatnich 6 miesięcy. Używa UNION ALL do połączenia wyników dla dwóch oddzielnych grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "40",
            "inputs": "Jak różni się odsetek osób zgadzających się (ocena 5-7) ze stwierdzeniem 'Nakłady publiczne na kulturę powinny być mniejsze, są ważniejsze potrzeby' między pracownikami sektora kultury a pozostałymi respondentami?",
            "expected_output": {
                "sql_query": "SELECT praca_w_sektorze_kultury, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_na_mniejsze_wydatki FROM participation_survey WHERE praca_w_sektorze_kultury IS NOT NULL GROUP BY praca_w_sektorze_kultury;",
                "result": "praca_w_sektorze_kultury|procent_zgody_na_mniejsze_wydatki\nFalse|33.35\nTrue|38.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje postawy wobec finansowania kultury (zgoda na mniejsze wydatki - oceny 5-7) między osobami pracującymi w sektorze a tymi spoza niego."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "41",
            "inputs": "Czy osoby, które uważają, że kultura jest dla wszystkich, częściej odwiedzają teatry niż osoby, które się z tym nie zgadzają?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Kultura dla wszystkich)' WHEN opinia_kultura_dla_wszystkich IN ('1 zupełnie się nie zgadzam', '2', '3') THEN 'Nie zgadza się (Kultura dla wszystkich)' ELSE 'Neutralny/Brak opinii' END AS opinia_status, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_teatr_rocznie FROM participation_survey WHERE opinia_kultura_dla_wszystkich IS NOT NULL AND czestotliwosc_teatr IS NOT NULL GROUP BY opinia_status HAVING opinia_status != 'Neutralny/Brak opinii';",
                "result": "opinia_status|procent_odwiedzajacych_teatr_rocznie\nZgadza się (Kultura dla wszystkich)|17.06\nNie zgadza się (Kultura dla wszystkich)|7.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje roczną frekwencję w teatrach między osobami o silnie pozytywnej i silnie negatywnej opinii na temat uniwersalności kultury."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "42",
            "inputs": "Który subregion GZM ma najwyższy odsetek mieszkańców uważających, że konsumpcja kultury sprawia im przyjemność (ocena 6-7)?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czerpiacych_przyjemnosc FROM participation_survey WHERE opinia_kultura_przyjemnosc IS NOT NULL GROUP BY subregion_metropolii_gzm ORDER BY procent_czerpiacych_przyjemnosc DESC LIMIT 1;",
                "result": "subregion_metropolii_gzm|procent_czerpiacych_przyjemnosc\nTYSKI|46.12"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Identyfikuje subregion z najwyższym odsetkiem osób silnie zgadzających się z hedonicznym aspektem kultury."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "43",
            "inputs": "Jaki procent osób, które jako barierę wskazały problemy z dojazdem, korzysta głównie z komunikacji miejskiej?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN transport_komunikacja_miejska = TRUE AND transport_wlasny_samochod = FALSE AND transport_komunikacja_regionalna = FALSE AND transport_wlasny_rower = FALSE AND transport_wspoldzielony = FALSE AND transport_pieszo = FALSE AND transport_inny = FALSE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_glownie_kom_miejska FROM participation_survey WHERE bariera_dojazd = TRUE;",
                "result": "procent_glownie_kom_miejska\n13.36"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Oblicza odsetek osób wskazujących barierę dojazdu, które jednocześnie deklarują *wyłączne* korzystanie z komunikacji miejskiej (sprawdzając inne opcje jako FALSE)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "44",
            "inputs": "Czy mieszkańcy Katowic, którzy często korzystają z kultury online (ocena 6-7), wydają średnio więcej na kulturę miesięcznie niż ci, którzy korzystają rzadko (ocena 1-2)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN czestotliwosc_kultura_online IN ('6', '7 bardzo często') THEN 'Często online (6-7)' WHEN czestotliwosc_kultura_online IN ('1 bardzo rzadko lub wcale', '2') THEN 'Rzadko online (1-2)' ELSE 'Średnio/Brak danych' END AS czestotliwosc_online, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_miesieczne FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICE' AND wydatki_na_kulture_kwota IS NOT NULL AND czestotliwosc_kultura_online IS NOT NULL GROUP BY czestotliwosc_online HAVING czestotliwosc_online IN ('Często online (6-7)', 'Rzadko online (1-2)');",
                "result": "czestotliwosc_online|srednie_wydatki_miesieczne\nCzęsto online (6-7)|159.65\nRzadko online (1-2)|86.75"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje średnie ważone wydatki na kulturę w Katowicach między grupami o różnej częstotliwości korzystania z kultury online. Konwertuje skalę częstotliwości i grupuje."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "45",
            "inputs": "Wśród osób z wykształceniem wyższym, jaki procent tych, którzy pracują w miejscu zamieszkania, odwiedziło muzeum w ciągu ostatnich 12 miesięcy, w porównaniu do tych, którzy pracują poza miejscem zamieszkania?",
            "expected_output": {
                "sql_query": "SELECT praca_w_miejscu_zamieszkania, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum_rocznie FROM participation_survey WHERE wyksztalcenie = 'wyższe' AND praca_w_miejscu_zamieszkania IS NOT NULL AND czestotliwosc_muzeum IS NOT NULL GROUP BY praca_w_miejscu_zamieszkania;",
                "result": "praca_w_miejscu_zamieszkania|procent_odwiedzajacych_muzeum_rocznie\nw miejscowości zamieszkania|35.78\npoza miejscowością zamieszkania|41.9"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada wpływ lokalizacji pracy (w vs poza miejscem zamieszkania) na roczną frekwencję w muzeach wśród osób z wyższym wykształceniem."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "46",
            "inputs": "Jakie trzy najczęstsze skojarzenia z MIEJSCAMI kultury GZM (kategoria 1) mają osoby z segmentu 'Młodzi Uciekinierzy'?",
            "expected_output": {
                "sql_query": "SELECT skojarzenia_miejsca_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy'), 2) AS procent_wskazan FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy' AND skojarzenia_miejsca_gzm_1_kategoria IS NOT NULL AND skojarzenia_miejsca_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_miejsca_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 3;",
                "result": "skojarzenia_miejsca_gzm_1_kategoria|procent_wskazan\nSpodek|8.58\nstadion / obiekt sportowy|4.81\ncentrum/dom kultury|3.71"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Identyfikuje top 3 konkretne skojarzenia z miejscami kultury (na podstawie pierwszej wymienionej kategorii) dla specyficznego segmentu, wykluczając odpowiedzi niekonkretne."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "47",
            "inputs": "Czy osoby często czytające książki dla przyjemności (przynajmniej raz w ciągu ostatnich 12 miesięcy) rzadziej wskazują 'brak zainteresowania ofertą' jako powód nieuczestniczenia w kulturze?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Czyta książki rocznie' ELSE 'Nie czyta książek rocznie' END AS status_czytelnika, ROUND(SUM(CASE WHEN powod_braku_uczestnictwa_kategoria = 'Brak ochoty/nie interesuje mnie to' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wskazujacy_brak_zainteresowania FROM participation_survey WHERE powod_braku_uczestnictwa_kategoria IS NOT NULL AND czestotliwosc_czytanie_ksiazek IS NOT NULL GROUP BY status_czytelnika;",
                "result": "status_czytelnika|procent_wskazujacy_brak_zainteresowania\nCzyta książki rocznie|10.24\nNie czyta książek rocznie|18.87"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, czy istnieje korelacja między aktywnym czytelnictwem a deklarowanym brakiem zainteresowania ofertą kulturalną jako powodem bierności."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "48",
            "inputs": "Jaki procent osób z niepełnosprawnością wzroku korzystało z oferty biblioteki w celu innym niż wypożyczenie książek (np. spotkanie, prelekcja, wystawa)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN biblioteka_wypozyczanie_innych_rzeczy = TRUE OR biblioteka_spotkanie_z_artysta = TRUE OR biblioteka_prelekcja = TRUE OR biblioteka_wystawa = TRUE OR biblioteka_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_z_innych_ofert_biblioteki FROM participation_survey WHERE niepelnosprawnosc_wzrok = TRUE;",
                "result": "procent_korzystajacych_z_innych_ofert_biblioteki\n3.65"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza odsetek osób z niepełnosprawnością wzroku angażujących się w dodatkowe działania biblioteczne poza wypożyczaniem książek."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "49",
            "inputs": "Porównaj średnią ocenę istotności uczestnictwa w kulturze (skala 1-7) między osobami, które jako główne źródło informacji wskazują znajomych/rodzinę, a tymi, które wskazują lokalne portale internetowe.",
            "expected_output": {
                "sql_query": "WITH InfoSource AS ( SELECT id_uczestnika, waga_proby, istotnosc_uczestnictwa_w_kulturze, CASE WHEN informacja_znajomi_rodzina = TRUE AND informacja_portale_lokalne = FALSE THEN 'Znajomi/Rodzina (głównie)' WHEN informacja_portale_lokalne = TRUE AND informacja_znajomi_rodzina = FALSE THEN 'Portale Lokalne (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo FROM participation_survey WHERE informacja_znajomi_rodzina = TRUE OR informacja_portale_lokalne = TRUE ) SELECT glowne_zrodlo, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM InfoSource WHERE glowne_zrodlo IN ('Znajomi/Rodzina (głównie)', 'Portale Lokalne (głównie)') AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY glowne_zrodlo;",
                "result": "glowne_zrodlo|srednia_istotnosc\nPortale Lokalne (głównie)|5.09\nZnajomi/Rodzina (głównie)|4.23"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Używa CTE do zdefiniowania grup na podstawie *głównego* źródła informacji (zakładając, że jedno jest TRUE, a drugie FALSE) i porównuje średnią ocenę istotności kultury. Konwertuje skalę istotności na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "50",
            "inputs": "Czy osoby, które w ciągu ostatnich 6 miesięcy były w filharmonii lub operze, częściej zgadzają się ze stwierdzeniem, że uczestnictwo w kulturze daje poczucie prestiżu (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN ostatnio_filharmonia = TRUE THEN 'Był(a) w filharmonii/operze (ost. 6 msc)' ELSE 'Nie był(a) w filharmonii/operze (ost. 6 msc)' END AS status_wizyty, ROUND(SUM(CASE WHEN opinia_kultura_prestiz IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_prestiz FROM participation_survey WHERE ostatnio_filharmonia IS NOT NULL AND opinia_kultura_prestiz IS NOT NULL GROUP BY status_wizyty;",
                "result": "status_wizyty|procent_zgody_prestiz\nBył(a) w filharmonii/operze (ost. 6 msc)|65.82\nNie był(a) w filharmonii/operze (ost. 6 msc)|43.43"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza korelację między niedawną wizytą w instytucji 'wysokiej kultury' a postrzeganiem kultury jako źródła prestiżu."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "51",
            "inputs": "Jaki procent osób mieszkających na wsi uważa, że dostęp do kultury w Metropolii GZM jest co najmniej wystarczający (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('5', '6', '7 w pełni wystarczający') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ocena_dostepu_5_7 FROM participation_survey WHERE wielkosc_miejscowosci = 'wieś';",
                "result": "procent_ocena_dostepu_5_7\n34.21"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filtruje mieszkańców wsi i oblicza odsetek pozytywnie oceniających dostęp do kultury w całej GZM."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "52",
            "inputs": "Wśród osób, które odwiedziły Chorzów w celach kulturalnych w ciągu ostatnich 12 miesięcy, jakie było najczęściej odwiedzane inne miasto GZM w tym samym okresie poza Katowicami?",
            "expected_output": {
                "sql_query": "WITH ChorzowVisitors AS ( SELECT id_uczestnika, waga_proby FROM participation_survey WHERE miejsce_kultury_chorzow = TRUE ), UnpivotedVisits AS ( SELECT id_uczestnika, 'Bytom' AS city_name FROM participation_survey WHERE miejsce_kultury_bytom = TRUE UNION ALL SELECT id_uczestnika, 'Dąbrowa Górnicza' FROM participation_survey WHERE miejsce_kultury_dabrowa_gornicza = TRUE UNION ALL SELECT id_uczestnika, 'Gliwice' FROM participation_survey WHERE miejsce_kultury_gliwice = TRUE UNION ALL SELECT id_uczestnika, 'Katowice' FROM participation_survey WHERE miejsce_kultury_katowice = TRUE UNION ALL SELECT id_uczestnika, 'Mysłowice' FROM participation_survey WHERE miejsce_kultury_myslowice = TRUE UNION ALL SELECT id_uczestnika, 'Piekary Śląskie' FROM participation_survey WHERE miejsce_kultury_piekary_slaskie = TRUE UNION ALL SELECT id_uczestnika, 'Ruda Śląska' FROM participation_survey WHERE miejsce_kultury_ruda_slaska = TRUE UNION ALL SELECT id_uczestnika, 'Siemianowice Śląskie' FROM participation_survey WHERE miejsce_kultury_siemianowice_slaskie = TRUE UNION ALL SELECT id_uczestnika, 'Sosnowiec' FROM participation_survey WHERE miejsce_kultury_sosnowiec = TRUE UNION ALL SELECT id_uczestnika, 'Świętochłowice' FROM participation_survey WHERE miejsce_kultury_swietochlowice = TRUE UNION ALL SELECT id_uczestnika, 'Tychy' FROM participation_survey WHERE miejsce_kultury_tychy = TRUE UNION ALL SELECT id_uczestnika, 'Zabrze' FROM participation_survey WHERE miejsce_kultury_zabrze = TRUE UNION ALL SELECT id_uczestnika, 'Inne' FROM participation_survey WHERE miejsce_kultury_inne = TRUE ) SELECT uv.city_name AS inne_odwiedzone_miasto, SUM(cv.waga_proby) AS wazona_liczba_odwiedzin FROM UnpivotedVisits uv JOIN ChorzowVisitors cv ON uv.id_uczestnika = cv.id_uczestnika WHERE uv.city_name NOT IN ('Chorzów', 'Katowice') GROUP BY uv.city_name ORDER BY wazona_liczba_odwiedzin DESC LIMIT 1;",
                "result": "inne_odwiedzone_miasto|wazona_liczba_odwiedzin\nBytom|262.8990831340307"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Używa CTE do zidentyfikowania osób odwiedzających Chorzów. Następnie 'unpivotuje' dane o odwiedzinach w innych miastach GZM. Łączy te dane, filtruje wizyty w Chorzowie ORAZ Katowicach, grupuje wg nazwy miasta i sumuje wagi, aby znaleźć najpopularniejsze *inne* miasto GZM (poza KTW) odwiedzane przez osoby bywające w Chorzowie."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "53",
            "inputs": "Jak różni się średnia ocena wiedzy o ofercie kulturalnej GZM (skala 1-7) między osobami poniżej 30 roku życia a osobami w wieku 50-59 lat?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '50-59') AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|srednia_ocena_wiedzy\n50-59|3.6\nMniej niż 30|3.83"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje średnią ważoną samoocenę wiedzy o kulturze GZM między dwiema grupami wiekowymi. Konwertuje skalę wiedzy na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "54",
            "inputs": "Jaki procent osób, które uważają, że najlepszy sposób spędzania wolnego czasu jest użyteczny/praktyczny (odpowiedź 'zdecydowanie tak'), odwiedziło dom kultury w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_dom_kultury FROM participation_survey WHERE wolny_czas_definicja_praktycznosc = 'zdecydowanie tak';",
                "result": "procent_odwiedzajacych_dom_kultury\n23.3"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada związek między silnym preferowaniem praktycznego spędzania wolnego czasu a roczną frekwencją w domach kultury."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "55",
            "inputs": "Czy osoby samozatrudnione częściej niż osoby zatrudnione na etacie śledzą profile twórców na Facebooku?",
            "expected_output": {
                "sql_query": "WITH EmploymentStatus AS ( SELECT CASE WHEN zatrudnienie_samozatrudniony = TRUE THEN 'Samozatrudniony' WHEN zatrudnienie_pracujacy = TRUE THEN 'Zatrudniony na etacie' ELSE 'Inny status' END AS status_zatrudnienia, facebook_profile_tworcow, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE OR zatrudnienie_pracujacy = TRUE ) SELECT status_zatrudnienia, ROUND(SUM(CASE WHEN facebook_profile_tworcow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzacych_tworcow_fb FROM EmploymentStatus GROUP BY 1;",
                "result": "status_zatrudnienia|procent_sledzacych_tworcow_fb\nSamozatrudniony|15.42\nZatrudniony na etacie|11.19"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Używa CTE do zdefiniowania statusu zatrudnienia. Porównuje odsetek osób śledzących twórców na FB między samozatrudnionymi a pracownikami etatowymi. Grupuje według pierwszej kolumny (status_zatrudnienia) w finalnym SELECT, używając jej pozycji (1)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "56",
            "inputs": "Jaka jest średnia miesięczna kwota wydatków na kulturę wśród osób, które zetknęły się z twórczością lokalnego artysty wielokrotnie?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_miesieczne FROM participation_survey WHERE kontakt_z_artysta_lokalnym = 'tak, wielokrotnie' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": "srednie_wydatki_miesieczne\n217.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza średnie ważone wydatki dla grupy respondentów deklarujących wielokrotny kontakt z lokalnymi artystami."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "57",
            "inputs": "Wśród osób, które preferują wydarzenia o zasięgu międzynarodowym, jaki procent odwiedził Katowice w celach kulturalnych w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN miejsce_kultury_katowice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_katowice FROM participation_survey WHERE wydarzenie_miedzynarodowe = TRUE;",
                "result": "procent_odwiedzajacych_katowice\n73.68"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada, czy preferencja dla wydarzeń międzynarodowych przekłada się na odwiedzanie Katowic (potencjalnego centrum takich wydarzeń) w celach kulturalnych."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "58",
            "inputs": "Czy osoby, które jako barierę wskazały wysokie ceny, częściej deklarują miesięczne wydatki na kulturę w przedziale 'Mniej niż 50' PLN niż osoby, które tej bariery nie wskazały?",
            "expected_output": {
                "sql_query": "SELECT bariera_wysokie_ceny, ROUND(SUM(CASE WHEN wydatki_na_kulture_kategoria = 'Mniej niż 50' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wydajacych_mniej_niz_50 FROM participation_survey WHERE wydatki_na_kulture_kategoria IS NOT NULL GROUP BY bariera_wysokie_ceny;",
                "result": "bariera_wysokie_ceny|procent_wydajacych_mniej_niz_50\nFalse|14.34\nTrue|24.78"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, czy deklarowana bariera cenowa pokrywa się z niskim poziomem raportowanych wydatków na kulturę."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "59",
            "inputs": "Jakie formy uczestnictwa w kulturze w domu (TV, radio, podcasty, internet, prasa, książki) są najpopularniejsze wśród emerytów?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE zatrudnienie_emeryt = TRUE) SELECT aktywnosc_domowa, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Oglądanie programów w TV' AS aktywnosc_domowa, kultura_domowa_tv AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie audycji w radiu' AS aktywnosc_domowa, kultura_domowa_radio AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Słuchanie podcastów' AS aktywnosc_domowa, kultura_domowa_podcasty AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Oglądanie/czytanie treści w Internecie' AS aktywnosc_domowa, kultura_domowa_internet AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie prasy drukowanej' AS aktywnosc_domowa, kultura_domowa_prasa AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Czytanie książek dla przyjemności' AS aktywnosc_domowa, kultura_domowa_ksiazki AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Inne aktywności' AS aktywnosc_domowa, kultura_domowa_inne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE UNION ALL SELECT 'Żadne z powyższych form uczestnictwa w kulturze w domu' AS aktywnosc_domowa, kultura_domowa_zadne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_emeryt = TRUE ) subquery WHERE selected = TRUE GROUP BY aktywnosc_domowa ORDER BY procent DESC;",
                "result": "aktywnosc_domowa|procent\nOglądanie programów w TV|50.16\nCzytanie książek dla przyjemności|41.33\nŻadne z powyższych form uczestnictwa w kulturze w domu|30.94\nOglądanie/czytanie treści w Internecie|21.34\nSłuchanie audycji w radiu|17.01\nCzytanie prasy drukowanej|13.84\nSłuchanie podcastów|7.55\nInne aktywności|0.83"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identyfikuje top 3 najpopularniejsze formy kultury domowej wśród emerytów. Wymaga rozbudowanego CASE WHEN lub unpivotingu. Skupia się na procentach w obrębie grupy emerytów."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "60",
            "inputs": "Jaki procent osób, które korzystają z kultury poza GZM, jako powód lub rodzaj aktywności wskazuje (w pytaniu otwartym) coś związanego z teatrem?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN LOWER(aktywnosc_poza_gzm_tekst) LIKE '%teatr%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wskazujacy_teatr FROM participation_survey WHERE uczestnictwo_poza_gzm_czas = TRUE AND aktywnosc_poza_gzm_tekst IS NOT NULL;",
                "result": "procent_wskazujacy_teatr\n5.79"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Analizuje odpowiedzi otwarte (`aktywnosc_poza_gzm_tekst`) osób korzystających z kultury poza GZM, szukając wystąpień słowa 'teatr' (lub jego części, np. 'teatralny') jako powodu/rodzaju aktywności. Używa `LOWER` i `LIKE '%teatr%'` dla elastycznego dopasowania."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "61",
            "inputs": "Czy osoby, które uważają, że wypada być na bieżąco z kulturą (ocena 6-7), częściej śledzą profile instytucji kultury na Instagramie?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_kultura_bycie_na_biezaco IN ('6', '7 w pełni sie zgadzam') THEN 'Uważa, że wypada (6-7)' ELSE 'Nie uważa, że wypada / Mniej (1-5)' END AS opinia_status, ROUND(SUM(CASE WHEN instagram_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzacych_instytucje_ig FROM participation_survey WHERE opinia_kultura_bycie_na_biezaco IS NOT NULL GROUP BY opinia_status;",
                "result": "opinia_status|procent_sledzacych_instytucje_ig\nNie uważa, że wypada / Mniej (1-5)|3.26\nUważa, że wypada (6-7)|4.67"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada związek między presją społeczną/normą bycia na bieżąco z kulturą a konkretnym zachowaniem online (śledzenie instytucji na IG)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "62",
            "inputs": "Jaki jest rozkład odpowiedzi na pytanie o częstotliwość wizyt w kinie wśród mieszkańców dzielnicy Katowic: Osiedle Tysiąclecia?",
            "expected_output": {
                "sql_query": "SELECT czestotliwosc_kino, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE dzielnica_katowic = 'Osiedle Tysiąclecia'), 2) AS procent_odpowiedzi FROM participation_survey WHERE dzielnica_katowic = 'Osiedle Tysiąclecia' AND czestotliwosc_kino IS NOT NULL GROUP BY czestotliwosc_kino ORDER BY CASE czestotliwosc_kino WHEN 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 1 WHEN 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN 2 WHEN 'Dawniej niż w ciągu ostatnich 3 lat' THEN 3 WHEN 'Nigdy, ale chciał(a)bym w przyszłości' THEN 4 WHEN 'Nigdy i nie jestem tym zainteresowany(a)' THEN 5 ELSE 6 END;",
                "result": "czestotliwosc_kino|procent_odpowiedzi\nPrzynajmniej raz w ciągu ostatnich 12 miesięcy|40.23\nDawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat|22.17\nDawniej niż w ciągu ostatnich 3 lat|31.28\nNigdy, ale chciał(a)bym w przyszłości|6.32"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Pokazuje pełny rozkład procentowy odpowiedzi na pytanie o częstotliwość wizyt w kinie dla mieszkańców konkretnej dzielnicy Katowic."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "63",
            "inputs": "Czy osoby, które podejmują jakąkolwiek aktywność twórczą (np. gra na instrumencie, pisanie, fotografia etc.), częściej uważają, że kultura pozwala im się realizować (ocena 6-7)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN 'Podejmuje aktywność twórczą' ELSE 'Nie podejmuje aktywności twórczej' END AS status_tworczosci, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_samorealizacja FROM participation_survey GROUP BY status_tworczosci;",
                "result": "status_tworczosci|procent_zgody_samorealizacja\nNie podejmuje aktywności twórczej|19.79\nPodejmuje aktywność twórczą|34.17"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, czy osoby aktywne twórczo częściej postrzegają kulturę jako ścieżkę do samorealizacji."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "64",
            "inputs": "Jaki procent osób, które nie mają dostępu do internetu w domu, odwiedziło bibliotekę w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_biblioteke FROM participation_survey WHERE internet_w_domu = FALSE;",
                "result": "procent_odwiedzajacych_biblioteke\n4.94"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada potencjalną rolę biblioteki jako substytutu dostępu do informacji/kultury dla osób bez internetu domowego."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "65",
            "inputs": "Czy osoby, które uważają gry komputerowe za część kultury, częściej korzystają z oferty domów kultury (przynajmniej raz w ciągu ostatnich 12 miesięcy)?",
            "expected_output": {
                "sql_query": "SELECT kultura_gry_komputerowe, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_dom_kultury_rocznie FROM participation_survey WHERE kultura_gry_komputerowe IN ('Tak', 'Nie') AND czestotliwosc_dom_kultury IS NOT NULL GROUP BY kultura_gry_komputerowe;",
                "result": "kultura_gry_komputerowe|procent_odwiedzajacych_dom_kultury_rocznie\nTak|22.53\nNie|20.09"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, czy postrzeganie gier jako kultury koreluje z uczestnictwem w tradycyjnych instytucjach jak domy kultury."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "66",
            "inputs": "Jaka jest średnia ocena (1-7) stwierdzenia 'Lubię poznawać nowe miejsca związane z kulturą' wśród osób z segmentu 'Ludowi Tradycjonaliści'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_nowe_miejsca = '2' THEN 2 WHEN opinia_kultura_nowe_miejsca = '3' THEN 3 WHEN opinia_kultura_nowe_miejsca = '4' THEN 4 WHEN opinia_kultura_nowe_miejsca = '5' THEN 5 WHEN opinia_kultura_nowe_miejsca = '6' THEN 6 WHEN opinia_kultura_nowe_miejsca = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_nowe_miejsca FROM participation_survey WHERE segment_uczestnika = 'Ludowi Tradycjonaliści' AND opinia_kultura_nowe_miejsca IS NOT NULL;",
                "result": "srednia_ocena_nowe_miejsca\n4.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza średnią ważoną ocenę dla konkretnego stwierdzenia w ramach specyficznego segmentu. Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "67",
            "inputs": "Czy osoby korzystające z transportu współdzielonego (rower/hulajnoga na minuty) częściej uczestniczą w piknikach/festynach (w ostatnich 6 msc) niż osoby korzystające głównie z własnego samochodu?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN transport_wspoldzielony = TRUE AND transport_wlasny_samochod = FALSE THEN 'Transport współdzielony (bez auta)' WHEN transport_wlasny_samochod = TRUE AND transport_wspoldzielony = FALSE THEN 'Głównie własny samochód (bez shared)' ELSE 'Inny/Mieszany' END AS typ_transportu, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestniczacych_w_piknikach FROM participation_survey WHERE (transport_wspoldzielony = TRUE AND transport_wlasny_samochod = FALSE) OR (transport_wlasny_samochod = TRUE AND transport_wspoldzielony = FALSE) GROUP BY typ_transportu;",
                "result": "typ_transportu|procent_uczestniczacych_w_piknikach\nTransport współdzielony (bez auta)|32.02\nGłównie własny samochód (bez shared)|49.43"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje udział w piknikach między użytkownikami transportu współdzielonego (zakładając brak auta) a użytkownikami głównie auta (zakładając brak shared). Filtruje, aby grupy były w miarę rozłączne pod tym względem."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "68",
            "inputs": "Jakie jest najczęstsze skojarzenie z wydarzeniami kulturalnymi GZM wśród osób w wieku 60+?",
            "expected_output": {
                "sql_query": "SELECT skojarzenia_wydarzenia_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE grupa_wiekowa = '60 i więcej'), 2) AS procent_wskazan FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' AND skojarzenia_wydarzenia_gzm_1_kategoria IS NOT NULL AND skojarzenia_wydarzenia_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_wydarzenia_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 1;",
                "result": "skojarzenia_wydarzenia_gzm_1_kategoria|procent_wskazan\nkoncerty / imprezy muzyczne|6.59"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Identyfikuje dominujące skojarzenie z wydarzeniami (na podstawie pierwszej wymienionej kategorii) w najstarszej grupie wiekowej, pomijając odpowiedzi niekonkretne."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "69",
            "inputs": "Czy odsetek osób uważających patriotyzm za część kultury jest wyższy w subregionie bytomskim niż w sosnowieckim?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_jako_kultura FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_patriotyzm_jako_kultura\nSOSNOWIECKI|77.11\nBYTOMSKI|77.03"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje postrzeganie patriotyzmu jako elementu kultury między dwoma konkretnymi subregionami."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "70",
            "inputs": "Jaki procent osób, które jako barierę wskazały brak czasu, pracuje w trybie częściowo zdalnym ('częściowo w miejscu pracy, częściowo w domu lub zdalnie')?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN miejsce_wykonywania_pracy = 'częściowo w miejscu pracy, częściowo w domu lub zdalnie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pracujacych_czesciowo_zdalnie FROM participation_survey WHERE bariera_brak_czasu = TRUE;",
                "result": "procent_pracujacych_czesciowo_zdalnie\n10.72"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, jaki odsetek osób odczuwających brak czasu pracuje w modelu hybrydowym."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "71",
            "inputs": "Porównaj odsetek osób, które w ciągu ostatnich 6 miesięcy odwiedziły park rozrywki, między mieszkańcami subregionu tyskiego a katowickiego.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Tyski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_park_rozrywki FROM participation_survey WHERE subregion_metropolii_gzm IN ('TYSKI', 'KATOWICE', 'KATOWICKI') GROUP BY subregion_grupa;",
                "result": "subregion_grupa|procent_odwiedzajacych_park_rozrywki\nTyski|33.14\nKatowicki (łącznie z Katowicami)|33.68"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Updated to combine subregion_metropolii_gzm 'KATOWICE' and 'KATOWICKI' into a single group 'Katowicki (łącznie z Katowicami)' for comparison with 'TYSKI', as per user instruction for 'katowickiego'. Original expected_result is kept but will change (structure and values) based on the updated query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "72",
            "inputs": "Czy osoby, które definiują kulturę jako 'Kultura osobista/zachowanie ludzi', częściej zgadzają się ze stwierdzeniem 'Umiejętność rozmawiania z innymi' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN definicja_kultury_kategoria = 'Kultura osobista/zachowanie ludzi/zachowanie w stosunku do innych ludzi/tolerancja' THEN 'Definiuje jako Kultura osobista' ELSE 'Inna definicja' END AS definicja_kultury, ROUND(SUM(CASE WHEN kultura_umiejetnosc_rozmowy = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_rozmowa_to_kultura FROM participation_survey WHERE definicja_kultury_kategoria IS NOT NULL GROUP BY definicja_kultury;",
                "result": "definicja_kultury|procent_zgody_rozmowa_to_kultura\nDefiniuje jako Kultura osobista|96.47\nInna definicja|86.44"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza spójność między ogólną definicją kultury a oceną konkretnego jej aspektu (umiejętność rozmowy)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "73",
            "inputs": "Jaka jest średnia ocena (1-7) dostępu do kultury w GZM wśród osób, które odwiedziły teatr w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' AND ocena_dostepu_do_kultury_gzm IS NOT NULL;",
                "result": "srednia_ocena_dostepu\n5.24"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza średnią ważoną ocenę dostępu do kultury dla grupy aktywnych widzów teatralnych. Konwertuje skalę oceny na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "74",
            "inputs": "Wśród osób korzystających z kultury cyfrowej przez podcasty, jaki procent również czyta książki dla przyjemności (przynajmniej raz w ciągu ostatnich 12 miesięcy)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czytajacych_ksiazki FROM participation_survey WHERE cyfrowa_kultura_podcasty = TRUE;",
                "result": "procent_czytajacych_ksiazki\n72.42"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada współwystępowanie dwóch form konsumpcji treści: słuchania podcastów i czytania książek."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "75",
            "inputs": "Jakie działania w domach kultury (np. koncerty, filmy, wystawy) są najpopularniejsze wśród osób w wieku 30-39 lat, które odwiedziły dom kultury?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE) SELECT aktywnosc_w_dk, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent_wskazan FROM ( SELECT 'Spotkanie z artystą' AS aktywnosc_w_dk, dom_kultury_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Odczyt / prelekcja' AS aktywnosc_w_dk, dom_kultury_prelekcja AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Pokaz filmu' AS aktywnosc_w_dk, dom_kultury_film AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Przedstawienie teatralne' AS aktywnosc_w_dk, dom_kultury_teatr AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Koncert' AS aktywnosc_w_dk, dom_kultury_koncert AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Wystawa' AS aktywnosc_w_dk, dom_kultury_wystawa AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Inne' AS aktywnosc_w_dk, dom_kultury_inne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND ostatnio_dom_kultury = TRUE ) subquery WHERE selected = TRUE GROUP BY aktywnosc_w_dk ORDER BY procent_wskazan DESC;",
                "result": "aktywnosc_w_dk|procent_wskazan\nKoncert|13.92\nPokaz filmu|13.91\nWystawa|13.71\nPrzedstawienie teatralne|12.29\nInne|9.81\nSpotkanie z artystą|8.82\nOdczyt / prelekcja|8.29"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identyfikuje top 3 aktywności w domach kultury dla konkretnej grupy wiekowej (30-39 lat), która faktycznie odwiedziła taką instytucję. Wymaga rozbudowanego CASE WHEN lub unpivotingu."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "76",
            "inputs": "Czy osoby, które uważają, że nakłady publiczne na kulturę powinny być mniejsze (ocena 6-7), rzadziej odwiedzają muzea (przynajmniej raz w ciągu ostatnich 12 miesięcy)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Mniejsze wydatki)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_wydatki, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_muzeum_rocznie FROM participation_survey WHERE opinia_wydatki_publiczne_na_kulture IS NOT NULL AND czestotliwosc_muzeum IS NOT NULL GROUP BY opinia_wydatki;",
                "result": "opinia_wydatki|procent_odwiedzajacych_muzeum_rocznie\nZgadza się (Mniejsze wydatki)|19.13\nNie zgadza się / Mniej (1-5)|20.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Sprawdza, czy opinia na temat finansowania kultury koreluje z faktycznym korzystaniem z instytucji muzealnych."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "77",
            "inputs": "Jaki procent osób z powiatu będzińskiego uważa, że działalność kulturalna podnosi atrakcyjność regionu (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc_regionu FROM participation_survey WHERE miasto_powiat = 'Powiat będziński';",
                "result": "procent_zgody_atrakcyjnosc_regionu\n46.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Oblicza odsetek osób z konkretnego powiatu zgadzających się z pozytywnym wpływem kultury na wizerunek regionu."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "78",
            "inputs": "Porównaj odsetek osób grających na instrumencie między mieszkańcami miast poniżej 20 tys. a mieszkańcami miast powyżej 200 tys.",
            "expected_output": {
                "sql_query": "SELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_grajacych_na_instrumencie FROM participation_survey WHERE wielkosc_miejscowosci IN ('miasto  poniżej 20 tys. mieszkańców', 'miasto powyżej 200 tys. mieszkańców') GROUP BY wielkosc_miejscowosci;",
                "result": "wielkosc_miejscowosci|procent_grajacych_na_instrumencie\nmiasto powyżej 200 tys. mieszkańców|3.44\nmiasto  poniżej 20 tys. mieszkańców|0.95"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje popularność gry na instrumencie między mieszkańcami najmniejszych i największych miast w próbie."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "79",
            "inputs": "Czy osoby, które często odwiedzają galerie sztuki (przynajmniej raz w ciągu 12 miesięcy), częściej wskazują 'Sztuka/artyzm/wyrażanie siebie' jako swoją definicję kultury?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Odwiedza galerie rocznie' ELSE 'Nie odwiedza galerii rocznie' END AS status_odwiedzin_galerii, ROUND(SUM(CASE WHEN definicja_kultury_kategoria = 'Sztuka/artyzm/wyrażanie siebie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_definiujacych_jako_sztuka FROM participation_survey WHERE czestotliwosc_galeria_sztuki IS NOT NULL AND definicja_kultury_kategoria IS NOT NULL GROUP BY status_odwiedzin_galerii;",
                "result": "status_odwiedzin_galerii|procent_definiujacych_jako_sztuka\nOdwiedza galerie rocznie|12.14\nNie odwiedza galerii rocznie|9.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bada, czy aktywne uczestnictwo w wystawach sztuki wiąże się z definiowaniem kultury przez pryzmat sztuki i artyzmu."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "80",
            "inputs": "Czy mieszkańcy Zabrza częściej niż mieszkańcy Gliwic chodzą na koncerty?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty FROM participation_survey WHERE miasto_powiat IN ('Zabrze', 'Gliwice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_koncerty\nGliwice|56.24\nZabrze|42.86"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Focuses on 'przynajmniej raz w ciągu ostatnich 12 miesięcy' to define active concert attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "81",
            "inputs": "Czy na Śląsku młodzi ludzie są bardziej zainteresowani kulturą lokalną niż w Zagłębiu?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm IN ('BYTOMSKI', 'GLIWICKI', 'KATOWICKI', 'TYSKI', 'KATOWICE') THEN 'Śląsk' WHEN subregion_metropolii_gzm = 'SOSNOWIECKI' THEN 'Zagłębie' END AS region, ROUND(SUM(CASE WHEN (uczestnictwo_miejsce_zamieszkania = TRUE OR opinia_kultura_przynaleznosc IN ('5', '6', '7 w pełni sie zgadzam')) THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_mlodych_zainteresowanych FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30' AND subregion_metropolii_gzm IN ('BYTOMSKI', 'GLIWICKI', 'KATOWICKI', 'TYSKI', 'KATOWICE', 'SOSNOWIECKI') GROUP BY region;",
                "result": "region|procent_mlodych_zainteresowanych\nZagłębie|81.38\nŚląsk|83.58"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'interest in local culture' for young people (<30) through participation in place of residence OR high agreement (5-7) with cultural belonging statements. Distinguishes between Silesian and Zagłębie regions based on explicit city/county categorization (includes relevant counties). Calculates the percentage within the young group for each region."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "82",
            "inputs": "Czy osoby z wyższym wykształceniem w Bytomiu częściej korzystają z oferty kulturalnej poza swoim miastem niż mieszkańcy Bytomia z wykształceniem średnim?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE OR uczestnictwo_poza_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_poza_miastem FROM participation_survey WHERE miasto_powiat = 'Bytom' AND wyksztalcenie IN ('wyższe', 'średnie') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_korzystajacych_poza_miastem\nśrednie|48.06\nwyższe|67.02"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines 'outside city participation' as either elsewhere in GZM or completely outside GZM. Focuses on two educational groups for clarity."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "83",
            "inputs": "Jakie wydarzenia kulturalne najchętniej odwiedzają mieszkańcy dzielnic o charakterze poprzemysłowym w Katowicach (w tym Murcki) w porównaniu do pozostałych dzielnic?",
            "expected_output": {
                "sql_query": "WITH KatowiceDzielnice AS ( SELECT id_uczestnika, waga_proby, dzielnica_katowic, ostatnio_teatr, ostatnio_koncert, ostatnio_muzeum, ostatnio_piknik, ostatnio_kino, CASE WHEN dzielnica_katowic IN ('Szopienice-Burowiec', 'Wełnowiec-Józefowiec', 'Załęże', 'Dąb', 'Janów - Nikiszowiec', 'Dąbrówka Mała', 'Bogucice', 'Zawodzie', 'Załęska Hałda - Brynów Część Zachodnia', 'Murcki') THEN 'Poprzemysłowe' WHEN dzielnica_katowic IN ('Osiedle Tysiąclecia', 'Osiedle Witosa', 'Kostuchna', 'Ligota-Panewniki', 'Piotrowice - Ochojec', 'Podlesie', 'Giszowiec', 'Koszutka', 'śródmieście', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Os. Paderewskiego - Muchowiec', 'Zarzecze') THEN 'Pozostałe' ELSE NULL END AS typ_dzielnicy FROM participation_survey WHERE dzielnica_katowic IS NOT NULL ) SELECT typ_dzielnicy, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzea, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS pikniki, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino FROM KatowiceDzielnice WHERE typ_dzielnicy IN ('Poprzemysłowe', 'Pozostałe') GROUP BY typ_dzielnicy;",
                "result": "typ_dzielnicy|teatr|koncerty|muzea|pikniki|kino\nPoprzemysłowe|6.15|11.04|6.01|45.1|56.68\nPozostałe|14.55|17.75|12.78|55.9|66.43"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Classifies all specified Katowice districts into 'Poprzemysłowe' (now including Murcki due to mining history) vs. 'Pozostałe' categories. Analyzes percentage attendance for five types of cultural activities (theatre, concert, museum, picnic, cinema) in the last 6 months for each district type."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "84",
            "inputs": "Czy mieszkańcy dużych miast konurbacji górnośląskiej mają bardziej krytyczne zdanie o dostępności oferty kulturalnej niż mieszkańcy mniejszych miast?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wielkosc_miejscowosci = 'miasto powyżej 200 tys. mieszkańców' THEN 'Duże miasta (>200 tys.)' ELSE 'Mniejsze miasta i wsie' END AS wielkosc_miasta, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('1 całkowicie niewystarczający', '2', '3') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_krytycznych FROM participation_survey GROUP BY wielkosc_miasta;",
                "result": "wielkosc_miasta|procent_krytycznych\nDuże miasta (>200 tys.)|11.55\nMniejsze miasta i wsie|20.42"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines 'critical opinion' as ratings 1-3 on a 7-point scale. Divides population into those from large cities vs. others."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "85",
            "inputs": "Czy wizyty w teatrze są popularniejsze wśród osób z wyższym wykształceniem mieszkających w Gliwicach czy w Katowicach?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr FROM participation_survey WHERE wyksztalcenie = 'wyższe' AND miasto_powiat IN ('Gliwice', 'Katowice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_teatr\nKatowice|32.64\nGliwice|28.12"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Focuses on 'przynajmniej raz w ciągu ostatnich 12 miesięcy' to define active theater attendance among higher education respondents only."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "86",
            "inputs": "Czy mieszkańcy GZM po 60 roku życia częściej sięgają po tradycyjne media (radio, prasa drukowana) niż cyfrowe formy kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kultura_domowa_radio = TRUE OR kultura_domowa_prasa = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_media_tradycyjne, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_media_cyfrowe FROM participation_survey WHERE grupa_wiekowa = '60 i więcej';",
                "result": "procent_media_tradycyjne|procent_media_cyfrowe\n24.31|31.92"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Groups multiple forms of both traditional and digital media consumption, comparing overall engagement rates."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "87",
            "inputs": "Czy mieszkańcy Sosnowca inaczej definiują kulturę niż mieszkańcy Bytomia?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, definicja_kultury_kategoria, ROUND(SUM(waga_proby) * 100.0 / SUM(SUM(waga_proby)) OVER (PARTITION BY miasto_powiat), 2) AS procent_w_miescie FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Bytom') AND definicja_kultury_kategoria IS NOT NULL AND definicja_kultury_kategoria NOT IN ('Nie wiem, trudno powiedzieć') GROUP BY miasto_powiat, definicja_kultury_kategoria ORDER BY miasto_powiat, procent_w_miescie DESC;",
                "result": "miasto_powiat|definicja_kultury_kategoria|procent_w_miescie\nBytom|Wszystkim/całość/wiele znaczeń|19.67\nBytom|Kultura osobista/zachowanie ludzi/zachowanie w stosunku do innych ludzi/tolerancja|16.8\nBytom|Sztuka/artyzm/wyrażanie siebie|15.54\nBytom|Dziedzictwo/historia/narodowość/regionalność/tożsamość|6.42\nBytom|Muzyka|5.13\nBytom|Aktywność/udział w kulturze/spotkania/wolny czas|5.07\nBytom|Wydarzenia/występy/wystawy/koncerty|4.44\nBytom|Inne|4.05\nBytom|Rozrywka/relaksem|3.18\nBytom|Sposób bycia|3.02\nBytom|Obyczaje/tradycja/zwyczaje|2.96\nBytom|Społeczność/cechy społeczne/otoczenie/więzi|2.33\nBytom|Czymś wpływającym/pozytywnym/potrzebnym/ubogacającym|1.72\nBytom|Duchowość/religia/wartości niematerialne|1.7\nBytom|Dobra materialne|1.67\nBytom|Zasady/wartości/moralność|1.26\nBytom|Poznawanie/zwiedzanie/edukacja/wiedza|1.26\nBytom|Literatura|1.05\nBytom|Kino/film/TV|0.85\nBytom|Teatr/opera/muzeum|0.63\nBytom|Język|0.63\nBytom|Ubiór/wygląd|0.42\nBytom|Obrazy/rzeźby|0.2\nSosnowiec|Kultura osobista/zachowanie ludzi/zachowanie w stosunku do innych ludzi/tolerancja|31.27\nSosnowiec|Wszystkim/całość/wiele znaczeń|14.21\nSosnowiec|Sztuka/artyzm/wyrażanie siebie|11.45\nSosnowiec|Kino/film/TV|6.6\nSosnowiec|Dziedzictwo/historia/narodowość/regionalność/tożsamość|6.0\nSosnowiec|Wydarzenia/występy/wystawy/koncerty|4.02\nSosnowiec|Teatr/opera/muzeum|3.56\nSosnowiec|Czymś wpływającym/pozytywnym/potrzebnym/ubogacającym|3.48\nSosnowiec|Aktywność/udział w kulturze/spotkania/wolny czas|2.77\nSosnowiec|Inne|2.49\nSosnowiec|Poznawanie/zwiedzanie/edukacja/wiedza|2.11\nSosnowiec|Duchowość/religia/wartości niematerialne|1.89\nSosnowiec|Obyczaje/tradycja/zwyczaje|1.62\nSosnowiec|Rozrywka/relaksem|1.62\nSosnowiec|Zasady/wartości/moralność|1.62\nSosnowiec|Dobra materialne|1.56\nSosnowiec|Sposób bycia|1.18\nSosnowiec|Społeczność/cechy społeczne/otoczenie/więzi|0.93\nSosnowiec|Muzyka|0.71\nSosnowiec|Literatura|0.68\nSosnowiec|Ubiór/wygląd|0.25"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Shows most common culture definitions in each city, excluding non-responses. Limited to top 3 per city for clarity."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "88",
            "inputs": "Czy młodzi mieszkańcy (poniżej 30 lat) podregionu tyskiego chętniej uczestniczą w piknikach i festynach niż ich rówieśnicy z innych części GZM?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Podregion tyski' ELSE 'Pozostałe podregiony' END AS podregion, ROUND(SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' AND (ostatnio_piknik = TRUE OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN grupa_wiekowa = 'Mniej niż 30' THEN waga_proby ELSE 0 END), 2) AS procent_mlodych_uczestniczacych FROM participation_survey GROUP BY podregion;",
                "result": "podregion|procent_mlodych_uczestniczacych\nPozostałe podregiony|66.64\nPodregion tyski|63.87"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines participation through either recent picnic attendance or festival frequency in the last 12 months, focusing only on under-30 population."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "89",
            "inputs": "Czy tradycyjne śląskie wydarzenia kulturalne są bardziej popularne wśród osób z niższym czy wyższym wykształceniem?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wyksztalcenie = 'niższe niż średnie' THEN 'Niższe wykształcenie' WHEN wyksztalcenie IN ('średnie', 'wyższe') THEN 'Wyższe wykształcenie' END AS poziom_wyksztalcenia, ROUND(SUM(CASE WHEN (skojarzenia_wydarzenia_gzm_1_kategoria = 'festyny/jarmarki/pikniki' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%barbórk%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%górni%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%śląsk%' OR skojarzenia_wydarzenia_gzm_1_tekst LIKE '%trady%') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycyjne_slaskie FROM participation_survey WHERE wyksztalcenie IS NOT NULL GROUP BY poziom_wyksztalcenia;",
                "result": "poziom_wyksztalcenia|procent_tradycyjne_slaskie\nWyższe wykształcenie|4.03\nNiższe wykształcenie|5.21"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identifies traditional Silesian events through keywords (barbórka, górniczy, śląski, tradycyjny) and festival categories. Groups education levels into lower (primary, middle, vocational) and higher (secondary, tertiary)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "90",
            "inputs": "Czy mieszkańcy Katowic z dzielnic centralnych i bliskich centrum mają wyższe średnie miesięczne wydatki na kulturę niż mieszkańcy dzielnic bardziej oddalonych (peryferyjnych)?",
            "expected_output": {
                "sql_query": "WITH DzielniceKatowic AS ( SELECT dzielnica_katowic, wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Koszutka', 'Os. Paderewskiego - Muchowiec', 'Bogucice', 'Załęże', 'Dąb', 'Wełnowiec-Józefowiec', 'Zawodzie', 'Brynów Część Wschodnia - Os. Zgrzebnioka') THEN 'Dzielnice centralne/bliskie centrum' WHEN dzielnica_katowic IN ('Zarzecze', 'Podlesie', 'Kostuchna', 'Murcki', 'Giszowiec', 'Dąbrówka Mała', 'Janów - Nikiszowiec', 'Ligota-Panewniki', 'Osiedle Tysiąclecia', 'Osiedle Witosa', 'Piotrowice - Ochojec', 'Szopienice-Burowiec', 'Załęska Hałda - Brynów Część Zachodnia') THEN 'Dzielnice peryferyjne/oddalone' ELSE NULL END AS typ_dzielnicy FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT typ_dzielnicy, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM DzielniceKatowic WHERE typ_dzielnicy IS NOT NULL GROUP BY typ_dzielnicy;",
                "result": "typ_dzielnicy|srednie_miesieczne_wydatki\nDzielnice centralne/bliskie centrum|112.6\nDzielnice peryferyjne/oddalone|118.62"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses a CTE to classify all Katowice districts as 'centralne/bliskie centrum' vs. 'peryferyjne/oddalone' based on general geographic location. Compares weighted average monthly cultural expenditure between these two groups, excluding respondents with missing expenditure data or district information."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "91",
            "inputs": "Czy mieszkańcy katowickich osiedli modernistycznych (np. Tysiąclecia, Paderewskiego, Witosa) mają inne preferencje dotyczące uczestnictwa w wydarzeniach kulturalnych (w ostatnich 6 msc) niż mieszkańcy starszych, robotniczych dzielnic Katowic (np. Nikiszowiec, Załęże)?",
            "expected_output": {
                "sql_query": "WITH KatowiceDistrictTypes AS ( SELECT dzielnica_katowic, ostatnio_teatr, ostatnio_koncert, ostatnio_kino, ostatnio_dom_kultury, ostatnio_zoo, ostatnio_spotkanie_z_artysta, waga_proby, CASE WHEN dzielnica_katowic IN ('Osiedle Tysiąclecia', 'Os. Paderewskiego - Muchowiec', 'Osiedle Witosa') THEN 'Osiedla modernistyczne (Kato)' WHEN dzielnica_katowic IN ('śródmieście', 'Załęże', 'Janów - Nikiszowiec', 'Giszowiec', 'Szopienice-Burowiec', 'Bogucice', 'Dąb', 'Wełnowiec-Józefowiec', 'Zawodzie') THEN 'Stare dzielnice (Kato)' ELSE 'Inne/Nieklasyfikowane (Kato)' END AS typ_zabudowy FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT typ_zabudowy, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr_proc, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty_proc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino_proc, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS dom_kultury_proc, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS zoo_proc, ROUND(SUM(CASE WHEN ostatnio_spotkanie_z_artysta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS spotkania_artysta_proc FROM KatowiceDistrictTypes WHERE typ_zabudowy IN ('Osiedla modernistyczne (Kato)', 'Stare dzielnice (Kato)') GROUP BY typ_zabudowy;",
                "result": "typ_zabudowy|teatr_proc|koncerty_proc|kino_proc|dom_kultury_proc|zoo_proc|spotkania_artysta_proc\nOsiedla modernistyczne (Kato)|17.2|15.54|66.46|9.31|30.68|2.98\nStare dzielnice (Kato)|8.4|15.19|58.51|9.29|35.47|3.02"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses a CTE to classify Katowice districts only into 'Osiedla modernistyczne (Kato)' (e.g., Tysiąclecia, Paderewskiego, Witosa, Koszutka) vs. 'Stare dzielnice (Kato)' (e.g., Śródmieście, Nikiszowiec, Załęże) based on urban development history. Excludes other cities and districts not fitting these categories. Compares percentage attendance for six different cultural activities in the last 6 months."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "92",
            "inputs": "Jak różnią się wydatki na kulturę między Dąbrową Górniczą a Sosnowcem?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki, ROUND(STDDEV(wydatki_na_kulture_kwota), 2) AS odchylenie_standardowe FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Dąbrowa Górnicza') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|srednie_wydatki|odchylenie_standardowe\nDąbrowa Górnicza|112.46|90.89\nSosnowiec|113.83|102.85"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates both average spending and standard deviation to show not just differences in amount but also in spending variability."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "93",
            "inputs": "Czy mieszkańcy Katowic częściej wybierają kulturę wysoką (opera, filharmonia, galerie) niż mieszkańcy miast satelickich jak Mikołów czy Mysłowice?",
            "expected_output": {
                "sql_query": "WITH KatowiceTotal AS ( SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' ), SatelliteTotal AS ( SELECT SUM(waga_proby) AS total FROM participation_survey WHERE (miasto_powiat = 'Mysłowice') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Mikołów') ), HighCultureCondition AS ( SELECT id_uczestnika, waga_proby, ( czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR ostatnio_filharmonia = TRUE ) AS is_high_culture_participant FROM participation_survey ) SELECT 'Katowice (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN hcc.is_high_culture_participant THEN ps.waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM KatowiceTotal), 2) AS procent_kultura_wysoka FROM participation_survey ps JOIN HighCultureCondition hcc ON ps.id_uczestnika = hcc.id_uczestnika WHERE ps.miasto_powiat = 'Katowice' GROUP BY lokalizacja UNION ALL SELECT 'Mysłowice / Mikołów (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN hcc.is_high_culture_participant THEN ps.waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SatelliteTotal), 2) AS procent_kultura_wysoka FROM participation_survey ps JOIN HighCultureCondition hcc ON ps.id_uczestnika = hcc.id_uczestnika WHERE (ps.miasto_powiat = 'Mysłowice') OR (ps.miasto_powiat = 'Powiat mikołowski' AND ps.gmina_miejscowosc = 'Mikołów') GROUP BY lokalizacja;",
                "result": "typ_miasta|procent_kultura_wysoka\nMiasta satelickie|37.02\nKatowice|34.38"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines 'high culture' as philharmonic, art gallery attendance or recent opera visits. Groups smaller towns (Mikołów, Mysłowice as satellite cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "94",
            "inputs": "Czy rodziny z dziećmi mieszkające na peryferiach GZM częściej napotykają bariery w dostępie do kultury związane z dojazdem niż rodziny z centrum?",
            "expected_output": {
                "sql_query": "WITH LocationCategories AS (SELECT id_uczestnika, waga_proby, bariera_dojazd, CASE WHEN miasto_powiat IN ('Katowice', 'Bytom', 'Chorzów', 'Siemianowice Śląskie', 'Świętochłowice', 'Ruda Śląska', 'Zabrze', 'Gliwice', 'Sosnowiec') THEN 'Centrum GZM' ELSE 'Peryferia GZM' END AS lokalizacja FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE) SELECT lokalizacja, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazdu FROM LocationCategories GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_dojazdu\nPeryferia GZM|10.3\nCentrum GZM|15.84"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'center' as 9 core cities of the conurbation, with remaining areas as periphery. Focuses only on families with children."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "95",
            "inputs": "Czy seniorzy z Katowic mają inne preferencje dotyczące aktywności kulturalnych niż seniorzy z Gliwic?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzeum, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncert, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS piknik FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') AND grupa_wiekowa = '60 i więcej' GROUP BY miasto_powiat;",
                "result": "miasto_powiat|teatr|kino|muzeum|koncert|piknik\nGliwice|11.4|28.25|3.84|12.89|40.15\nKatowice|10.19|40.33|8.27|13.52|50.88"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares five types of cultural activities among elderly populations in two major cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "96",
            "inputs": "Czy kobiety w Zagłębiu częściej uczestniczą w wydarzeniach kulturalnych niż mężczyźni?",
            "expected_output": {
                "sql_query": "SELECT plec, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE OR ostatnio_koncert = TRUE OR ostatnio_muzeum = TRUE OR ostatnio_kino = TRUE OR ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestnictwa FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' AND plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;",
                "result": "plec|procent_uczestnictwa\nKobieta|68.02\nMężczyzna|59.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines Zagłębie using subregion_metropolii_gzm = 'SOSNOWIECKI'. Measures participation through recent attendance at any of five cultural event types."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "97",
            "inputs": "Czy różne grupy wiekowe inaczej postrzegają to, czy nakłady na kulturę powinny być wyższe czy niższe?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('1 zupełnie się nie zgadzam', '2', '3') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_za_wiekszymi_wydatkami, ROUND(SUM(CASE WHEN opinia_wydatki_publiczne_na_kulture IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_za_mniejszymi_wydatkami FROM participation_survey WHERE opinia_wydatki_publiczne_na_kulture IS NOT NULL GROUP BY grupa_wiekowa ORDER BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_za_wiekszymi_wydatkami|procent_za_mniejszymi_wydatkami\n30-39|36.05|31.01\n40-49|31.47|36.26\n50-59|34.8|32.21\n60 i więcej|34.34|36.02\nMniej niż 30|31.82|35.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Interprets disagreement with 'spending should be lower' (ratings 1-3) as support for higher spending, and agreement (5-7) as support for lower spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "98",
            "inputs": "Czy mieszkańcy Tychów częściej korzystają z instytucji kulturalnych w innych miastach GZM niż mieszkańcy Gliwic?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_korzystajacych_poza_miastem FROM participation_survey WHERE miasto_powiat IN ('Tychy', 'Gliwice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_korzystajacych_poza_miastem\nTychy|28.84\nGliwice|13.74"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Considers participation in cultural events outside one's city but within GZM as the key metric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "99",
            "inputs": "Czy osoby z niepełnosprawnością w Katowicach mają lepszy dostęp do kultury niż osoby z niepełnosprawnością w mniejszych miastach GZM?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Mniejsze miasta GZM' END AS wielkosc_miasta, ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dostep, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm IN ('5', '6', '7 w pełni wystarczający') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dobry_dostep FROM participation_survey WHERE (niepelnosprawnosc_ruch = TRUE OR niepelnosprawnosc_wzrok = TRUE OR niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_inna = TRUE) GROUP BY wielkosc_miasta;",
                "result": "wielkosc_miasta|procent_bariera_dostep|procent_dobry_dostep\nMniejsze miasta GZM|11.77|52.77\nKatowice|11.8|56.93"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Considers four types of disabilities. Evaluates access through both physical barrier reporting and overall access perception."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "100",
            "inputs": "Czy w subregionie bytomskim więcej osób uważa tradycję za element kultury niż w subregionie sosnowieckim?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycja FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_tradycja\nSOSNOWIECKI|91.19\nBYTOMSKI|93.97"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison of responses to the question about whether tradition is considered part of culture."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "101",
            "inputs": "Czy osoby dojeżdżające do pracy komunikacją miejską częściej korzystają z oferty kulturalnej w różnych miastach metropolii niż osoby korzystające z własnego samochodu?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN transport_komunikacja_miejska = TRUE AND transport_wlasny_samochod = FALSE THEN 'Komunikacja miejska' WHEN transport_wlasny_samochod = TRUE AND transport_komunikacja_miejska = FALSE THEN 'Własny samochód' ELSE 'Transport mieszany/inny' END AS srodek_transportu, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_rozne_miasta FROM participation_survey WHERE zatrudnienie_pracujacy = TRUE GROUP BY srodek_transportu HAVING srodek_transportu IN ('Komunikacja miejska', 'Własny samochód');",
                "result": "srodek_transportu|procent_kultura_rozne_miasta\nWłasny samochód|34.88\nKomunikacja miejska|18.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Isolates primary transport mode groups (public transport only vs. car only) and focuses only on employed individuals."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "102",
            "inputs": "Czy mieszkańcy Śląska i Zagłębia różnią się w opinii na temat tego, czy moda jest częścią kultury?",
            "expected_output": {
                "sql_query": "WITH SlaskZaglebie AS (SELECT id_uczestnika, waga_proby, kultura_moda, CASE WHEN subregion_metropolii_gzm IN ('BYTOMSKI', 'GLIWICKI', 'KATOWICKI', 'TYSKI', 'KATOWICE') THEN 'Śląsk' WHEN subregion_metropolii_gzm = 'SOSNOWIECKI' THEN 'Zagłębie' ELSE 'Inne' END AS region FROM participation_survey WHERE subregion_metropolii_gzm IS NOT NULL) SELECT region, ROUND(SUM(CASE WHEN kultura_moda = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moda_jako_kultura FROM SlaskZaglebie WHERE region IN ('Śląsk', 'Zagłębie') GROUP BY region;",
                "result": "region|procent_moda_jako_kultura\nZagłębie|69.3\nŚląsk|69.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Divides the metropolitan area into its historical regions (Silesia vs. Zagłębie) based on subregion_metropolii_gzm to examine potential cultural perception differences."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "103",
            "inputs": "Czy istnieje różnica między mieszkańcami Katowic i Gliwic w tym, jak postrzegają wpływ kultury na relacje międzyludzkie?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pozytywne_relacje FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_pozytywne_relacje\nGliwice|68.02\nKatowice|61.5"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines positive perception as agreement levels 5-7 with the statement about culture's impact on relationships."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "104",
            "inputs": "Czy w Katowicach mężczyźni i kobiety w podobnym stopniu angażują się w twórczość artystyczną?",
            "expected_output": {
                "sql_query": "SELECT plec, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE miasto_powiat = 'Katowice' AND plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;",
                "result": "plec|procent_tworczosc\nKobieta|24.42\nMężczyzna|18.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines creative engagement through participation in any of eight creative activities, from music to visual arts to writing."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "105",
            "inputs": "Czy mieszkańcy Nikiszowca bardziej cenią dziedzictwo kulturowe niż mieszkańcy innych katowickich dzielnic?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN dzielnica_katowic = 'Janów - Nikiszowiec' THEN 'Nikiszowiec' ELSE 'Inne dzielnice Katowic' END AS grupa_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') OR definicja_kultury_kategoria = 'Dziedzictwo/historia/narodowość/regionalność/tożsamość' OR kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wartosc_dziedzictwa FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL GROUP BY grupa_dzielnic;",
                "result": "grupa_dzielnic|procent_wartosc_dziedzictwa\nNikiszowiec|96.62\nInne dzielnice Katowic|90.54"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares Nikiszowiec residents against all *other Katowice residents combined*. Defines cultural heritage appreciation through strong agreement (6-7) with cultural belonging statements, OR heritage-based definitions of culture, OR considering tradition as part of culture. Filters specifically for Katowice residents."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "106",
            "inputs": "Czy mieszkańcy Sosnowca częściej odwiedzają instytucje kultury w Katowicach niż mieszkańcy Bytomia?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN miejsce_kultury_katowice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzajacych_katowice FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Bytom') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_odwiedzajacych_katowice\nSosnowiec|44.98\nBytom|46.02"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison of visitation rates to Katowice cultural institutions from two different origin cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "107",
            "inputs": "Czy w Rudzie Śląskiej i Świętochłowicach istnieją różnice pokoleniowe w sposobach korzystania z kultury?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, CASE WHEN grupa_wiekowa IN ('Mniej niż 30', '30-39') THEN 'Młodsze pokolenia' WHEN grupa_wiekowa IN ('50-59', '60 i więcej') THEN 'Starsze pokolenia' ELSE 'Średnie pokolenie' END AS grupa_pokoleniowa, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino, ROUND(SUM(CASE WHEN kultura_domowa_internet = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS internet, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS piknik, ROUND(SUM(CASE WHEN kultura_domowa_ksiazki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS ksiazki FROM participation_survey WHERE miasto_powiat IN ('Ruda Śląska', 'Świętochłowice') AND grupa_wiekowa IS NOT NULL GROUP BY miasto_powiat, grupa_pokoleniowa HAVING grupa_pokoleniowa IN ('Młodsze pokolenia', 'Starsze pokolenia');",
                "result": "miasto_powiat|grupa_pokoleniowa|kino|internet|piknik|ksiazki\nRuda Śląska|Młodsze pokolenia|65.5|20.32|27.33|37.97\nRuda Śląska|Starsze pokolenia|31.51|21.81|31.65|31.39\nŚwiętochłowice|Młodsze pokolenia|48.31|19.07|38.71|31.71\nŚwiętochłowice|Starsze pokolenia|27.36|10.38|16.98|17.22"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Groups ages into younger (under 40) and older (50+) generations. Compares four different cultural activities (cinema, internet, outdoor events, books) to identify generational differences."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "108",
            "inputs": "Czy mieszkańcy miast na prawach powiatu częściej uczestniczą w kulturze niż mieszkańcy pozostałych obszarów GZM?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat IN ('Bytom', 'Chorzów', 'Dąbrowa Górnicza', 'Gliwice', 'Katowice', 'Mysłowice', 'Piekary Śląskie', 'Ruda Śląska', 'Siemianowice Śląskie', 'Sosnowiec', 'Świętochłowice', 'Tychy', 'Zabrze') THEN 'Miasta na prawach powiatu' ELSE 'Pozostałe obszary GZM' END AS typ_jednostki, ROUND(SUM(CASE WHEN (ostatnio_teatr = TRUE OR ostatnio_koncert = TRUE OR ostatnio_muzeum = TRUE OR ostatnio_kino = TRUE OR ostatnio_piknik = TRUE OR ostatnio_dom_kultury = TRUE) THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uczestnictwa FROM participation_survey GROUP BY typ_jednostki;",
                "result": "typ_jednostki|procent_uczestnictwa\nMiasta na prawach powiatu|73.81\nPozostałe obszary GZM|67.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Distinguishes between city-counties (miasta na prawach powiatu) and other administrative units. Defines participation through recent attendance at any of six cultural event types."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "109",
            "inputs": "Czy mieszkańcy Zabrza mają inne bariery uczestnictwa w kulturze niż mieszkańcy Sosnowca?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS ceny, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS dojazd, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS czas, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS oferta FROM participation_survey WHERE miasto_powiat IN ('Zabrze', 'Sosnowiec') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|ceny|dojazd|czas|oferta\nZabrze|46.52|12.32|35.0|25.13\nSosnowiec|65.54|9.62|43.9|9.99"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Focuses on four key barriers to cultural participation to identify city-specific challenges."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "110",
            "inputs": "Czy w dzielnicach Katowic o zabytkowej zabudowie (jak Nikiszowiec, Murcki czy Giszowiec) mieszkańcy częściej doceniają kulturę jako element tożsamości lokalnej?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN dzielnica_katowic IN ('Janów - Nikiszowiec', 'Giszowiec', 'Murcki') THEN 'Dzielnice zabytkowe' ELSE 'Pozostałe dzielnice' END AS typ_dzielnicy, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tozsamosc FROM participation_survey WHERE dzielnica_katowic IS NOT NULL GROUP BY typ_dzielnicy;",
                "result": "typ_dzielnicy|procent_tozsamosc\nDzielnice zabytkowe|50.34\nPozostałe dzielnice|32.73"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines historic districts as Nikiszowiec, Murcki, Giszowiec based on architectural heritage. Measures identity connection through strong agreement (6-7) with cultural belonging statements."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "111",
            "inputs": "Czy mieszkańcy Bytomia i Rudy Śląskiej różnią się pod względem wydatków na kulturę w porównaniu do średniej dla całej metropolii?",
            "expected_output": {
                "sql_query": "WITH MetroAvg AS (SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS avg_wydatki FROM participation_survey) SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki, (SELECT avg_wydatki FROM MetroAvg) AS srednia_metropolii, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby) - (SELECT avg_wydatki FROM MetroAvg), 2) AS roznica FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Ruda Śląska') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|srednie_wydatki|srednia_metropolii|roznica\nBytom|118.96|84.31|34.65\nRuda Śląska|80.6|84.31|-3.71"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses a subquery to calculate the metropolitan average once, then compares city-specific averages to this baseline."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "112",
            "inputs": "Czy wykształcenie ma większy wpływ na uczestnictwo w kulturze wysokiej w Katowicach czy w Gliwicach? (Porównaj różnicę w % uczestnictwa między osobami z wykształceniem wyższym a niższym niż średnie)",
            "expected_output": {
                "sql_query": "WITH CultureByEducation AS ( SELECT miasto_powiat, wyksztalcenie, SUM(CASE WHEN czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby) AS procent_kultura_wysoka FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY miasto_powiat, wyksztalcenie ) SELECT miasto_powiat, ROUND(MAX(CASE WHEN wyksztalcenie = 'wyższe' THEN procent_kultura_wysoka ELSE NULL END) - MAX(CASE WHEN wyksztalcenie = 'niższe niż średnie' THEN procent_kultura_wysoka ELSE NULL END), 2) AS roznica_wplywu_wyksztalcenia FROM CultureByEducation GROUP BY miasto_powiat;",
                "result": "miasto_powiat|roznica_wplywu_wyksztalcenia\nKatowice|38.82\nGliwice|29.07"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'high culture' as philharmonic, art gallery, OR theater attendance at least once/year. Measures education 'impact' by calculating the percentage point difference in participation rates between the 'wyższe' and 'niższe niż średnie' education levels within each city. Only includes these two specific education levels in the calculation."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "113",
            "inputs": "Czy osoby, które odwiedzają Spodek w celach kulturalnych, mają wyższe średnie wydatki na kulturę niż te, które odwiedzają inne obiekty?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' OR skojarzenia_miejsca_gzm_1_tekst LIKE '%spodek%' THEN 'Odwiedzający Spodek' ELSE 'Odwiedzający inne obiekty' END AS typ_obiektu, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY typ_obiektu;",
                "result": "typ_obiektu|srednie_wydatki\nOdwiedzający Spodek|109.89\nOdwiedzający inne obiekty|113.23"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Identifies Spodek visitors through both categorized mentions and text search in primary venue associations."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "114",
            "inputs": "Czy mieszkańcy Chorzowa częściej odwiedzają zoo i parki rozrywki niż mieszkańcy innych miast metropolii?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Chorzów' THEN 'Chorzów' ELSE 'Inne miasta' END AS miasto, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE OR czestotliwosc_zoo = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_parki FROM participation_survey GROUP BY miasto;",
                "result": "miasto|procent_zoo_parki\nInne miasta|46.52\nChorzów|77.18"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Includes both recent zoo visits and yearly zoo/amusement park frequency, relevant since Chorzów hosts the Silesian Zoo and amusement park."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "115",
            "inputs": "Czy mieszkańcy Bytomia częściej odwiedzają Operę Śląską lub kojarzą GZM z operą niż mieszkańcy innych miast Metropolii?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom' ELSE 'Inne miasta GZM' END AS grupa_miast, ROUND(SUM(CASE WHEN kategoria_odwiedzonej_filharmonii = 'Opera Śląska w Bytomiu' OR ostatnio_filharmonia = TRUE OR CAST(skojarzenia_miejsca_gzm_1_kategoria AS TEXT) = 'filharmonia/opera' OR CAST(skojarzenia_miejsca_gzm_2_kategoria AS TEXT) = 'filharmonia/opera' OR CAST(skojarzenia_miejsca_gzm_3_kategoria AS TEXT) = 'filharmonia/opera' OR CAST(skojarzenia_miejsca_gzm_4_kategoria AS TEXT) = 'filharmonia/opera' OR CAST(skojarzenia_miejsca_gzm_5_kategoria AS TEXT) = 'filharmonia/opera' OR LOWER(skojarzenia_miejsca_gzm_1_tekst) LIKE '%opera%' OR LOWER(skojarzenia_miejsca_gzm_2_tekst) LIKE '%opera%' OR LOWER(skojarzenia_miejsca_gzm_3_tekst) LIKE '%opera%' OR LOWER(skojarzenia_miejsca_gzm_4_tekst) LIKE '%opera%' OR LOWER(skojarzenia_miejsca_gzm_5_tekst) LIKE '%opera%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_opera_visit_assoc FROM participation_survey WHERE miasto_powiat IS NOT NULL GROUP BY grupa_miast;",
                "result": "grupa_miast|procent_opera_visit_assoc\nInne miasta GZM|4.81\nBytom|14.09"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'Opera visit/association' broadly: identifies specific visit to Opera Śląska, OR recent visit to any philharmonic/opera, OR association (category or text) of GZM places with 'filharmonia/opera'. Explicitly CASTs category columns to TEXT to avoid conversion errors. Compares Bytom vs. all other GZM cities defined by non-null `miasto_powiat`."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "116",
            "inputs": "Czy mieszkańcy GZM częściej uczestniczą w wydarzeniach muzycznych (koncerty/filharmonia) niż w życiu literackim (czytanie książek/wydarzenia literackie) przynajmniej raz w roku?",
            "expected_output": {
                "sql_query": "SELECT 'Muzyka (Uczestnictwo roczne)' AS element, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey UNION ALL SELECT 'Literatura (Uczestnictwo roczne)' AS element, ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_wydarzenia_literackie = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey;",
                "result": "element|procent\nMuzyka (Uczestnictwo roczne)|42.33\nLiteratura (Uczestnictwo roczne)|49.89"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation rates (at least once in last 12 months) for music (concerts OR philharmonic) vs. literature (reading books OR literary events). This compares 'apples to apples' (participation vs. participation) but shifts the focus from the original question about classifying elements as culture due to the missing 'kultura_literatura' column."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "117",
            "inputs": "Czy mieszkańcy Tarnowskich Gór częściej chodzą na koncery niż mieszkańcy innych miejscowości w powiecie tarnogórskim?",
            "expected_output": {
                "sql_query": "WITH PTTG AS (SELECT id_uczestnika, gmina_miejscowosc, czestotliwosc_koncert, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc IS NOT NULL) SELECT CASE WHEN gmina_miejscowosc = 'Tarnowskie Góry' THEN 'Tarnowskie Góry' ELSE 'Inne gminy w powiecie TG' END AS miejsce, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM PTTG GROUP BY miejsce;",
                "result": "miejsce|procent_koncerty_rocznie\nTarnowskie Góry|25.88\nInne gminy w powiecie TG|40.92"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses `gmina_miejscowosc` to differentiate within `miasto_powiat` = 'Powiat tarnogórski'. Compares annual concert attendance (at least once)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "118",
            "inputs": "Jaki jest średni miesięczny wydatek na kulturę wśród studentów w Katowicach w porównaniu do studentów w Gliwicach?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS sredni_wydatek_studenci FROM participation_survey WHERE zatrudnienie_student = TRUE AND miasto_powiat IN ('Katowice', 'Gliwice') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|sredni_wydatek_studenci\nKatowice|105.62\nGliwice|50.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for students in two specific cities and calculates weighted average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "119",
            "inputs": "Czy osoby w wieku 40-49 lat w subregionie katowickim częściej jako barierę wskazują brak czasu niż osoby w tym samym wieku w subregionie bytomskim?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'BYTOMSKI' THEN 'Bytomski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey WHERE grupa_wiekowa = '40-49' AND subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI', 'BYTOMSKI') GROUP BY subregion_grupa;",
                "result": "subregion_grupa|procent_bariera_czas\nKatowicki (łącznie z Katowicami)|42.86\nBytomski|38.61"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Updated to combine subregion_metropolii_gzm 'KATOWICE' and 'KATOWICKI' into a single group 'Katowicki (łącznie z Katowicami)' for comparison with 'BYTOMSKI', as per user instruction for 'katowickim'. Original expected_result is kept but will change (structure and values) based on the updated query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "120",
            "inputs": "Wśród osób z najniższymi dochodami (do 3500 zł), jaki procent uważa, że działalność kulturalna podnosi atrakcyjność regionu (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł';",
                "result": "procent_zgody_atrakcyjnosc\n63.69"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific income group and calculates the percentage agreement with a statement."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "121",
            "inputs": "Czy osoby, które śledzą profile twórców na Instagramie, częściej odwiedzają galerie sztuki (przynajmniej raz na rok) niż osoby, które tego nie robią?",
            "expected_output": {
                "sql_query": "SELECT instagram_profile_tworcow, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galerie_rocznie FROM participation_survey WHERE instagram_profile_tworcow IS NOT NULL GROUP BY instagram_profile_tworcow;",
                "result": "instagram_profile_tworcow|procent_galerie_rocznie\nFalse|27.65\nTrue|29.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links specific online behavior (following creators on IG) with offline cultural participation (gallery visits)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "122",
            "inputs": "Jaka jest średnia ocena (1-7) istotności kultury wśród mieszkańców powiatu bieruńsko-lędzińskiego?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;",
                "result": "srednia_istotnosc\n4.99"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average importance rating for a specific county (`miasto_powiat`). Converts text scale to numeric for calculation."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "123",
            "inputs": "Czy osoby, które uważają, że dzięki kulturze można nawiązywać relacje (ocena 6-7), częściej odwiedzają domy kultury (przynajmniej raz na rok)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Relacje)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_relacje, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE opinia_kultura_relacje_miedzyludzkie IS NOT NULL AND czestotliwosc_dom_kultury IS NOT NULL GROUP BY opinia_relacje;",
                "result": "opinia_relacje|procent_dom_kultury_rocznie\nZgadza się (Relacje)|36.98\nNie zgadza się / Mniej (1-5)|16.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks if belief in culture's social function correlates with participation in community centers."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "124",
            "inputs": "Jaki procent mieszkańców gminy Psary odwiedził kino w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary';",
                "result": "procent_kino_6msc\n43.47"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific municipality (`gmina_miejscowosc`) within a specific county (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "125",
            "inputs": "W zespole dzielnic zachodnich Katowic, które źródło informacji o kulturze jest najpopularniejsze: plakaty czy znajomi/rodzina?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneW AS ( SELECT informacja_plakaty, informacja_znajomi_rodzina, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') ) SELECT 'Plakaty/Ogłoszenia' AS zrodlo, ROUND(SUM(CASE WHEN informacja_plakaty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneW UNION ALL SELECT 'Znajomi/Rodzina' AS zrodlo, ROUND(SUM(CASE WHEN informacja_znajomi_rodzina = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneW;",
                "result": "zrodlo|procent\nPlakaty/Ogłoszenia|35.51\nZnajomi/Rodzina|42.02"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the western zone. Compares the percentage use of two specific information sources."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "126",
            "inputs": "Czy osoby pracujące w sektorze kultury w Mysłowicach częściej uważają, że ich praca jest częścią kultury, niż osoby z sektora kultury w Siemianowicach Śląskich?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN praca_w_sektorze_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_praca_w_kulturze FROM participation_survey WHERE miasto_powiat IN ('Mysłowice', 'Siemianowice Śląskie') AND praca_w_sektorze_kultury IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_praca_w_kulturze\nSiemianowice Śląskie|2.4\nMysłowice|0.89"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares the percentage of respondents identifying as cultural sector workers in two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "127",
            "inputs": "Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród osób, które jako główną barierę wskazują problemy z dojazdem?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE bariera_dojazd = TRUE AND ocena_dostepu_do_kultury_gzm IS NOT NULL;",
                "result": "srednia_ocena_dostepu\n4.76"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific barrier and calculates the average access rating for that group. Converts text scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "128",
            "inputs": "Czy w powiecie mikołowskim osoby częściej odwiedzają kina czy teatry (przynajmniej raz na rok)?",
            "expected_output": {
                "sql_query": "SELECT 'Kino (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' UNION ALL SELECT 'Teatr (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski';",
                "result": "aktywnosc|procent\nKino (rocznie)|56.57\nTeatr (rocznie)|29.98"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation (at least once) in two different activities within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "129",
            "inputs": "Jakie formy cyfrowej kultury są najpopularniejsze wśród osób poniżej 30 lat w subregionie gliwickim?",
            "expected_output": {
                "sql_query": "WITH SubregionData AS (SELECT waga_proby, cyfrowa_kultura_wydarzenia_online, cyfrowa_kultura_wystawy_interaktywne, cyfrowa_kultura_nowe_media, cyfrowa_kultura_podcasty, cyfrowa_kultura_social_media, cyfrowa_kultura_gry, cyfrowa_kultura_vr FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND grupa_wiekowa = 'Mniej niż 30') SELECT 'Social Media (YT/TikTok)' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_social_media = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Gry komputerowe' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_gry = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Podcasty' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_podcasty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Wydarzenia Online' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'VR/Immersja' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Sztuka Nowych Mediów' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_nowe_media = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData UNION ALL SELECT 'Interaktywne Wystawy Online' AS forma, ROUND(SUM(CASE WHEN cyfrowa_kultura_wystawy_interaktywne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SubregionData ORDER BY procent DESC LIMIT 3;",
                "result": "forma|procent\nSocial Media (YT/TikTok)|52.18\nGry komputerowe|29.6\nPodcasty|17.18"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Filters for specific age group and subregion. Uses UNION ALL to calculate percentages for multiple digital culture forms and selects the top 3."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "130",
            "inputs": "Czy osoby, które odwiedzają miejsca kultury w różnych miastach GZM (poza swoim), częściej zgadzają się, że kultura podnosi atrakcyjność regionu (ocena 6-7)?",
            "expected_output": {
                "sql_query": "SELECT uczestnictwo_inne_miejsce_gzm, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc FROM participation_survey WHERE uczestnictwo_inne_miejsce_gzm IS NOT NULL GROUP BY uczestnictwo_inne_miejsce_gzm;",
                "result": "uczestnictwo_inne_miejsce_gzm|procent_zgody_atrakcyjnosc\nFalse|29.33\nTrue|42.54"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links mobility within GZM for cultural purposes with opinions on culture's regional impact (agreement 6-7)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "131",
            "inputs": "Porównaj średnią ocenę istotności kultury (1-7) między mieszkańcami zespołu dzielnic północnych i południowych Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT istotnosc_uczestnictwa_w_kulturze, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|srednia_istotnosc\nZespół dzielnic południowych|4.96\nZespół dzielnic północnych|4.98"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares weighted average importance rating (1-7 scale converted to numeric) between the northern and southern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "132",
            "inputs": "Jaki procent osób z wyższym wykształceniem w Zabrzu uważa, że moda to część kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kultura_moda = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moda_kultura FROM participation_survey WHERE miasto_powiat = 'Zabrze' AND wyksztalcenie = 'wyższe';",
                "result": "procent_moda_kultura\n60.09"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific city and education level to check perception of fashion as culture."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "133",
            "inputs": "Czy osoby, które odwiedziły zoo w ciągu ostatnich 6 miesięcy, częściej wskazują rodzinę jako powód spędzania wolnego czasu (odp 'zdecydowanie tak')?",
            "expected_output": {
                "sql_query": "SELECT ostatnio_zoo, ROUND(SUM(CASE WHEN wolny_czas_definicja_rodzina = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rodzina_priorytet FROM participation_survey WHERE ostatnio_zoo IS NOT NULL GROUP BY ostatnio_zoo;",
                "result": "ostatnio_zoo|procent_rodzina_priorytet\nFalse|39.96\nTrue|53.05"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links recent participation in a typically family-oriented activity (zoo) with stated priorities for leisure time."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "134",
            "inputs": "W powiecie pszczyńskim, które źródło informacji o kulturze jest najmniej popularne: radio czy telewizja?",
            "expected_output": {
                "sql_query": "SELECT 'Radio' AS zrodlo, ROUND(SUM(CASE WHEN informacja_radio = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' UNION ALL SELECT 'Telewizja' AS zrodlo, ROUND(SUM(CASE WHEN informacja_telewizja = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' ORDER BY procent ASC LIMIT 1;",
                "result": "zrodlo|procent\nRadio|8.68"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares usage percentage of two specific traditional media sources within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "135",
            "inputs": "Czy mieszkańcy Piekar Śląskich częściej uczestniczą w piknikach/festynach niż mieszkańcy Świętochłowic (w ostatnich 6 msc)?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_6msc FROM participation_survey WHERE miasto_powiat IN ('Piekary Śląskie', 'Świętochłowice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_pikniki_6msc\nPiekary Śląskie|35.76\nŚwiętochłowice|29.28"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares recent participation in outdoor community events between two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "136",
            "inputs": "Jaka jest średnia ocena wiedzy o ofercie kulturalnej (1-7) wśród osób, które jako barierę wskazały niewystarczającą ilość informacji?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE bariera_brak_informacji = TRUE AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL;",
                "result": "srednia_ocena_wiedzy\n3.37"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks consistency between perceived barrier and self-assessed knowledge. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "137",
            "inputs": "Czy osoby samozatrudnione w Rudzie Śląskiej wydają średnio więcej na kulturę niż osoby pracujące na etacie w tym samym mieście?",
            "expected_output": {
                "sql_query": "WITH EmploymentStatus AS ( SELECT CASE WHEN zatrudnienie_samozatrudniony = TRUE THEN 'Samozatrudniony' WHEN zatrudnienie_pracujacy = TRUE THEN 'Zatrudniony na etacie' ELSE 'Inny status' END AS status_zatrudnienia, wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE miasto_powiat = 'Ruda Śląska' AND (zatrudnienie_samozatrudniony = TRUE OR zatrudnienie_pracujacy = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT status_zatrudnienia, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM EmploymentStatus GROUP BY status_zatrudnienia;",
                "result": "status_zatrudnienia|srednie_wydatki\nSamozatrudniony|63.3\nZatrudniony na etacie|155.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses CTE to define employment status within Ruda Śląska and compares weighted average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "138",
            "inputs": "Jakie 3 formy spędzania wolnego czasu są najważniejsze (ocena 'zdecydowanie tak') dla osób z segmentu 'Konsumenci Kultury Instytucjonalnej'?",
            "expected_output": {
                "sql_query": "WITH SegmentData AS (SELECT * FROM participation_survey WHERE segment_uczestnika = 'Konsumenci Kultury Instytucjonalnej') SELECT 'Użyteczny/Praktyczny' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_praktycznosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Poczucie dumy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_duma = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Tworzenie rękodzieła' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rekodzielo = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Daje radość' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_radosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Czas z rodziną' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_rodzina = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Potrzeby bliskich' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_potrzeby_bliskich = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Zakupy' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_zakupy = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Jest nowością' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_nowosc = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData UNION ALL SELECT 'Samopoznanie' AS forma, ROUND(SUM(CASE WHEN wolny_czas_definicja_samopoznanie = 'zdecydowanie tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM SegmentData ORDER BY procent DESC LIMIT 3;",
                "result": "forma|procent\nDaje radość|43.62\nCzas z rodziną|28.1\nSamopoznanie|20.41"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Filters for a specific segment. Uses UNION ALL to calculate percentage agreement for multiple leisure definitions and selects the top 3."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "139",
            "inputs": "Czy w Tychach osoby uważające, że moralność jest częścią kultury, częściej odwiedzają kościoły (implikowane przez kulturę religijną) niż osoby uważające inaczej?",
            "expected_output": {
                "sql_query": "SELECT kultura_moralnosc, ROUND(SUM(CASE WHEN kultura_religia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_religia_jako_kultura FROM participation_survey WHERE miasto_powiat = 'Tychy' AND kultura_moralnosc IN ('Tak', 'Nie') GROUP BY kultura_moralnosc;",
                "result": "kultura_moralnosc|procent_religia_jako_kultura\nTak|58.73\nNie|21.04"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses 'kultura_religia = Tak' as a proxy for valuing religious culture, comparing groups based on their view of morality as culture within Tychy."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "140",
            "inputs": "Jaki procent mieszkańców Dąbrowy Górniczej odwiedził Pałac Kultury Zagłębia (jako dom kultury)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_domu_kultury = 'Pałac Kultury Zagłębia' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_pkz FROM participation_survey WHERE miasto_powiat = 'Dąbrowa Górnicza';",
                "result": "procent_odwiedzil_pkz\n2.03"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific city and checks for visits to a specific categorized institution."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "141",
            "inputs": "Czy osoby w wieku 50-59 lat w GZM częściej słuchają podcastów niż oglądają programy kulturalne w TV?",
            "expected_output": {
                "sql_query": "SELECT 'Podcasty (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_podcasty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE grupa_wiekowa = '50-59' UNION ALL SELECT 'Programy kulturalne TV (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_programy_kulturalne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE grupa_wiekowa = '50-59';",
                "result": "aktywnosc|procent\nPodcasty (rocznie)|11.16\nProgramy kulturalne TV (rocznie)|42.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation in two different media consumption activities for a specific age group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "142",
            "inputs": "Jaka jest średnia ocena (1-7) wpływu kultury na atrakcyjność regionu wśród mieszkańców subregionu sosnowieckiego?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_atrakcyjnosc_regionu = '2' THEN 2 WHEN opinia_kultura_atrakcyjnosc_regionu = '3' THEN 3 WHEN opinia_kultura_atrakcyjnosc_regionu = '4' THEN 4 WHEN opinia_kultura_atrakcyjnosc_regionu = '5' THEN 5 WHEN opinia_kultura_atrakcyjnosc_regionu = '6' THEN 6 WHEN opinia_kultura_atrakcyjnosc_regionu = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_atrakcyjnosc FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' AND opinia_kultura_atrakcyjnosc_regionu IS NOT NULL;",
                "result": "srednia_ocena_atrakcyjnosc\n4.51"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average rating for a specific opinion within a specific subregion. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "143",
            "inputs": "Czy osoby, które jako główną barierę wskazują 'mało atrakcyjną ofertę', rzadziej odwiedzają jakiekolwiek instytucje kultury (ostatnie 6 msc)?",
            "expected_output": {
                "sql_query": "SELECT bariera_nieatrakcyjna_oferta, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE OR ostatnio_teatr = TRUE OR ostatnio_koncert = TRUE OR ostatnio_muzeum = TRUE OR ostatnio_dom_kultury = TRUE OR ostatnio_biblioteka = TRUE OR ostatnio_filharmonia = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_instytucje FROM participation_survey WHERE bariera_nieatrakcyjna_oferta IS NOT NULL GROUP BY bariera_nieatrakcyjna_oferta;",
                "result": "bariera_nieatrakcyjna_oferta|procent_odwiedzil_instytucje\nFalse|60.42\nTrue|67.7"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines institutional visit broadly (cinema, theatre, concert, museum, community center, library, philharmonic). Checks consistency between perceived barrier and recent behavior."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "144",
            "inputs": "W Katowicach, jaki procent mieszkańców zespołu dzielnic śródmiejskich odwiedził teatr w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_teatr, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic śródmiejskich';",
                "result": "procent_teatr_6msc\n13.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the downtown zone and calculates recent theatre attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "145",
            "inputs": "Czy mieszkańcy gminy Wojkowice częściej niż mieszkańcy gminy Bobrowniki uważają, że fotografia to kultura?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN kultura_fotografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_foto_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Wojkowice', 'Bobrowniki') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_foto_kultura\nWojkowice|100.0\nBobrowniki|91.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares perception of a specific cultural form between two specific municipalities within the same county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "146",
            "inputs": "Jaki procent osób w GZM, które opiekują się dzieckiem poniżej 13 r.ż., wskazuje 'opiekę nad inną osobą' jako barierę w uczestnictwie w kulturze?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN bariera_opieka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_opieka FROM participation_survey WHERE opieka_nad_dzieckiem = TRUE;",
                "result": "procent_bariera_opieka\n12.85"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks how often childcare responsibilities overlap with reporting caregiving as a barrier."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "147",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między osobami z niepełnosprawnością słuchu a osobami z niepełnosprawnością wzroku.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN niepelnosprawnosc_sluch = TRUE THEN 'Niepełnosprawność słuchu' WHEN niepelnosprawnosc_wzrok = TRUE THEN 'Niepełnosprawność wzroku' END AS typ_niepelnosprawnosci, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_wzrok = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY typ_niepelnosprawnosci;",
                "result": "typ_niepelnosprawnosci|srednie_wydatki\nNiepełnosprawność słuchu|112.98\nNiepełnosprawność wzroku|145.32"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares weighted average spending between two specific disability groups."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "148",
            "inputs": "Czy osoby, które korzystają z kultury poza GZM, częściej odwiedzają muzea (rocznie) niż osoby, które tego nie robią?",
            "expected_output": {
                "sql_query": "SELECT uczestnictwo_poza_gzm_czas, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE uczestnictwo_poza_gzm_czas IS NOT NULL GROUP BY uczestnictwo_poza_gzm_czas;",
                "result": "uczestnictwo_poza_gzm_czas|procent_muzea_rocznie\nFalse|13.99\nTrue|50.6"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links travel outside GZM for culture with annual museum attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "149",
            "inputs": "W subregionie tyskim, jaki jest odsetek osób, które jako pierwsze skojarzenie z miejscami kultury GZM wymieniają NOSPR?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'NOSPR' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_nospr FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI';",
                "result": "procent_skojarzenie_nospr\n1.17"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific subregion and checks the primary association category for a specific venue."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "150",
            "inputs": "Czy osoby, które uważają, że taniec jest częścią kultury, częściej uczestniczą w koncertach (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT kultura_taniec, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE kultura_taniec IN ('Tak', 'Nie') GROUP BY kultura_taniec;",
                "result": "kultura_taniec|procent_koncerty_rocznie\nTak|41.58\nNie|28.55"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links perception of one art form (dance) with participation in another (concerts)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "151",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic południowych Katowic odwiedził ostatnio (6 msc) park rozrywki?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_park_rozrywki, waga_proby, CASE WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_park_rozrywki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_park_rozrywki_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic południowych';",
                "result": "procent_park_rozrywki_6msc\n38.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the southern zone and calculates recent amusement park attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "152",
            "inputs": "Czy emeryci w Gliwicach częściej niż emeryci w Bytomiu jako barierę wskazują wysokie ceny?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny FROM participation_survey WHERE zatrudnienie_emeryt = TRUE AND miasto_powiat IN ('Gliwice', 'Bytom') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_bariera_ceny\nBytom|36.55\nGliwice|70.93"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares a specific barrier for retirees between two cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "153",
            "inputs": "Jaka jest średnia ocena (1-7) stwierdzenia 'Bez dostępu do kultury życie byłoby uboższe' wśród osób, które nie odwiedziły żadnej instytucji kultury w ostatnich 6 miesiącach?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_ubozsze_zycie = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_ubozsze_zycie = '2' THEN 2 WHEN opinia_kultura_ubozsze_zycie = '3' THEN 3 WHEN opinia_kultura_ubozsze_zycie = '4' THEN 4 WHEN opinia_kultura_ubozsze_zycie = '5' THEN 5 WHEN opinia_kultura_ubozsze_zycie = '6' THEN 6 WHEN opinia_kultura_ubozsze_zycie = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_ubozsze FROM participation_survey WHERE ostatnio_zadne = TRUE AND opinia_kultura_ubozsze_zycie IS NOT NULL;",
                "result": "srednia_ocena_ubozsze\n3.53"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks the perceived value of culture among non-participants (last 6 months). Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "154",
            "inputs": "Czy w powiecie tarnogórskim osoby z wykształceniem wyższym częściej odwiedzają muzea niż osoby z wykształceniem niższym niż średnie?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND wyksztalcenie IN ('wyższe', 'niższe niż średnie') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_muzea_rocznie\nwyższe|31.5\nniższe niż średnie|4.49"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares participation based on education level within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "155",
            "inputs": "W subregionie bytomskim, jakie jest top 3 skojarzenie (kategoria 1) z wydarzeniami GZM?",
            "expected_output": {
                "sql_query": "SELECT skojarzenia_wydarzenia_gzm_1_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI'), 2) AS procent_wskazan FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' AND skojarzenia_wydarzenia_gzm_1_kategoria IS NOT NULL AND skojarzenia_wydarzenia_gzm_1_kategoria NOT IN ('brak', 'nie wiem/trudno powiedzieć', 'inne') GROUP BY skojarzenia_wydarzenia_gzm_1_kategoria ORDER BY procent_wskazan DESC LIMIT 3;",
                "result": "skojarzenia_wydarzenia_gzm_1_kategoria|procent_wskazan\nkoncerty / imprezy muzyczne|8.4\ndni miasta|5.31\nfestiwale muzyczne|4.92"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific subregion and finds the most common event associations (category 1), excluding non-specific answers."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "156",
            "inputs": "Czy osoby korzystające z kultury głównie w domu częściej uważają, że jest wiele ważniejszych rzeczy niż kultura (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN preferowane_miejsce_dom = TRUE AND preferowane_miejsce_instytucja_kultury = FALSE AND preferowane_miejsce_przestrzen_publiczna = FALSE AND preferowane_miejsce_przestrzen_tymczasowa = FALSE AND preferowane_miejsce_stadion = FALSE AND preferowane_miejsce_pub_klub = FALSE THEN 'Głównie w domu' ELSE 'Poza domem / Mieszane' END AS preferencja_miejsca, ROUND(SUM(CASE WHEN opinia_wazniejsze_rzeczy_niz_kultura IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_wazniejsze FROM participation_survey GROUP BY preferencja_miejsca HAVING preferencja_miejsca = 'Głównie w domu';",
                "result": "preferencja_miejsca|procent_zgody_wazniejsze\nGłównie w domu|45.71"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'primarily at home' by checking the 'dom' preference is TRUE and others are FALSE. Calculates agreement (5-7) for this specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "157",
            "inputs": "Porównaj odsetek osób śledzących profile instytucji kultury na Facebooku między zespołem dzielnic zachodnich i wschodnich Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT facebook_profile_instytucji, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN facebook_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_inst_fb FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic zachodnich', 'Zespół dzielnic wschodnich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_sledzi_inst_fb\nZespół dzielnic zachodnich|14.55\nZespół dzielnic wschodnich|7.69"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares the percentage following institutions on Facebook between the western and eastern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "158",
            "inputs": "Czy w powiecie gliwickim osoby uważające gotowanie za część kultury wydają średnio więcej na kulturę miesięcznie?",
            "expected_output": {
                "sql_query": "SELECT kultura_gotowanie, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND kultura_gotowanie IN ('Tak', 'Nie') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY kultura_gotowanie;",
                "result": "kultura_gotowanie|srednie_wydatki\nTak|114.76\nNie|87.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links perception of cooking as culture with average spending within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "159",
            "inputs": "Jaki procent rencistów w GZM odwiedził teatr w ciągu ostatnich 3 lat (ale nie w ostatnim roku)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_1_3_lata FROM participation_survey WHERE zatrudnienie_rencista = TRUE;",
                "result": "procent_teatr_1_3_lata\n16.51"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific employment status (disability pensioner) and calculates percentage for a specific frequency category."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "160",
            "inputs": "Czy mieszkańcy gminy Gierałtowice częściej niż mieszkańcy gminy Pilchowice odwiedzają miejsca kultury w Gliwicach?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN miejsce_kultury_gliwice = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedza_gliwice FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_odwiedza_gliwice\nPilchowice|40.14\nGierałtowice|73.88"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares travel patterns for culture to a major city from two specific municipalities within the same county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "161",
            "inputs": "Wśród osób, które nigdy nie były w filharmonii, jaki procent chciałby pójść w przyszłości?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_filharmonia = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN czestotliwosc_filharmonia IN ('Nigdy, ale chciał(a)bym w przyszłości', 'Nigdy i nie jestem tym zainteresowany(a)') THEN waga_proby ELSE 0 END), 2) AS procent_chcialby_pojsc FROM participation_survey WHERE czestotliwosc_filharmonia IN ('Nigdy, ale chciał(a)bym w przyszłości', 'Nigdy i nie jestem tym zainteresowany(a)');",
                "result": "procent_chcialby_pojsc\n34.63"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates the percentage within the subgroup of 'never attended' respondents."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "162",
            "inputs": "Jak różni się średnia ocena (1-7) 'kultura jest dla wszystkich' między mężczyznami i kobietami w Chorzowie?",
            "expected_output": {
                "sql_query": "SELECT plec, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_dla_wszystkich = '2' THEN 2 WHEN opinia_kultura_dla_wszystkich = '3' THEN 3 WHEN opinia_kultura_dla_wszystkich = '4' THEN 4 WHEN opinia_kultura_dla_wszystkich = '5' THEN 5 WHEN opinia_kultura_dla_wszystkich = '6' THEN 6 WHEN opinia_kultura_dla_wszystkich = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dla_wszystkich FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND plec IN ('Kobieta', 'Mężczyzna') AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY plec;",
                "result": "plec|srednia_ocena_dla_wszystkich\nMężczyzna|4.6\nKobieta|5.01"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares average rating for a specific opinion between genders within a specific city. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "163",
            "inputs": "Czy osoby, które czerpią informacje o kulturze głównie z prasy drukowanej, wydają średnio mniej na kulturę niż osoby czerpiące info głównie z lokalnych portali?",
            "expected_output": {
                "sql_query": "WITH InfoSource AS ( SELECT CASE WHEN informacja_prasa_drukowana = TRUE AND informacja_portale_lokalne = FALSE THEN 'Prasa (głównie)' WHEN informacja_portale_lokalne = TRUE AND informacja_prasa_drukowana = FALSE THEN 'Portale Lokalne (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo, wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE (informacja_prasa_drukowana = TRUE OR informacja_portale_lokalne = TRUE) AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT glowne_zrodlo, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM InfoSource WHERE glowne_zrodlo IN ('Prasa (głównie)', 'Portale Lokalne (głównie)') GROUP BY glowne_zrodlo;",
                "result": "glowne_zrodlo|srednie_wydatki\nPortale Lokalne (głównie)|121.29\nPrasa (głównie)|121.77"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses CTE to define primary info source groups (press only vs. local portals only) and compares weighted average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "164",
            "inputs": "Jaki procent mieszkańców Siemianowic Śląskich odwiedził ostatnio (6 msc) dom kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_6msc FROM participation_survey WHERE miasto_powiat = 'Siemianowice Śląskie';",
                "result": "procent_dom_kultury_6msc\n4.37"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates recent participation in community centers for a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "165",
            "inputs": "W zespole dzielnic południowych Katowic, czy bariera 'wysokie ceny' jest częściej wskazywana niż 'brak czasu'?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneS AS ( SELECT bariera_wysokie_ceny, bariera_brak_czasu, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Wysokie ceny' AS bariera, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS UNION ALL SELECT 'Brak czasu' AS bariera, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS ORDER BY procent DESC;",
                "result": "bariera|procent\nWysokie ceny|47.19\nBrak czasu|43.45"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the southern zone. Compares the frequency of two specific barriers."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "166",
            "inputs": "Czy osoby z segmentu 'Wycofani' częściej niż osoby z segmentu 'Przymusowi Domatorzy' uważają, że w kulturze poruszane są mało istotne dla nich tematy (ocena 5-7)?",
            "expected_output": {
                "sql_query": "SELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_nieistotne_tematy IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_nieistotne FROM participation_survey WHERE segment_uczestnika IN ('Wycofani', 'Przymusowi Domatorzy') GROUP BY segment_uczestnika;",
                "result": "segment_uczestnika|procent_zgody_nieistotne\nPrzymusowi Domatorzy|31.1\nWycofani|29.98"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares a specific opinion between two pre-defined user segments."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "167",
            "inputs": "Jaka jest średnia częstotliwość (skala 1-7) korzystania z kultury online wśród osób, które jako główne źródło informacji wskazują profile instytucji w social mediach?",
            "expected_output": {
                "sql_query": "WITH InfoSource AS ( SELECT CASE WHEN informacja_social_media_instytucje = TRUE AND informacja_social_media_tworcy = FALSE AND informacja_social_media_inne = FALSE THEN 'SM Instytucje (głównie)' ELSE 'Inne/Mieszane' END AS glowne_zrodlo, czestotliwosc_kultura_online, waga_proby FROM participation_survey WHERE informacja_social_media_instytucje = TRUE OR informacja_social_media_tworcy = TRUE OR informacja_social_media_inne = TRUE ) SELECT ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online FROM InfoSource WHERE glowne_zrodlo = 'SM Instytucje (głównie)' AND czestotliwosc_kultura_online IS NOT NULL;",
                "result": "srednia_czestotliwosc_online\n4.3"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses CTE to define primary info source (institutional SM only). Calculates average online frequency for this group. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "168",
            "inputs": "Czy w powiecie będzińskim osoby odwiedzające miejsca kultury poza GZM częściej wskazują Kraków jako cel?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN LOWER(miejsce_poza_gzm_tekst) LIKE '%kraków%' OR LOWER(miejsce_poza_gzm_tekst) LIKE '%krakow%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_krakow FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND uczestnictwo_poza_gzm_czas = TRUE AND miejsce_poza_gzm_tekst IS NOT NULL;",
                "result": "procent_krakow\n16.31"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific county and travel outside GZM. Uses text search in the destination field for 'Kraków' (with and without Polish character)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "169",
            "inputs": "Jaki procent mieszkańców Katowic i Gliwic uważa, że patriotyzm to część kultury?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Gliwice') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_patriotyzm_kultura\nGliwice|79.32\nKatowice|69.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares perception of patriotism as culture between two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "170",
            "inputs": "Czy osoby, które aktywnie tworzą (np. malują, grają muzykę), częściej deklarują 'brak czasu' jako barierę niż osoby nietworzące?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN 'Aktywny twórczo' ELSE 'Nieaktywny twórczo' END AS status_tworczosci, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey GROUP BY status_tworczosci;",
                "result": "status_tworczosci|procent_bariera_czas\nNieaktywny twórczo|40.62\nAktywny twórczo|37.6"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Defines creative activity broadly. Compares the reporting frequency of the 'lack of time' barrier."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "171",
            "inputs": "Wśród mieszkańców zespołu dzielnic zachodnich Katowic, jaka jest średnia miesięczna kwota wydatków na kulturę?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';",
                "result": "srednie_miesieczne_wydatki\n105.49"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the western zone and calculates weighted average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "172",
            "inputs": "Czy mieszkańcy gminy Siewierz częściej niż mieszkańcy gminy Czeladź odwiedzili ostatnio (6 msc) bibliotekę?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_biblioteka_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Siewierz', 'Czeladź') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_biblioteka_6msc\nCzeladź|20.93\nSiewierz|3.96"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares recent participation in a specific institution between two specific municipalities within the same county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "173",
            "inputs": "Jaki procent osób z wykształceniem podstawowym uważa, że pornografia to część kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kultura_pornografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_porno_kultura FROM participation_survey WHERE wyksztalcenie = 'niższe niż średnie';",
                "result": "procent_porno_kultura\n27.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks perception of a controversial item as culture within a specific education group ('niższe niż średnie' includes primary/gymnasium/vocational)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "174",
            "inputs": "Porównaj odsetek osób, które odwiedziły Muzeum Śląskie, między mieszkańcami Katowic a mieszkańcami Bytomia.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum Śląskie w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_msl FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Bytom') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_odwiedzil_msl\nKatowice|5.92\nBytom|2.39"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares visitation rates to a specific, major institution between residents of two cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "175",
            "inputs": "Czy osoby często korzystające z komunikacji regionalnej (kolej) częściej odwiedzają miejsca kultury w innych miastach GZM?",
            "expected_output": {
                "sql_query": "SELECT transport_komunikacja_regionalna, ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_inne_miasta FROM participation_survey WHERE transport_komunikacja_regionalna IS NOT NULL GROUP BY transport_komunikacja_regionalna;",
                "result": "transport_komunikacja_regionalna|procent_kultura_inne_miasta\nFalse|26.4\nTrue|27.25"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links usage of a specific transport mode (regional rail) with cultural mobility within GZM."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "176",
            "inputs": "Jaka jest średnia ocena (1-7) istotności kultury wśród osób, które jako swoją definicję kultury podają 'Dziedzictwo/historia...'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE definicja_kultury_kategoria = 'Dziedzictwo/historia/narodowość/regionalność/tożsamość' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;",
                "result": "srednia_istotnosc\n5.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links a specific culture definition category with the average perceived importance of culture. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "177",
            "inputs": "Czy w zespole dzielnic wschodnich Katowic mieszkańcy częściej odwiedzają muzea niż kina (ostatnie 6 msc)?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneE AS ( SELECT ostatnio_muzeum, ostatnio_kino, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') ) SELECT 'Muzea (ost. 6 msc)' AS aktywnosc, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE UNION ALL SELECT 'Kina (ost. 6 msc)' AS aktywnosc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE ORDER BY procent DESC;",
                "result": "aktywnosc|procent\nKina (ost. 6 msc)|62.34\nMuzea (ost. 6 msc)|7.26"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the eastern zone. Compares recent participation in two specific activities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "178",
            "inputs": "Jaki procent osób z powiatu pszczyńskiego uważa, że 'uprawianie ogrodu' to część kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kultura_ogrodnictwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogrod_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński';",
                "result": "procent_ogrod_kultura\n61.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks perception of a specific lifestyle activity as culture within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "179",
            "inputs": "Czy osoby, które 'zdecydowanie' uważają, że najlepszy czas wolny daje dużo radości, częściej chodzą na koncerty (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wolny_czas_definicja_radosc = 'zdecydowanie tak' THEN 'Zdecydowanie radość' ELSE 'Mniej niż zdecydowanie' END AS priorytet_radosc, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE wolny_czas_definicja_radosc IS NOT NULL GROUP BY priorytet_radosc;",
                "result": "priorytet_radosc|procent_koncerty_rocznie\nMniej niż zdecydowanie|35.0\nZdecydowanie radość|44.71"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links strong agreement with a specific leisure definition (joy) with annual concert attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "180",
            "inputs": "Porównaj odsetek osób odwiedzających Bytom w celach kulturalnych między mieszkańcami Chorzowa i Zabrza.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN miejsce_kultury_bytom = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedza_bytom FROM participation_survey WHERE miasto_powiat IN ('Chorzów', 'Zabrze') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_odwiedza_bytom\nZabrze|7.56\nChorzów|5.5"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares travel patterns for culture to Bytom from two other specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "181",
            "inputs": "Jaka jest średnia ocena (1-7) istotności kultury wśród osób, które pracują wyłącznie zdalnie?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE miejsce_wykonywania_pracy = 'wyłącznie w domu | zdalnie' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;",
                "result": "srednia_istotnosc\n4.74"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific work mode and calculates the average importance rating. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "182",
            "inputs": "Czy w subregionie gliwickim osoby z wykształceniem wyższym częściej niż osoby ze średnim śledzą profile twórców na YouTube?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN youtube_profile_tworcow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_yt_tworcow FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND wyksztalcenie IN ('wyższe', 'średnie') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_sledzi_yt_tworcow\nśrednie|13.72\nwyższe|15.06"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares specific online behavior based on education level within a specific subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "183",
            "inputs": "Jaki procent mieszkańców Tychów odwiedził Teatr Rozrywki w Chorzowie?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Rozrywki w Chorzowie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_trozrywki FROM participation_survey WHERE miasto_powiat = 'Tychy';",
                "result": "procent_odwiedzil_trozrywki\n1.14"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific city and checks for visits to a specific categorized institution in another city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "184",
            "inputs": "W Katowicach, czy mieszkańcy zespołu dzielnic północnych częściej jako barierę wskazują problemy z dojazdem niż mieszkańcy zespołu dzielnic śródmiejskich?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT bariera_dojazd, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic śródmiejskich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_bariera_dojazd\nZespół dzielnic śródmiejskich|16.25\nZespół dzielnic północnych|14.45"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares the frequency of a specific barrier between the northern and downtown zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "185",
            "inputs": "Czy osoby, które uważają, że urządzanie mieszkania to część kultury, częściej czytają prasę kulturalną (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT kultura_urzadzanie_mieszkania, ROUND(SUM(CASE WHEN czestotliwosc_prasa_kulturalna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czyta_prase_kult FROM participation_survey WHERE kultura_urzadzanie_mieszkania IN ('Tak', 'Nie') GROUP BY kultura_urzadzanie_mieszkania;",
                "result": "kultura_urzadzanie_mieszkania|procent_czyta_prase_kult\nTak|26.15\nNie|20.4"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links perception of a lifestyle activity as culture with participation in reading cultural press."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "186",
            "inputs": "Jaka jest średnia miesięczna kwota wydatków na kulturę w gminie Łaziska Górne (pow. mikołowski)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Łaziska Górne' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": "srednie_wydatki\n68.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific municipality within a specific county and calculates average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "187",
            "inputs": "Porównaj odsetek osób, które odwiedziły Teatr Śląski, między mieszkańcami Katowic a mieszkańcami Sosnowca.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Śląski im. Stanisława Wyspiańskiego w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_tsl FROM participation_survey WHERE miasto_powiat IN ('Katowice', 'Sosnowiec') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_odwiedzil_tsl\nKatowice|5.59\nSosnowiec|1.03"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares visitation rates to a specific, major institution between residents of two cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "188",
            "inputs": "Czy osoby w wieku 30-39 lat częściej niż osoby 50-59 lat korzystają z oferty bibliotek w celach innych niż wypożyczanie książek?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN biblioteka_wypozyczanie_innych_rzeczy = TRUE OR biblioteka_spotkanie_z_artysta = TRUE OR biblioteka_prelekcja = TRUE OR biblioteka_wystawa = TRUE OR biblioteka_inne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_inne_cele_bibl FROM participation_survey WHERE grupa_wiekowa IN ('30-39', '50-59') GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_inne_cele_bibl\n30-39|2.96\n50-59|3.71"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares engagement in additional library activities between two specific age groups."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "189",
            "inputs": "W zespole dzielnic południowych Katowic, jaka aktywność domowa związana z kulturą jest najpopularniejsza: czytanie książek czy oglądanie programów TV?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneS AS ( SELECT kultura_domowa_ksiazki, kultura_domowa_tv, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Czytanie książek' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_ksiazki = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS UNION ALL SELECT 'Oglądanie programów TV' AS aktywnosc, ROUND(SUM(CASE WHEN kultura_domowa_tv = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneS ORDER BY procent DESC;",
                "result": "aktywnosc|procent\nOglądanie programów TV|58.45\nCzytanie książek|53.56"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the southern zone. Compares the prevalence of two specific home-based cultural activities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "190",
            "inputs": "Jaki procent osób w GZM z niepełnosprawnością słuchu odwiedził kino w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie FROM participation_survey WHERE niepelnosprawnosc_sluch = TRUE;",
                "result": "procent_kino_rocznie\n31.8"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates annual cinema attendance for a specific disability group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "191",
            "inputs": "Czy mieszkańcy subregionu tyskiego częściej niż mieszkańcy subregionu katowickiego uważają, że 'to jak się do siebie zwracamy' jest częścią kultury?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') THEN 'Katowicki (łącznie z Katowicami)' WHEN subregion_metropolii_gzm = 'TYSKI' THEN 'Tyski' ELSE subregion_metropolii_gzm END AS subregion_grupa, ROUND(SUM(CASE WHEN kultura_sposob_zwracania_sie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sposob_zwracania FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI', 'TYSKI') GROUP BY subregion_grupa;",
                "result": "subregion_grupa|procent_sposob_zwracania\nTyski|92.43\nKatowicki (łącznie z Katowicami)|88.53"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Updated to combine subregion_metropolii_gzm 'KATOWICE' and 'KATOWICKI' into a single group 'Katowicki (łącznie z Katowicami)' for comparison with 'TYSKI', as per user instruction for 'katowickiego'. Original expected_result is kept but will change (structure and values) based on the updated query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "192",
            "inputs": "W Gliwicach, jaka jest średnia ocena (1-7) stwierdzenia 'Udział w wydarzeniach kulturalnych zapewnia przeżycia'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_przezycia = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przezycia = '2' THEN 2 WHEN opinia_kultura_przezycia = '3' THEN 3 WHEN opinia_kultura_przezycia = '4' THEN 4 WHEN opinia_kultura_przezycia = '5' THEN 5 WHEN opinia_kultura_przezycia = '6' THEN 6 WHEN opinia_kultura_przezycia = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przezycia FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND opinia_kultura_przezycia IS NOT NULL;",
                "result": "srednia_ocena_przezycia\n4.83"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average rating for a specific opinion within a specific city. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "193",
            "inputs": "Czy osoby, które jako pierwsze skojarzenie z wydarzeniami GZM podają 'koncerty', wydają średnio więcej na kulturę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN skojarzenia_wydarzenia_gzm_1_kategoria = 'koncerty / imprezy muzyczne' THEN 'Skojarzenie: Koncerty' ELSE 'Inne skojarzenie' END AS typ_skojarzenia, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY typ_skojarzenia;",
                "result": "typ_skojarzenia|srednie_wydatki\nSkojarzenie: Koncerty|122.93\nInne skojarzenie|111.95"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links top-of-mind association with average spending behavior."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "194",
            "inputs": "Jaki procent mieszkańców Katowic z zespołu dzielnic zachodnich odwiedził ostatnio (6 msc) koncert?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_koncert, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncert_6msc FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';",
                "result": "procent_koncert_6msc\n11.7"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the western zone and calculates recent concert attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "195",
            "inputs": "Porównaj odsetek osób w wieku poniżej 30 lat i 60+ lat, które uważają, że 'to, jak traktujemy inne narody' jest częścią kultury.",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN kultura_traktowanie_narodow = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_traktowanie_kultura FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_traktowanie_kultura\nMniej niż 30|85.21\n60 i więcej|84.58"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares perception of a specific social value as culture between two age groups."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "196",
            "inputs": "Czy w powiecie bieruńsko-lędzińskim osoby częściej odwiedzają pikniki/festyny (rocznie) niż koncerty (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT 'Pikniki/Festyny (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' UNION ALL SELECT 'Koncerty (rocznie)' AS aktywnosc, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński';",
                "result": "aktywnosc|procent\nPikniki/Festyny (rocznie)|82.3\nKoncerty (rocznie)|54.9"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation in two different activity types within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "197",
            "inputs": "Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród osób, które nie odwiedziły żadnego miejsca kultury poza swoim miastem zamieszkania?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE uczestnictwo_miejsce_zamieszkania = TRUE AND uczestnictwo_miejsce_pracy = FALSE AND uczestnictwo_inne_miejsce_gzm = FALSE AND uczestnictwo_poza_gzm = FALSE AND ocena_dostepu_do_kultury_gzm IS NOT NULL;",
                "result": "srednia_ocena_dostepu\n4.87"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines 'only in place of residence' strictly by checking other locations are FALSE. Calculates average access rating for this group. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "198",
            "inputs": "Czy mieszkańcy Katowic, którzy odwiedzili ostatnio (6 msc) spotkanie z artystą, częściej deklarują twórczość własną (np. pisanie, fotografia)?",
            "expected_output": {
                "sql_query": "SELECT ostatnio_spotkanie_z_artysta, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE miasto_powiat = 'Katowice' AND ostatnio_spotkanie_z_artysta IS NOT NULL GROUP BY ostatnio_spotkanie_z_artysta;",
                "result": "ostatnio_spotkanie_z_artysta|procent_tworczosc\nFalse|21.57\nTrue|31.84"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links recent participation in a specific event type with broad creative engagement within Katowice."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "199",
            "inputs": "W subregionie sosnowieckim, czy odsetek osób odwiedzających Teatr Zagłębia jest większy niż odsetek odwiedzających inne teatry?",
            "expected_output": {
                "sql_query": "WITH TheatreVisits AS ( SELECT waga_proby, CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Zagłębia w Sosnowcu' THEN 'Teatr Zagłębia' WHEN ostatnio_teatr = TRUE AND kategoria_odwiedzonego_teatru != 'Teatr Zagłębia w Sosnowcu' THEN 'Inne Teatry' ELSE 'Nieodwiedzający Teatru (ost 6msc)' END AS typ_teatru FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' ) SELECT typ_teatru, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM TheatreVisits), 2) AS procent FROM TheatreVisits WHERE typ_teatru IN ('Teatr Zagłębia', 'Inne Teatry') GROUP BY typ_teatru;",
                "result": "typ_teatru|procent\nInne Teatry|4.84\nTeatr Zagłębia|1.26"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses CTE to categorize recent theatre visits within the Sosnowiec subregion into 'Teatr Zagłębia' vs. 'Other Theatres'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "200",
            "inputs": "Jaki procent mieszkańców Chorzowa śledzi profile instytucji kultury na Twitterze/X?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN twitter_profile_instytucji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sledzi_inst_twitter FROM participation_survey WHERE miasto_powiat = 'Chorzów';",
                "result": "procent_sledzi_inst_twitter\n0.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates usage of a specific social media platform for following institutions in a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "201",
            "inputs": "Czy osoby, które uważają, że kultura daje poczucie przynależności (ocena 6-7), częściej uczestniczą w wydarzeniach regionalnych?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Przynależność)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_przynaleznosc, ROUND(SUM(CASE WHEN wydarzenie_regionalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wyd_regionalne FROM participation_survey WHERE opinia_kultura_przynaleznosc IS NOT NULL GROUP BY opinia_przynaleznosc;",
                "result": "opinia_przynaleznosc|procent_wyd_regionalne\nZgadza się (Przynależność)|32.05\nNie zgadza się / Mniej (1-5)|23.09"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links opinion about cultural belonging with preference for a specific event scope."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "202",
            "inputs": "Porównaj średnie wydatki na kulturę między mieszkańcami zespołu dzielnic śródmiejskich i zespołu dzielnic zachodnich Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic zachodnich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|srednie_miesieczne_wydatki\nZespół dzielnic śródmiejskich|126.73\nZespół dzielnic zachodnich|105.49"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares weighted average spending between the downtown and western zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "203",
            "inputs": "Jaki procent osób w GZM korzystających z Internetu w telefonie komórkowym odwiedził galerię sztuki w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galeria_rocznie FROM participation_survey WHERE internet_w_telefonie = TRUE;",
                "result": "procent_galeria_rocznie\n16.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links mobile internet access with annual participation in a specific cultural activity."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "204",
            "inputs": "Czy mieszkańcy gminy Rudziniec częściej niż mieszkańcy gminy Sośnicowice uczestniczą w piknikach/festynach (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_festyny_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Rudziniec', 'Sośnicowice') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_pikniki_festyny_rocznie\nRudziniec|43.42\nSośnicowice|11.93"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation in outdoor events between two specific municipalities within the same county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "205",
            "inputs": "Wśród osób uważających, że 'jest wiele ważniejszych rzeczy niż kultura' (ocena 6-7), jaki procent odwiedził ostatnio (6 msc) kino?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE opinia_wazniejsze_rzeczy_niz_kultura IN ('6', '7 w pełni sie zgadzam');",
                "result": "procent_kino_6msc\n51.52"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks participation in a common cultural activity among those who express a lower prioritization of culture."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "206",
            "inputs": "Porównaj odsetek osób, które jako pierwsze skojarzenie z miejscami GZM podają 'Teatr', między mieszkańcami subregionu tyskiego i gliwickiego.",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'teatr' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_teatr FROM participation_survey WHERE subregion_metropolii_gzm IN ('TYSKI', 'GLIWICKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_skojarzenie_teatr\nTYSKI|3.15\nGLIWICKI|3.66"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares top-of-mind association for 'theatre' between two specific subregions."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "207",
            "inputs": "Czy osoby, które korzystają z transportu pieszego jako jednego ze środków, częściej uczestniczą w kulturze w miejscu zamieszkania?",
            "expected_output": {
                "sql_query": "SELECT transport_pieszo, ROUND(SUM(CASE WHEN uczestnictwo_miejsce_zamieszkania = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_lokalnie FROM participation_survey WHERE transport_pieszo IS NOT NULL GROUP BY transport_pieszo;",
                "result": "transport_pieszo|procent_kultura_lokalnie\nFalse|60.27\nTrue|66.69"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links walking as a transport mode with local cultural participation."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "208",
            "inputs": "Jaka jest średnia ocena (1-7) stwierdzenia 'Konsumpcja kultury sprawia przyjemność' wśród osób z segmentu 'Młodzi Uciekinierzy'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosc FROM participation_survey WHERE segment_uczestnika = 'Młodzi Uciekinierzy' AND opinia_kultura_przyjemnosc IS NOT NULL;",
                "result": "srednia_ocena_przyjemnosc\n4.99"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average rating for a specific opinion within a specific segment. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "209",
            "inputs": "W zespole dzielnic wschodnich Katowic, czy mieszkańcy częściej korzystają z oferty Biblioteki Śląskiej (implikowane przez 'biblioteka') niż Teatru Śląskiego?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneE AS ( SELECT ostatnio_biblioteka, kategoria_odwiedzonego_teatru, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') ) SELECT 'Biblioteka (ost. 6 msc)' AS instytucja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE UNION ALL SELECT 'Teatr Śląski (ost. wizyta)' AS instytucja, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Śląski im. Stanisława Wyspiańskiego w Katowicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM KatowiceZoneE ORDER BY procent DESC;",
                "result": "instytucja|procent\nBiblioteka (ost. 6 msc)|24.79\nTeatr Śląski (ost. wizyta)|4.01"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification for the eastern zone. Compares recent library visits ('ostatnio_biblioteka') with specific categorized visits to Teatr Śląski ('kategoria_odwiedzonego_teatru'). Note: Compares different timeframes/metrics."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "210",
            "inputs": "Jaki procent osób z niepełnosprawnością ruchu w Katowicach jako barierę wskazuje 'trudności z fizycznym dostępem'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN bariera_dostep_fizyczny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_fizyczna FROM participation_survey WHERE miasto_powiat = 'Katowice' AND niepelnosprawnosc_ruch = TRUE;",
                "result": "procent_bariera_fizyczna\n16.02"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates the frequency of a specific barrier for a specific disability group within a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "211",
            "inputs": "Czy w Rudzie Śląskiej osoby śledzące profile instytucji w social mediach częściej odwiedzają muzea (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN informacja_social_media_instytucje = TRUE THEN 'Śledzi inst. SM' ELSE 'Nie śledzi inst. SM' END AS sledzenie_sm, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE miasto_powiat = 'Ruda Śląska' AND informacja_social_media_instytucje IS NOT NULL GROUP BY sledzenie_sm;",
                "result": "sledzenie_sm|procent_muzea_rocznie\nNie śledzi inst. SM|16.29\nŚledzi inst. SM|32.33"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links specific online behavior with offline participation within a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "212",
            "inputs": "Jaka jest średnia ocena (1-7) stwierdzenia 'Lubię poznawać nowe miejsca związane z kulturą' wśród emerytów?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_nowe_miejsca = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_nowe_miejsca = '2' THEN 2 WHEN opinia_kultura_nowe_miejsca = '3' THEN 3 WHEN opinia_kultura_nowe_miejsca = '4' THEN 4 WHEN opinia_kultura_nowe_miejsca = '5' THEN 5 WHEN opinia_kultura_nowe_miejsca = '6' THEN 6 WHEN opinia_kultura_nowe_miejsca = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_nowe_miejsca FROM participation_survey WHERE zatrudnienie_emeryt = TRUE AND opinia_kultura_nowe_miejsca IS NOT NULL;",
                "result": "srednia_ocena_nowe_miejsca\n4.57"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average rating for a specific opinion within the retiree demographic. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "213",
            "inputs": "Porównaj odsetek osób, które odwiedziły ostatnio (6 msc) zoo, między mieszkańcami zespołu dzielnic północnych i południowych Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_zoo, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_zoo = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_6msc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_zoo_6msc\nZespół dzielnic południowych|26.81\nZespół dzielnic północnych|34.12"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares recent zoo attendance between the northern and southern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "214",
            "inputs": "Czy mieszkańcy gminy Mierzęcice częściej niż mieszkańcy gminy Psary odwiedzają kina?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Mierzęcice', 'Psary') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_kino_rocznie\nPsary|39.12\nMierzęcice|78.39"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares annual participation in a specific activity between two specific municipalities within the same county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "215",
            "inputs": "Jaki procent osób, które jako barierę wskazują niską dostępność biletów, odwiedziło koncert w ciągu ostatnich 12 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncert_rocznie FROM participation_survey WHERE bariera_dostepnosc_biletow = TRUE;",
                "result": "procent_koncert_rocznie\n48.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks if the perceived barrier of ticket availability aligns with actual annual concert attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "216",
            "inputs": "Porównaj średnie wydatki na kulturę między osobami w wieku 30-39 lat a osobami w wieku 60+ w subregionie tyskim.",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND grupa_wiekowa IN ('30-39', '60 i więcej') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|srednie_wydatki\n30-39|118.82\n60 i więcej|89.74"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares weighted average spending between two age groups within a specific subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "217",
            "inputs": "Czy osoby, które uważają, że 'kultura to wszystko', częściej odwiedzają muzea (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN definicja_kultury_kategoria = 'Wszystkim/całość/wiele znaczeń' THEN 'Def: Kultura to wszystko' ELSE 'Inna definicja' END AS definicja, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE definicja_kultury_kategoria IS NOT NULL GROUP BY definicja;",
                "result": "definicja|procent_muzea_rocznie\nDef: Kultura to wszystko|28.34\nInna definicja|19.51"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links a specific, broad culture definition category with annual museum participation."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "218",
            "inputs": "Jaka jest średnia ocena (1-7) dostępu do kultury w GZM wśród mieszkańców zespołu dzielnic wschodnich Katowic?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ocena_dostepu_do_kultury_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic wschodnich';",
                "result": "srednia_ocena_dostepu\n4.65"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the eastern zone. Calculates average access rating. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "219",
            "inputs": "Czy osoby korzystające z ofert domów kultury w celu obejrzenia filmu częściej odwiedzają też kina komercyjne (ostatnie 6 msc)?",
            "expected_output": {
                "sql_query": "SELECT dom_kultury_film, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_6msc FROM participation_survey WHERE dom_kultury_film IS NOT NULL GROUP BY dom_kultury_film;",
                "result": "dom_kultury_film|procent_kino_6msc\nFalse|79.34\nTrue|92.12"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links participation in a specific activity at community centers with participation in commercial cinemas."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "220",
            "inputs": "Jaki procent mieszkańców Zabrza, którzy odwiedzili teatr, wybrało Teatr Nowy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Nowy w Zabrzu' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wybral_tnowy FROM participation_survey WHERE miasto_powiat = 'Zabrze' AND ostatnio_teatr = TRUE;",
                "result": "procent_wybral_tnowy\n61.45"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates percentage within the subgroup of recent theatre visitors in Zabrze."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "221",
            "inputs": "Porównaj średnią ocenę (1-7) 'kultura pozwala się realizować' między osobami z segmentu 'Zdobywcy Wiedzy' i 'Sensualni'.",
            "expected_output": {
                "sql_query": "SELECT segment_uczestnika, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_samorealizacja = '2' THEN 2 WHEN opinia_kultura_samorealizacja = '3' THEN 3 WHEN opinia_kultura_samorealizacja = '4' THEN 4 WHEN opinia_kultura_samorealizacja = '5' THEN 5 WHEN opinia_kultura_samorealizacja = '6' THEN 6 WHEN opinia_kultura_samorealizacja = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_samorealizacja FROM participation_survey WHERE segment_uczestnika IN ('Zdobywcy Wiedzy', 'Sensualni') AND opinia_kultura_samorealizacja IS NOT NULL GROUP BY segment_uczestnika;",
                "result": "segment_uczestnika|srednia_ocena_samorealizacja\nSensualni|5.23\nZdobywcy Wiedzy|5.37"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares average rating for a specific opinion between two segments. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "222",
            "inputs": "Czy w Sosnowcu osoby, które śledzą profile twórców w social mediach, częściej zetknęły się z twórczością lokalnego artysty?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN informacja_social_media_tworcy = TRUE THEN 'Śledzi twórców SM' ELSE 'Nie śledzi twórców SM' END AS sledzenie_sm, ROUND(SUM(CASE WHEN kontakt_z_artysta_lokalnym IN ('tak, wielokrotnie', 'tak, raz czy dwa') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kontakt_lokalny FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND informacja_social_media_tworcy IS NOT NULL GROUP BY sledzenie_sm;",
                "result": "sledzenie_sm|procent_kontakt_lokalny\nŚledzi twórców SM|9.24\nNie śledzi twórców SM|1.68"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links specific online behavior with reported contact with local artists within a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "223",
            "inputs": "Jaki procent mieszkańców Katowic z zespołu dzielnic śródmiejskich uważa, że 'umiejętność rozmawiania z innymi' to kultura?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT kultura_umiejetnosc_rozmowy, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN kultura_umiejetnosc_rozmowy = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rozmowa_kultura FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic śródmiejskich';",
                "result": "procent_rozmowa_kultura\n77.7"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the downtown zone and calculates perception of a specific social skill as culture."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "224",
            "inputs": "Czy w powiecie pszczyńskim osoby częściej odwiedzają Muzeum Zamkowe w Pszczynie (jako muzeum) niż inne muzea?",
            "expected_output": {
                "sql_query": "SELECT 'Muzeum Zamkowe Pszczyna' AS muzeum, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum Zamkowe w Pszczynie' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wskazan FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' AND ostatnio_muzeum = TRUE UNION ALL SELECT 'Inne Muzea' AS muzeum, ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum != 'Muzeum Zamkowe w Pszczynie' AND ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wskazan FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' AND ostatnio_muzeum = TRUE;",
                "result": "muzeum|procent_wskazan\nMuzeum Zamkowe Pszczyna|0.0\nInne Muzea|100.0"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates percentages within the subgroup of recent museum visitors in Pszczyna County, comparing visits to the main local museum vs. others."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "225",
            "inputs": "Porównaj odsetek osób, które jako powód braku uczestnictwa wskazują 'wysoką cenę biletów', między mieszkańcami Bytomia i Tychów.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN powod_braku_uczestnictwa_kategoria = 'Wysoka cena biletów' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_cena FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Tychy') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_bariera_cena\nTychy|1.88\nBytom|2.4"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares the frequency of a specific reason for non-participation between two cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "226",
            "inputs": "Jaki procent osób z wyższym wykształceniem w GZM korzysta z oferty archiwów instytucji kultury (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_archiwa = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_archiwa_rocznie FROM participation_survey WHERE wyksztalcenie = 'wyższe';",
                "result": "procent_archiwa_rocznie\n18.79"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates annual participation in a niche cultural activity for a specific education group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "227",
            "inputs": "Czy mieszkańcy gminy Chełm Śląski częściej niż mieszkańcy gminy Bojszowy (ten sam powiat) odwiedzili ostatnio (6 msc) biblioteki?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_biblioteka_6msc FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc IN ('Chełm Śląski', 'Bojszowy') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_biblioteka_6msc\nBojszowy|20.88\nChełm Śląski|10.53"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares recent participation (last 6 months using 'ostatnio_biblioteka') in libraries between two specific municipalities within the same county. Adjusted from annual frequency due to lack of 'czestotliwosc_biblioteka' column."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "228",
            "inputs": "Jaka jest średnia ocena (1-7) stwierdzenia 'Wypada być na bieżąco z kulturą' wśród osób w wieku 18-29 lat?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN opinia_kultura_bycie_na_biezaco = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_bycie_na_biezaco = '2' THEN 2 WHEN opinia_kultura_bycie_na_biezaco = '3' THEN 3 WHEN opinia_kultura_bycie_na_biezaco = '4' THEN 4 WHEN opinia_kultura_bycie_na_biezaco = '5' THEN 5 WHEN opinia_kultura_bycie_na_biezaco = '6' THEN 6 WHEN opinia_kultura_bycie_na_biezaco = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_bycie_na_biezaco FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30' AND opinia_kultura_bycie_na_biezaco IS NOT NULL;",
                "result": "srednia_ocena_bycie_na_biezaco\n4.72"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates average rating for a specific opinion within the youngest age group. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "229",
            "inputs": "W Katowicach, porównaj odsetek osób odwiedzających ostatnio (6 msc) piknik/festyn między zespołem dzielnic zachodnich i południowych.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_piknik, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_piknik_6msc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic zachodnich', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_piknik_6msc\nZespół dzielnic południowych|59.76\nZespół dzielnic zachodnich|56.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares recent picnic/festival attendance between the western and southern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "230",
            "inputs": "Czy osoby, które uważają, że kultura ma sens życia (ocena 6-7), częściej zajmują się jakąś formą twórczości?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN opinia_kultura_sens_zycia IN ('6', '7 w pełni sie zgadzam') THEN 'Zgadza się (Sens życia)' ELSE 'Nie zgadza się / Mniej (1-5)' END AS opinia_sens, ROUND(SUM(CASE WHEN tworczosc_gra_na_instrumencie = TRUE OR tworczosc_pisanie_tekstow = TRUE OR tworczosc_fotografia = TRUE OR tworczosc_rysowanie_malowanie = TRUE OR tworczosc_szycie_haftowanie = TRUE OR tworczosc_spiew = TRUE OR tworczosc_komponowanie = TRUE OR tworczosc_inna = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tworczosc FROM participation_survey WHERE opinia_kultura_sens_zycia IS NOT NULL GROUP BY opinia_sens;",
                "result": "opinia_sens|procent_tworczosc\nZgadza się (Sens życia)|27.76\nNie zgadza się / Mniej (1-5)|15.2"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links a strong existential view of culture's value with personal creative engagement."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "231",
            "inputs": "Jaki procent mieszkańców Gliwic odwiedził Muzeum w Gliwicach (jako muzeum)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum w Gliwicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_mgliwice FROM participation_survey WHERE miasto_powiat = 'Gliwice';",
                "result": "procent_odwiedzil_mgliwice\n0.87"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific city and checks for visits to a specific categorized local institution."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "232",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mężczyznami i kobietami w subregionie bytomskim.",
            "expected_output": {
                "sql_query": "SELECT plec, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' AND plec IN ('Kobieta', 'Mężczyzna') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY plec;",
                "result": "plec|srednie_wydatki\nMężczyzna|107.73\nKobieta|111.91"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares weighted average spending between genders within a specific subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "233",
            "inputs": "Czy osoby, które często odwiedzają rekonstrukcje historyczne (rocznie), częściej uważają patriotyzm za część kultury?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN czestotliwosc_rekonstrukcja_historyczna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Uczestnik rekonstrukcji (rocznie)' ELSE 'Nieuczestniczący (rocznie)' END AS status_rekonstrukcji, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE czestotliwosc_rekonstrukcja_historyczna IS NOT NULL GROUP BY status_rekonstrukcji;",
                "result": "status_rekonstrukcji|procent_patriotyzm_kultura\nUczestnik rekonstrukcji (rocznie)|76.87\nNieuczestniczący (rocznie)|73.99"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links participation in a specific niche activity with perception of patriotism as culture."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "234",
            "inputs": "Jaka jest średnia ocena (1-7) wiedzy o ofercie kulturalnej GZM wśród mieszkańców zespołu dzielnic północnych Katowic?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wiedza_o_ofercie_kulturalnej_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic północnych';",
                "result": "srednia_ocena_wiedzy\n4.21"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the northern zone. Calculates average knowledge rating. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "235",
            "inputs": "Czy w powiecie mikołowskim osoby z wykształceniem wyższym częściej niż osoby ze średnim odwiedzają koncerty (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND wyksztalcenie IN ('wyższe', 'średnie') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_koncerty_rocznie\nśrednie|33.25\nwyższe|49.24"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares participation based on education level within a specific county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "236",
            "inputs": "Jaki procent mieszkańców Sosnowca, którzy odwiedzili teatr, był w Teatrze Zagłębia?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_teatru = 'Teatr Zagłębia w Sosnowcu' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wybral_tzaglebia FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_teatr = TRUE;",
                "result": "procent_wybral_tzaglebia\n28.49"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates percentage within the subgroup of recent theatre visitors in Sosnowiec."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "237",
            "inputs": "Porównaj odsetek osób, które uważają, że 'sposób, jak się do siebie zwracamy' to kultura, między mieszkańcami Dąbrowy Górniczej i Zabrza.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN kultura_sposob_zwracania_sie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sposob_zwracania FROM participation_survey WHERE miasto_powiat IN ('Dąbrowa Górnicza', 'Zabrze') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_sposob_zwracania\nDąbrowa Górnicza|87.52\nZabrze|91.69"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares perception of a specific social behavior as culture between two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "238",
            "inputs": "Czy osoby, które deklarują, że najlepszy czas wolny pozwala im stworzyć coś własnymi rękoma ('zdecydowanie tak'), częściej odwiedzają domy kultury (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wolny_czas_definicja_rekodzielo = 'zdecydowanie tak' THEN 'Zdecydowanie rękodzieło' ELSE 'Mniej niż zdecydowanie' END AS priorytet_rekodzielo, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE wolny_czas_definicja_rekodzielo IS NOT NULL GROUP BY priorytet_rekodzielo;",
                "result": "priorytet_rekodzielo|procent_dom_kultury_rocznie\nZdecydowanie rękodzieło|26.44\nMniej niż zdecydowanie|19.84"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links strong agreement with a specific leisure definition (handicraft) with annual community center attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "239",
            "inputs": "Jaka jest średnia ocena (1-7) dostępności kultury w GZM wśród mieszkańców zespołu dzielnic zachodnich Katowic?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ocena_dostepu_do_kultury_gzm, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Brynów Część Wschodnia - Os. Zgrzebnioka', 'Ligota-Panewniki') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND ocena_dostepu_do_kultury_gzm IS NOT NULL ) SELECT ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM KatowiceZones WHERE zona_dzielnic = 'Zespół dzielnic zachodnich';",
                "result": "srednia_ocena_dostepu\n5.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification to filter for the western zone. Calculates average access rating. Converts scale to numeric."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "240",
            "inputs": "Czy w Świętochłowicach osoby z wykształceniem średnim częściej niż osoby z wykształceniem wyższym odwiedzają pikniki/festyny (ostatnie 6 msc)?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_piknik_6msc FROM participation_survey WHERE miasto_powiat = 'Świętochłowice' AND wyksztalcenie IN ('średnie', 'wyższe') GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_piknik_6msc\nśrednie|56.36\nwyższe|45.33"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares participation based on education level within a specific city."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "241",
            "inputs": "Jaki procent osób, które jako pierwsze skojarzenie z miejscami GZM podają 'Muzeum', odwiedziło muzeum w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzeum_6msc FROM participation_survey WHERE skojarzenia_miejsca_gzm_1_kategoria = 'muzeum';",
                "result": "procent_muzeum_6msc\n20.75"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks consistency between top-of-mind association and recent behavior."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "242",
            "inputs": "Porównaj odsetek osób korzystających z oferty domów kultury w celu obejrzenia przedstawienia teatralnego między mieszkańcami Bytomia i Zabrza.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN dom_kultury_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_teatr_w_dk FROM participation_survey WHERE miasto_powiat IN ('Bytom', 'Zabrze') AND ostatnio_dom_kultury = TRUE GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_teatr_w_dk\nBytom|16.89\nZabrze|0.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates percentage within the subgroup of recent community center visitors in two specific cities, focusing on theatre attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "243",
            "inputs": "Czy w subregionie tyskim bariera 'brak oferty lokalnej' jest częściej wskazywana przez osoby mieszkające na wsi niż w miastach?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wielkosc_miejscowosci = 'wieś' THEN 'Wieś' ELSE 'Miasto' END AS typ_miejscowosci, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_lokalna FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' GROUP BY typ_miejscowosci;",
                "result": "typ_miejscowosci|procent_bariera_lokalna\nMiasto|0.94\nWieś|2.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares a specific barrier based on locality type (rural vs. urban) within a specific subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "244",
            "inputs": "Czy osoby, które odwiedziły ostatnio (6 msc) muzeum, częściej zgadzają się (ocena 6-7), że kultura pozwala im się realizować?",
            "expected_output": {
                "sql_query": "SELECT ostatnio_muzeum, ROUND(SUM(CASE WHEN opinia_kultura_samorealizacja IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_samorealizacja FROM participation_survey WHERE ostatnio_muzeum IS NOT NULL GROUP BY ostatnio_muzeum;",
                "result": "ostatnio_muzeum|procent_zgody_samorealizacja\nFalse|20.66\nTrue|46.54"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Links recent participation in museums with strong agreement on culture's role in self-realization."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "245",
            "inputs": "Jaki procent mieszkańców subregionu katowickiego uczestniczył w rekonstrukcji historycznej przynajmniej raz w ciągu ostatnich 3 lat?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_rekonstrukcja_historyczna IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_rekonstrukcja_3lata FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI');",
                "result": "procent_rekonstrukcja_3lata\n20.26"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Updated to combine subregion_metropolii_gzm 'KATOWICE' and 'KATOWICKI' as per user instruction for 'subregionu katowickiego'. Original expected_result is kept but will change based on the updated query."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "246",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami zespołu dzielnic północnych i południowych Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|srednie_miesieczne_wydatki\nZespół dzielnic południowych|115.11\nZespół dzielnic północnych|108.28"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Compares weighted average spending between the northern and southern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "247",
            "inputs": "W powiecie tarnogórskim, jakie jest główne źródło informacji o kulturze: plakaty czy portale lokalne?",
            "expected_output": {
                "sql_query": "SELECT 'Plakaty/Ogłoszenia' AS zrodlo, ROUND(SUM(CASE WHEN informacja_plakaty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' UNION ALL SELECT 'Portale Lokalne' AS zrodlo, ROUND(SUM(CASE WHEN informacja_portale_lokalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' ORDER BY procent DESC LIMIT 1;",
                "result": "zrodlo|procent\nPlakaty/Ogłoszenia|30.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares usage percentage of two specific information sources within a specific county and selects the higher one."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "248",
            "inputs": "Czy osoby w wieku 60+ częściej korzystają z wydarzeń kulturalnych online niż osoby w wieku 18-29 lat?",
            "expected_output": {
                "sql_query": "SELECT grupa_wiekowa, ROUND(SUM(CASE WHEN cyfrowa_kultura_wydarzenia_online = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wydarzenia_online FROM participation_survey WHERE grupa_wiekowa IN ('Mniej niż 30', '60 i więcej') GROUP BY grupa_wiekowa;",
                "result": "grupa_wiekowa|procent_wydarzenia_online\nMniej niż 30|13.34\n60 i więcej|11.45"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares participation in a specific digital activity between two age groups."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "249",
            "inputs": "Porównaj odsetek osób, które uważają, że malarstwo to kultura, między mieszkańcami subregionu gliwickiego i bytomskiego.",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN kultura_malarstwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_malarstwo_kultura FROM participation_survey WHERE subregion_metropolii_gzm IN ('GLIWICKI', 'BYTOMSKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_malarstwo_kultura\nGLIWICKI|95.19\nBYTOMSKI|94.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares perception of a specific art form as culture between two subregions."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "250",
            "inputs": "Czy osoby preferujące wydarzenia o zasięgu miejskim częściej uważają, że kultura podnosi atrakcyjność regionu (ocena 5-7), niż osoby preferujące wydarzenia dzielnicowe?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN wydarzenie_miejskie = TRUE AND wydarzenie_dzielnicowe = FALSE THEN 'Preferuje miejskie (nie dziel.)' WHEN wydarzenie_dzielnicowe = TRUE AND wydarzenie_miejskie = FALSE THEN 'Preferuje dzielnicowe (nie miejs.)' ELSE 'Inne/Mieszane' END AS preferencja_zasiegu, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc FROM participation_survey WHERE (wydarzenie_miejskie = TRUE OR wydarzenie_dzielnicowe = TRUE) GROUP BY preferencja_zasiegu HAVING preferencja_zasiegu != 'Inne/Mieszane';",
                "result": "preferencja_zasiegu|procent_zgody_atrakcyjnosc\nPreferuje miejskie (nie dziel.)|61.17\nPreferuje dzielnicowe (nie miejs.)|67.3"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Defines preference groups strictly (one preferred, the other not). Links event scope preference with opinion on culture's regional impact."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "251",
            "inputs": "Czy średnie miesięczne wydatki na kulturę są wyższe w zespole dzielnic śródmiejskich Katowic niż w zespole dzielnic południowych?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_miesieczne_wydatki FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|srednie_miesieczne_wydatki\nZespół dzielnic śródmiejskich|126.73\nZespół dzielnic południowych|115.11"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification of Katowice districts. Compares weighted average monthly cultural expenditure between the downtown zone and the southern zone, excluding respondents with missing expenditure data."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "252",
            "inputs": "Jakie wydarzenia kulturalne (ostatnie 6 msc) są popularniejsze w zespole dzielnic północnych Katowic w porównaniu do zespołu dzielnic wschodnich?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_teatr, ostatnio_koncert, ostatnio_muzeum, ostatnio_piknik, ostatnio_kino, waga_proby, CASE WHEN dzielnica_katowic IN ('Załęże', 'Osiedle Witosa', 'Osiedle Tysiąclecia', 'Dąb', 'Wełnowiec-Józefowiec') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS teatr_proc, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS koncerty_proc, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS muzea_proc, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS pikniki_proc, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS kino_proc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic wschodnich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|teatr_proc|koncerty_proc|muzea_proc|pikniki_proc|kino_proc\nZespół dzielnic wschodnich|9.09|11.98|7.26|50.51|62.34\nZespół dzielnic północnych|10.3|12.88|11.78|53.77|56.31"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification of Katowice districts. Compares percentage attendance for five types of cultural activities (theatre, concert, museum, picnic, cinema) in the last 6 months between the northern and eastern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "253",
            "inputs": "Czy mieszkańcy zespołu dzielnic wschodnich Katowic (np. Nikiszowiec, Giszowiec) częściej doceniają kulturę jako element tożsamości lokalnej niż mieszkańcy zespołu dzielnic śródmiejskich?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT opinia_kultura_przynaleznosc, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_przynaleznosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_doceniajacy_tozsamosc FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic wschodnich', 'Zespół dzielnic śródmiejskich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_doceniajacy_tozsamosc\nZespół dzielnic śródmiejskich|30.52\nZespół dzielnic wschodnich|39.16"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the official 5-zone classification. Measures identity connection through strong agreement (6-7) with the cultural belonging statement, comparing the eastern and downtown zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "254",
            "inputs": "Jaki procent mieszkańców subregionu gliwickiego i tyskiego był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE subregion_metropolii_gzm IN ('GLIWICKI', 'TYSKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_ostatnio_kino\nGLIWICKI|49.68\nTYSKI|56.39"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison between two specific subregions based on recent cinema attendance."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "255",
            "inputs": "Porównaj odsetek osób, które ostatnio były w kinie, między próbą mieszkańców Katowic a próbą mieszkańców subregionu katowickiego (bez Katowic).",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'KATOWICKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_ostatnio_kino\nKATOWICE|62.89\nKATOWICKI|49.41"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Highlights the distinction between the dedicated Katowice city sample ('KATOWICE') and the broader Katowicki subregion ('KATOWICKI')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "256",
            "inputs": "Jaki procent mieszkańców Chorzowa i Zabrza był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat IN ('Chorzów', 'Zabrze') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_ostatnio_teatr\nZabrze|8.41\nChorzów|9.82"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Simple comparison of recent theatre attendance between two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "257",
            "inputs": "Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami miasta Gliwice a mieszkańcami powiatu gliwickiego.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE miasto_powiat IN ('Gliwice', 'Powiat gliwicki') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_ostatnio_muzeum\nGliwice|3.07\nPowiat gliwicki|0.97"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares a city ('Gliwice') with its surrounding county ('Powiat gliwicki'), using the `miasto_powiat` column for both."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "258",
            "inputs": "Jaki procent mieszkańców Czeladzi i Siewierza był ostatnio na pikniku/festynie?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Czeladź', 'Siewierz') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_ostatnio_piknik\nSiewierz|7.93\nCzeladź|16.55"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses `gmina_miejscowosc` to compare specific municipalities within the same county (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "259",
            "inputs": "Porównaj odsetek osób, które ostatnio były na koncercie, między mieszkańcami Giszowca i Osiedla Tysiąclecia w Katowicach.",
            "expected_output": {
                "sql_query": "SELECT dzielnica_katowic, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE dzielnica_katowic IN ('Giszowiec', 'Osiedle Tysiąclecia') GROUP BY dzielnica_katowic;",
                "result": "dzielnica_katowic|procent_ostatnio_koncert\nGiszowiec|15.0\nOsiedle Tysiąclecia|11.9"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison between two specific Katowice districts using `dzielnica_katowic`."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "260",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic północnych i południowych Katowic był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_kino, waga_proby, CASE WHEN dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') THEN 'Zespół dzielnic północnych' WHEN dzielnica_katowic IN ('Murcki', 'Piotrowice-Ochojec', 'Kostuchna', 'Zarzecze', 'Podlesie') THEN 'Zespół dzielnic południowych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic północnych', 'Zespół dzielnic południowych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_ostatnio_kino\nZespół dzielnic południowych|60.36\nZespół dzielnic północnych|56.31"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification of Katowice districts. Compares recent cinema attendance between the northern and southern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "261",
            "inputs": "Porównaj odsetek osób, które ostatnio były w bibliotece, między mieszkańcami subregionu sosnowieckiego a resztą GZM.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN subregion_metropolii_gzm = 'SOSNOWIECKI' THEN 'Subregion Sosnowiecki' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_biblioteka FROM participation_survey GROUP BY obszar;",
                "result": "obszar|procent_ostatnio_biblioteka\nSubregion Sosnowiecki|19.28\nReszta GZM|20.42"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares one specific subregion against all others combined."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "262",
            "inputs": "Jaki procent mieszkańców Bytomia i reszty GZM był ostatnio w domu kultury?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom' ELSE 'Reszta GZM' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_dom_kultury FROM participation_survey GROUP BY obszar;",
                "result": "obszar|procent_ostatnio_dom_kultury\nReszta GZM|5.56\nBytom|17.48"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares one specific city against all other GZM areas combined."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "263",
            "inputs": "Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami Knurowa a resztą powiatu gliwickiego.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN gmina_miejscowosc = 'Knurów' THEN 'Knurów' ELSE 'Reszta Powiatu Gliwickiego' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' GROUP BY obszar;",
                "result": "obszar|procent_ostatnio_kino\nReszta Powiatu Gliwickiego|41.95\nKnurów|38.16"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares one specific municipality against the rest of its county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "264",
            "inputs": "Jaki procent mieszkańców Śródmieścia Katowic i reszty Katowic był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN dzielnica_katowic = 'śródmieście' THEN 'Śródmieście' ELSE 'Reszta Katowic' END AS obszar, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Katowice' GROUP BY obszar;",
                "result": "obszar|procent_ostatnio_teatr\nŚródmieście|16.83\nReszta Katowic|10.97"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares the central district against all other districts of Katowice combined."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "265",
            "inputs": "Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami zespołu dzielnic śródmiejskich Katowic a resztą Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT ostatnio_muzeum, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' ELSE 'Reszta Katowic' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM KatowiceZones GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_ostatnio_muzeum\nZespół dzielnic śródmiejskich|13.38\nReszta Katowic|9.47"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification. Compares the downtown zone against all other Katowice districts combined."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "266",
            "inputs": "Jakie są średnie miesięczne wydatki na kulturę w regionie bytomskim i sosnowieckim GZM?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE subregion_metropolii_gzm IN ('BYTOMSKI', 'SOSNOWIECKI') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|srednie_wydatki_na_kulture\nBYTOMSKI|109.9\nSOSNOWIECKI|109.15"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison of average spending between two specific subregions."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "267",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Tychów i powiatu pszczyńskiego.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE miasto_powiat IN ('Tychy', 'Powiat pszczyński') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|srednie_wydatki_na_kulture\nTychy|105.73\nPowiat pszczyński|160.47"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares average spending between a city and a neighboring county, using `miasto_powiat`."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "268",
            "inputs": "Jakie są średnie miesięczne wydatki na kulturę w katowickich dzielnicach Ligota-Panewniki i Piotrowice-Ochojec?",
            "expected_output": {
                "sql_query": "SELECT dzielnica_katowic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM participation_survey WHERE dzielnica_katowic IN ('Ligota-Panewniki', 'Piotrowice - Ochojec') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY dzielnica_katowic;",
                "result": "dzielnica_katowic|srednie_wydatki_na_kulture\nLigota-Panewniki|123.73\nPiotrowice - Ochojec|134.18"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Direct comparison of average spending between two specific Katowice districts."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "269",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między zespołem dzielnic wschodnich i zachodnich Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT wydatki_na_kulture_kwota, waga_proby, CASE WHEN dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') THEN 'Zespół dzielnic wschodnich' WHEN dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Ligota-Panewniki', 'Brynów Część Wschodnia - Os. Zgrzebnioka') THEN 'Zespół dzielnic zachodnich' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_na_kulture FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic wschodnich', 'Zespół dzielnic zachodnich') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|srednie_wydatki_na_kulture\nZespół dzielnic zachodnich|105.49\nZespół dzielnic wschodnich|132.47"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification. Compares average spending between the eastern and western zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "270",
            "inputs": "Jaki procent mieszkańców Katowic i subregionu tyskiego zgadza się (ocena 6-7), że kultura jest dla wszystkich?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_dla_wszystkich FROM participation_survey WHERE subregion_metropolii_gzm IN ('KATOWICE', 'TYSKI') GROUP BY subregion_metropolii_gzm;",
                "result": "subregion_metropolii_gzm|procent_zgody_kultura_dla_wszystkich\nKATOWICE|45.92\nTYSKI|57.47"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares strong agreement (6-7) on a specific opinion between the Katowice city sample ('KATOWICE') and the Tyski subregion ('TYSKI'). SQL correctly reflects this specific comparison as per user instructions, no update needed."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "271",
            "inputs": "Porównaj odsetek osób zgadzających się (ocena 6-7), że konsumpcja kultury sprawia przyjemność, między mieszkańcami Sosnowca i Rudy Śląskiej.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_przyjemnosc FROM participation_survey WHERE miasto_powiat IN ('Sosnowiec', 'Ruda Śląska') GROUP BY miasto_powiat;",
                "result": "miasto_powiat|procent_zgody_kultura_przyjemnosc\nSosnowiec|30.91\nRuda Śląska|26.73"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares strong agreement (6-7) on a specific opinion between two specific cities."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "272",
            "inputs": "Jaki procent mieszkańców Koszutki i Wełnowca-Józefowca (Katowice) zgadza się (ocena 5-7), że działalność kulturalna podnosi atrakcyjność regionu?",
            "expected_output": {
                "sql_query": "SELECT dzielnica_katowic, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_atrakcyjnosc_regionu FROM participation_survey WHERE dzielnica_katowic IN ('Koszutka', 'Wełnowiec-Józefowiec') GROUP BY dzielnica_katowic;",
                "result": "dzielnica_katowic|procent_zgody_atrakcyjnosc_regionu\nWełnowiec-Józefowiec|70.83\nKoszutka|51.23"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares agreement (5-7) on a specific opinion between two specific Katowice districts."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "273",
            "inputs": "Porównaj odsetek osób zgadzających się (ocena 5-7), że dzięki kulturze można nawiązywać relacje, między zespołem dzielnic śródmiejskich i północnych Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZones AS ( SELECT opinia_kultura_relacje_miedzyludzkie, waga_proby, CASE WHEN dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') THEN 'Zespół dzielnic śródmiejskich' WHEN dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') THEN 'Zespół dzielnic północnych' ELSE 'Inne Zespoły' END AS zona_dzielnic FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IS NOT NULL ) SELECT zona_dzielnic, ROUND(SUM(CASE WHEN opinia_kultura_relacje_miedzyludzkie IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody_kultura_relacje FROM KatowiceZones WHERE zona_dzielnic IN ('Zespół dzielnic śródmiejskich', 'Zespół dzielnic północnych') GROUP BY zona_dzielnic;",
                "result": "zona_dzielnic|procent_zgody_kultura_relacje\nZespół dzielnic śródmiejskich|61.78\nZespół dzielnic północnych|61.16"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses the official 5-zone classification. Compares agreement (5-7) on a specific opinion between the downtown and northern zones."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "274",
            "inputs": "Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami Bytomia a mieszkańcami Tarnowskich Gór.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry' THEN 'Tarnowskie Góry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (miasto_powiat = 'Bytom') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_kino\nBytom (Miasto)|62.98\nTarnowskie Góry (Gmina)|32.86"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów administracyjnych: miasto na prawach powiatu (`miasto_powiat`='Bytom') z konkretną gminą (`gmina_miejscowosc`='Tarnowskie Góry') w ramach innego powiatu (`miasto_powiat`='Powiat tarnogórski'). Technicznie możliwe, ale metodologicznie porównuje całość (miasto) z częścią (gmina)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "275",
            "inputs": "Porównaj odsetek osób, które ostatnio były w kinie, między mieszkańcami katowickiej dzielnicy Piotrowice-Ochojec a mieszkańcami Mikołowa.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN dzielnica_katowic = 'Piotrowice - Ochojec' THEN 'Piotrowice-Ochojec (Dzielnica KTW)' WHEN gmina_miejscowosc = 'Mikołów' THEN 'Mikołów (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (dzielnica_katowic = 'Piotrowice - Ochojec') OR (gmina_miejscowosc = 'Mikołów') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_kino\nPiotrowice-Ochojec (Dzielnica KTW)|59.45\nMikołów (Gmina)|65.94"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: dzielnicę Katowic (`dzielnica_katowic`) z konkretną gminą (`gmina_miejscowosc`) w ramach powiatu (`miasto_powiat`='Powiat mikołowski'). Metodologicznie porównuje część miasta z całą gminą."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "276",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic południowych Katowic i mieszkańców Mysłowic był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneS AS ( SELECT ostatnio_teatr, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Murcki', 'Piotrowice - Ochojec', 'Zarzecze', 'Kostuchna', 'Podlesie') ) SELECT 'Zespół dzielnic południowych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM KatowiceZoneS UNION ALL SELECT 'Mysłowice (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Mysłowice';",
                "result": "lokalizacja|procent_ostatnio_teatr\nZespół dzielnic południowych KTW|16.16\nMysłowice (Miasto)|7.47"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje zagregowany zespół dzielnic Katowic (zdefiniowany przez `dzielnica_katowic`) z całym miastem na prawach powiatu (`miasto_powiat`='Mysłowice')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "277",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Śródmieścia Katowic a mieszkańcami powiatu mikołowskiego.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN dzielnica_katowic = 'śródmieście' THEN 'Śródmieście KTW (Dzielnica)' WHEN miasto_powiat = 'Powiat mikołowski' THEN 'Powiat Mikołowski' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (dzielnica_katowic = 'śródmieście') OR (miasto_powiat = 'Powiat mikołowski') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednie_wydatki\nŚródmieście KTW (Dzielnica)|137.28\nPowiat Mikołowski|151.03"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: dzielnicę Katowic (`dzielnica_katowic`) z całym powiatem (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "278",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic północnych Katowic i mieszkańców powiatu będzińskiego był ostatnio na koncercie?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneN AS ( SELECT ostatnio_koncert, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') ) SELECT 'Zespół dzielnic północnych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM KatowiceZoneN UNION ALL SELECT 'Powiat Będziński' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE miasto_powiat = 'Powiat będziński';",
                "result": "lokalizacja|procent_ostatnio_koncert\nZespół dzielnic północnych KTW|12.88\nPowiat Będziński|8.51"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje zagregowany zespół dzielnic Katowic (zdefiniowany przez `dzielnica_katowic`) z całym powiatem (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "279",
            "inputs": "Porównaj odsetek osób, które ostatnio były w muzeum, między mieszkańcami Gliwic (miasto) a mieszkańcami Bierunia (gmina).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń' THEN 'Bieruń (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE (miasto_powiat = 'Gliwice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Bieruń') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_muzeum\nBieruń (Gmina)|2.91\nGliwice (Miasto)|3.07"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów i różnych części GZM: miasto na prawach powiatu (`miasto_powiat`='Gliwice') z konkretną gminą (`gmina_miejscowosc`='Bieruń') w ramach innego powiatu (`miasto_powiat`='Powiat bieruńsko-lędziński')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "280",
            "inputs": "Jaki procent mieszkańców Chorzowa i mieszkańców Osiedla Tysiąclecia (Katowice) był ostatnio na pikniku/festynie?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Chorzów' THEN 'Chorzów (Miasto)' WHEN dzielnica_katowic = 'Osiedle Tysiąclecia' THEN 'Osiedle Tysiąclecia KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE (miasto_powiat = 'Chorzów') OR (dzielnica_katowic = 'Osiedle Tysiąclecia') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_piknik\nOsiedle Tysiąclecia KTW (Dzielnica)|56.0\nChorzów (Miasto)|67.39"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje całe miasto na prawach powiatu (`miasto_powiat`) z konkretną dzielnicą Katowic (`dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "281",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Sosnowca a mieszkańcami zespołu dzielnic wschodnich Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneE AS ( SELECT wydatki_na_kulture_kwota, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Zawodzie', 'Dąbrówka Mała', 'Szopienice-Burowiec', 'Janów - Nikiszowiec', 'Giszowiec') AND wydatki_na_kulture_kwota IS NOT NULL ) SELECT 'Sosnowiec (Miasto)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Zespół dzielnic wschodnich KTW' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM KatowiceZoneE;",
                "result": "lokalizacja|srednie_wydatki\nSosnowiec (Miasto)|113.83\nZespół dzielnic wschodnich KTW|132.47"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje całe miasto na prawach powiatu (`miasto_powiat`) z zagregowanym zespołem dzielnic Katowic (zdefiniowanym przez `dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "282",
            "inputs": "Jaki procent mieszkańców Knurowa i Czeladzi był ostatnio w bibliotece?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Knurów' THEN 'Knurów (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Czeladź' THEN 'Czeladź (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_biblioteka FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Knurów') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Czeladź') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_biblioteka\nKnurów (Gmina)|5.26\nCzeladź (Gmina)|20.93"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "283",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami powiatu gliwickiego i powiatu będzińskiego.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat IN ('Powiat gliwicki', 'Powiat będziński') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|srednie_wydatki\nPowiat będziński|99.17\nPowiat gliwicki|103.87"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Bezpośrednie porównanie dwóch powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "284",
            "inputs": "Jaki procent mieszkańców powiatu tarnogórskiego i mieszkańców Giszowca (Katowice) był ostatnio w domu kultury?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' THEN 'Powiat Tarnogórski' WHEN dzielnica_katowic = 'Giszowiec' THEN 'Giszowiec KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_dom_kultury FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski') OR (dzielnica_katowic = 'Giszowiec') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_dom_kultury\nPowiat Tarnogórski|8.45\nGiszowiec KTW (Dzielnica)|7.48"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje cały powiat (`miasto_powiat`) z konkretną dzielnicą Katowic (`dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "285",
            "inputs": "Porównaj odsetek osób, które zgadzają się (ocena 6-7), że kultura jest dla wszystkich, między mieszkańcami powiatu bieruńsko-lędzińskiego a mieszkańcami zespołu dzielnic śródmiejskich Katowic.",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneC AS ( SELECT opinia_kultura_dla_wszystkich, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('śródmieście', 'Os. Paderewskiego - Muchowiec', 'Koszutka', 'Bogucice') ) SELECT 'Powiat Bieruńsko-Lędziński' AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' UNION ALL SELECT 'Zespół dzielnic śródmiejskich KTW' AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM KatowiceZoneC;",
                "result": "lokalizacja|procent_zgody\nPowiat Bieruńsko-Lędziński|34.87\nZespół dzielnic śródmiejskich KTW|53.65"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje cały powiat (`miasto_powiat`) z zagregowanym zespołem dzielnic Katowic (zdefiniowanym przez `dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "286",
            "inputs": "Jaki procent mieszkańców miasta Zabrze i gminy Pyskowice był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Zabrze' THEN 'Zabrze (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pyskowice' THEN 'Pyskowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE (miasto_powiat = 'Zabrze') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pyskowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_kino\nZabrze (Miasto)|53.45\nPyskowice (Gmina)|46.99"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: miasto na prawach powiatu (`miasto_powiat`='Zabrze') z konkretną gminą (`gmina_miejscowosc`='Pyskowice') w ramach innego powiatu (`miasto_powiat`='Powiat gliwicki')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "287",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Rudy Śląskiej a mieszkańcami gminy Wyry (pow. mikołowski).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Ruda Śląska' THEN 'Ruda Śląska (Miasto)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Ruda Śląska') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednie_wydatki\nRuda Śląska (Miasto)|135.28\nWyry (Gmina)|79.55"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: miasto na prawach powiatu (`miasto_powiat`='Ruda Śląska') z konkretną gminą (`gmina_miejscowosc`='Wyry') w ramach innego powiatu (`miasto_powiat`='Powiat mikołowski')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "288",
            "inputs": "Jaki procent mieszkańców Dąbrowy Górniczej i mieszkańców dzielnicy Zawodzie w Katowicach był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Dąbrowa Górnicza' THEN 'Dąbrowa Górnicza (Miasto)' WHEN dzielnica_katowic = 'Zawodzie' THEN 'Zawodzie KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE (miasto_powiat = 'Dąbrowa Górnicza') OR (dzielnica_katowic = 'Zawodzie') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_teatr\nZawodzie KTW (Dzielnica)|6.96\nDąbrowa Górnicza (Miasto)|2.42"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje całe miasto na prawach powiatu (`miasto_powiat`) z konkretną dzielnicą Katowic (`dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "289",
            "inputs": "Porównaj odsetek osób, które zgadzają się (ocena 5-7), że kultura jest dla wszystkich, między mieszkańcami Tychów a mieszkańcami Lędzin",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Tychy' THEN 'Tychy (Miasto)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Lędziny' THEN 'Lędziny (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich IN ('5', '6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE (miasto_powiat = 'Tychy') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Lędziny') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_zgody\nTychy (Miasto)|79.17\nLędziny (Gmina)|67.52"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: miasto na prawach powiatu (`miasto_powiat`='Tychy') z konkretną gminą (`gmina_miejscowosc`='Lędziny') w ramach tego samego powiatu (`miasto_powiat`='Powiat bieruńsko-lędziński')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "290",
            "inputs": "Jaki procent mieszkańców Siemianowic Śląskich i mieszkańców dzielnicy Dąbrówka Mała (Katowice) był ostatnio na koncercie?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Siemianowice Śląskie' THEN 'Siemianowice Śląskie (Miasto)' WHEN dzielnica_katowic = 'Dąbrówka Mała' THEN 'Dąbrówka Mała KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE (miasto_powiat = 'Siemianowice Śląskie') OR (dzielnica_katowic = 'Dąbrówka Mała') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_koncert\nSiemianowice Śląskie (Miasto)|10.55\nDąbrówka Mała KTW (Dzielnica)|17.27"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje całe miasto na prawach powiatu (`miasto_powiat`) z konkretną dzielnicą Katowic (`dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "291",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Świętochłowic a mieszkańcami powiatu tarnogórskiego.",
            "expected_output": {
                "sql_query": "SELECT miasto_powiat, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat IN ('Świętochłowice', 'Powiat tarnogórski') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY miasto_powiat;",
                "result": "miasto_powiat|srednie_wydatki\nPowiat tarnogórski|78.03\nŚwiętochłowice|117.53"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z całym innym powiatem (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "292",
            "inputs": "Jaki procent mieszkańców Piekar Śląskich i mieszkańców Radzionkowa był ostatnio w muzeum?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Piekary Śląskie' THEN 'Piekary Śląskie (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków' THEN 'Radzionków (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE (miasto_powiat = 'Piekary Śląskie') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ostatnio_muzeum\nRadzionków (Gmina)|9.73\nPiekary Śląskie (Miasto)|7.34"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje jednostki z różnych poziomów: miasto na prawach powiatu (`miasto_powiat`='Piekary Śląskie') z konkretną gminą (`gmina_miejscowosc`='Radzionków') w ramach innego powiatu (`miasto_powiat`='Powiat tarnogórski')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "293",
            "inputs": "Porównaj odsetek osób, które zgadzają się (ocena 6-7), że konsumpcja kultury sprawia przyjemność, między mieszkańcami powiatu pszczyńskiego a mieszkańcami dzielnicy Murcki (Katowice).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' THEN 'Powiat Pszczyński' WHEN dzielnica_katowic = 'Murcki' THEN 'Murcki KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc IN ('6', '7 w pełni sie zgadzam') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zgody FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński') OR (dzielnica_katowic = 'Murcki') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_zgody\nPowiat Pszczyński|54.57\nMurcki KTW (Dzielnica)|24.06"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje cały powiat (`miasto_powiat`) z konkretną dzielnicą Katowic (`dzielnica_katowic`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "294",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic zachodnich Katowic i mieszkańców pobliskiego Chorzowa był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneW AS ( SELECT ostatnio_kino, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Załęska Hałda - Brynów Część Zachodnia', 'Ligota-Panewniki', 'Brynów Część Wschodnia - Os. Zgrzebnioka') ) SELECT 'Zespół dzielnic zachodnich KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM KatowiceZoneW UNION ALL SELECT 'Chorzów (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Chorzów';",
                "result": "lokalizacja|procent_ostatnio_kino\nZespół dzielnic zachodnich KTW|74.04\nChorzów (Miasto)|52.95"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje zagregowany zespół dzielnic Katowic (zdefiniowany przez `dzielnica_katowic`) z całym miastem na prawach powiatu (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "295",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Bobrownik i Psar.",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc IN ('Bobrowniki', 'Psary') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|srednie_wydatki\nBobrowniki|131.06\nPsary|39.13"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) w ramach tego samego powiatu (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "296",
            "inputs": "Jaki procent mieszkańców mniejszych miejscowości/gmin wiejskich uważa, że tradycja to kultura?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kultura_tradycja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tradycja_kultura FROM participation_survey WHERE gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice');",
                "result": "procent_tradycja_kultura\n85.91"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Agreguje dane dla wybranych gmin wiejskich (`gmina_miejscowosc`) na podstawie dostarczonej listy, aby odpowiedzieć na pytanie o 'mniejsze miejscowości'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "297",
            "inputs": "Porównaj średnią ocenę (1-7) istotności kultury między mieszkańcami Tychów a mieszkańcami gminy Kobiór.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Tychy' THEN 'Tychy (Miasto)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE (miasto_powiat = 'Tychy') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_istotnosc\nTychy (Miasto)|4.82\nKobiór (Gmina)|4.63"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z konkretną gminą wiejską (`gmina_miejscowosc`) w innym powiecie. Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "298",
            "inputs": "Jaki procent mieszkańców Zabrza i mieszkańców Zbrosławic odwiedza teatr przynajmniej raz w roku?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Zabrze' THEN 'Zabrze (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_rocznie FROM participation_survey WHERE (miasto_powiat = 'Zabrze') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_teatr_rocznie\nZabrze (Miasto)|14.38\nZbrosławice (Gmina)|0.0"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z konkretną gminą wiejską (`gmina_miejscowosc`) w innym powiecie, używając rocznej częstotliwości."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "299",
            "inputs": "Porównaj odsetek osób wskazujących 'wysokie ceny' jako barierę między mieszkańcami Dąbrowy Górniczej a mieszkańcami Mierzęcic.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Dąbrowa Górnicza' THEN 'Dąbrowa Górnicza (Miasto)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_wysokie_ceny = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_ceny FROM participation_survey WHERE (miasto_powiat = 'Dąbrowa Górnicza') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_ceny\nMierzęcice (Gmina)|71.07\nDąbrowa Górnicza (Miasto)|26.25"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z konkretną gminą wiejską (`gmina_miejscowosc`) w innym powiecie."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "300",
            "inputs": "Jaki procent mieszkańców mniejszych gmin wiejskich i mieszkańców Katowic korzysta z kultury online 'bardzo często' (ocena 7)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Mniejsze gminy wiejskie' WHEN miasto_powiat = 'Katowice' THEN 'Katowice (Miasto)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_online_czesto FROM participation_survey WHERE (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) OR (miasto_powiat = 'Katowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_online_czesto\nMniejsze gminy wiejskie|3.96\nKatowice (Miasto)|11.68"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Agreguje dane dla wybranych gmin wiejskich (`gmina_miejscowosc`) i porównuje z miastem Katowice (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "301",
            "inputs": "Porównaj średnią ocenę (1-7) dostępności kultury w GZM między mieszkańcami gminy Gierałtowice a mieszkańcami gminy Pilchowice.",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN ocena_dostepu_do_kultury_gzm = '1 całkowicie niewystarczający' THEN 1 WHEN ocena_dostepu_do_kultury_gzm = '2' THEN 2 WHEN ocena_dostepu_do_kultury_gzm = '3' THEN 3 WHEN ocena_dostepu_do_kultury_gzm = '4' THEN 4 WHEN ocena_dostepu_do_kultury_gzm = '5' THEN 5 WHEN ocena_dostepu_do_kultury_gzm = '6' THEN 6 WHEN ocena_dostepu_do_kultury_gzm = '7 w pełni wystarczający' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dostepu FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice') AND ocena_dostepu_do_kultury_gzm IS NOT NULL GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|srednia_ocena_dostepu\nGierałtowice|5.56\nPilchowice|3.36"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) w ramach tego samego powiatu (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "302",
            "inputs": "Jaki procent mieszkańców gminy Rudziniec i gminy Wyry odwiedza koncerty przynajmniej raz w roku?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_koncerty_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_koncerty_rocznie\nRudziniec (Gmina)|12.7\nWyry (Gmina)|30.37"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "303",
            "inputs": "Porównaj odsetek osób, które jako źródło informacji o kulturze wskazują plakaty, między mieszkańcami mniejszych miejscowości Ożarowice i Zbrosławice.",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN informacja_plakaty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_plakaty FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc IN ('Ożarowice', 'Zbrosławice') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_info_plakaty\nZbrosławice|28.84\nOżarowice|85.95"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) w ramach tego samego powiatu (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "304",
            "inputs": "Jaki procent mieszkańców gminy Chełm Śląski i gminy Bojszowy uważa, że gry komputerowe to kultura?",
            "expected_output": {
                "sql_query": "SELECT gmina_miejscowosc, ROUND(SUM(CASE WHEN kultura_gry_komputerowe = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_gry_kultura FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc IN ('Chełm Śląski', 'Bojszowy') GROUP BY gmina_miejscowosc;",
                "result": "gmina_miejscowosc|procent_gry_kultura\nChełm Śląski|73.59\nBojszowy|58.24"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) w ramach tego samego powiatu (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "305",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami Bytomia a mieszkańcami mniejszych miejscowości o charakterze wiejskim z GZM.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Bytom' THEN 'Bytom (Miasto)' WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Miejscowości i wsie' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Bytom') OR (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednie_wydatki\nMiejscowości i wsie|96.1\nBytom (Miasto)|118.96"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z zagregowaną grupą gmin wiejskich (`gmina_miejscowosc`) z różnych powiatów."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "306",
            "inputs": "Jaki procent mieszkańców Kobióra i Wyr odwiedza muzea przynajmniej raz w roku?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_muzea_rocznie\nWyry (Gmina)|16.44\nKobiór (Gmina)|41.32"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "307",
            "inputs": "Porównaj odsetek osób, które preferują wydarzenia o zasięgu miejskim, między mieszkańcami Gliwic a mieszkańcami sąsiedniej gminy Rudziniec.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN wydarzenie_miejskie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_preferuje_miejskie FROM participation_survey WHERE (miasto_powiat = 'Gliwice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_preferuje_miejskie\nGliwice (Miasto)|74.58\nRudziniec (Gmina)|31.62"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje miasto na prawach powiatu (`miasto_powiat`) z konkretną gminą wiejską (`gmina_miejscowosc`) w ramach jego powiatu."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "308",
            "inputs": "Jaki procent mieszkańców gminy Pilchowice i gminy Zbrosławice wskazuje 'problemy z dojazdem' jako barierę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_dojazd = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_dojazd FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_dojazd\nZbrosławice (Gmina)|2.15\nPilchowice (Gmina)|0.0"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "309",
            "inputs": "Porównaj średnią ocenę (1-7) istotności kultury między mieszkańcami Bobrownik a mieszkańcami gminy Chełma Śląskiego.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE ((miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski')) AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_istotnosc\nBobrowniki (Gmina)|3.7\nChełm Śląski (Gmina)|4.74"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "310",
            "inputs": "Jaki procent mieszkańców gmin Mierzęcice i Gierałtowice czyta książki dla przyjemności przynajmniej raz w roku?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_czyta_ksiazki_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_czyta_ksiazki_rocznie\nGierałtowice (Gmina)|65.51\nMierzęcice (Gmina)|35.89"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "311",
            "inputs": "Porównaj odsetek osób, które uważają, że 'uprawianie ogrodu' to kultura, między mieszkańcami gminy Psary a mieszkańcami gminy Ożarowice.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_ogrodnictwo = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_ogrod_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_ogrod_kultura\nPsary (Gmina)|82.62\nOżarowice (Gmina)|53.56"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "312",
            "inputs": "Jaki procent mieszkańców wsi i mieszkańców Chorzowa odwiedza filharmonię/operę przynajmniej raz na 3 lata?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice') THEN 'Miejscowości i wsie' WHEN miasto_powiat = 'Chorzów' THEN 'Chorzów (Miasto)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_filharmonia IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_filharmonia_3lata FROM participation_survey WHERE (gmina_miejscowosc IN ('Bobrowniki', 'Mierzęcice', 'Psary', 'Chełm Śląski', 'Gierałtowice', 'Pilchowice', 'Rudziniec', 'Wyry', 'Kobiór', 'Ożarowice', 'Zbrosławice')) OR (miasto_powiat = 'Chorzów') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_filharmonia_3lata\nMiejscowości i wsie|12.31\nChorzów (Miasto)|21.7"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje zagregowaną grupę gmin wiejskich (`gmina_miejscowosc`) z miastem na prawach powiatu (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "313",
            "inputs": "Porównaj średnią ocenę (1-7) wiedzy o ofercie kulturalnej GZM między ludźmi z Kobióra a ludźmi ze Zbrosławic.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN wiedza_o_ofercie_kulturalnej_gzm = '1 bardzo niska' THEN 1 WHEN wiedza_o_ofercie_kulturalnej_gzm = '2' THEN 2 WHEN wiedza_o_ofercie_kulturalnej_gzm = '3' THEN 3 WHEN wiedza_o_ofercie_kulturalnej_gzm = '4' THEN 4 WHEN wiedza_o_ofercie_kulturalnej_gzm = '5' THEN 5 WHEN wiedza_o_ofercie_kulturalnej_gzm = '6' THEN 6 WHEN wiedza_o_ofercie_kulturalnej_gzm = '7 bardzo wysoka' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_wiedzy FROM participation_survey WHERE ((miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice')) AND wiedza_o_ofercie_kulturalnej_gzm IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_ocena_wiedzy\nZbrosławice (Gmina)|1.96\nKobiór (Gmina)|3.89"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "314",
            "inputs": "Jaki procent mieszkańców gminy Rudziniec i gminy Psary jako źródło informacji o kulturze wskazuje znajomych/rodzinę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_znajomi_rodzina = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_znajomi FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_info_znajomi\nPsary (Gmina)|95.65\nRudziniec (Gmina)|57.48"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "315",
            "inputs": "Porównaj odsetek osób, które odwiedzają kino przynajmniej raz na 3 lata, między mieszkańcami gminy Pilchowice a mieszkańcami gminy Wyry (pow. mikołowski).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_kino IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_kino_3lata\nWyry (Gmina)|48.1\nPilchowice (Gmina)|64.49"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "316",
            "inputs": "Jaki procent mieszkańców gminy Gierałtowice i gminy Bobrowniki uważa, że 'moralność' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_moralnosc = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moralnosc_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_moralnosc_kultura\nBobrowniki (Gmina)|96.29\nGierałtowice (Gmina)|91.63"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "317",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami gminy Chełm Śląski a mieszkańcami gminy Mierzęcice (pow. będziński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednie_wydatki\nMierzęcice (Gmina)|105.36\nChełm Śląski (Gmina)|112.54"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "318",
            "inputs": "Jaki procent mieszkańców gminy Psary i gminy Kobiór wskazuje 'brak czasu' jako barierę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_czasu = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_czas FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_czas\nKobiór (Gmina)|28.07\nPsary (Gmina)|65.22"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "319",
            "inputs": "Porównaj odsetek osób, które odwiedzają pikniki/festyny przynajmniej raz w roku, między mieszkańcami gminy Ożarowice a mieszkańcami gminy Rudziniec (pow. gliwicki).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_pikniki_festyny_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_pikniki_festyny_rocznie\nOżarowice (Gmina)|62.92\nRudziniec (Gmina)|43.42"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "320",
            "inputs": "Jaki procent mieszkańców gminy Zbrosławice i gminy Pilchowice uważa, że 'taniec' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_taniec = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_taniec_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_taniec_kultura\nZbrosławice (Gmina)|100.0\nPilchowice (Gmina)|76.67"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "321",
            "inputs": "Porównaj średnią ocenę (1-7) stwierdzenia 'Działalność kulturalna jest dla wszystkich' między mieszkańcami gminy Wyry a mieszkańcami gminy Gierałtowice.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_dla_wszystkich = '2' THEN 2 WHEN opinia_kultura_dla_wszystkich = '3' THEN 3 WHEN opinia_kultura_dla_wszystkich = '4' THEN 4 WHEN opinia_kultura_dla_wszystkich = '5' THEN 5 WHEN opinia_kultura_dla_wszystkich = '6' THEN 6 WHEN opinia_kultura_dla_wszystkich = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_dla_wszystkich FROM participation_survey WHERE ((miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice')) AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_ocena_dla_wszystkich\nWyry (Gmina)|5.87\nGierałtowice (Gmina)|5.73"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "322",
            "inputs": "Jaki procent mieszkańców Bobrownik i Kobióra odwiedza galerie sztuki przynajmniej raz na 3 lata?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_galeria_sztuki IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_galeria_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_galeria_3lata\nBobrowniki (Gmina)|28.17\nKobiór (Gmina)|56.13"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "323",
            "inputs": "Porównaj odsetek osób, które jako źródło informacji o kulturze wskazują portale lokalne, między mieszkańcami gminy Mierzęcice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_portale_lokalne = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_portale_lokalne FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_info_portale_lokalne\nMierzęcice (Gmina)|20.89\nChełm Śląski (Gmina)|21.07"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "324",
            "inputs": "Jaki procent mieszkańców gminy Psary i gminy Pilchowice uważa, że 'muzyka rozrywkowa' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_muzyka_rozrywkowa = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzyka_rozryw_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_muzyka_rozryw_kultura\nPsary (Gmina)|100.0\nPilchowice (Gmina)|96.38"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "325",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między mieszkańcami gminy Rudziniec a mieszkańcami gminy Ożarowice (pow. tarnogórski).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednie_wydatki\nRudziniec (Gmina)|99.01\nOżarowice (Gmina)|48.92"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "326",
            "inputs": "Jaki procent mieszkańców gminy Wyry i gminy Zbrosławice wskazuje 'brak oferty lokalnej' jako barierę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_oferty_lokalnej = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_lokalna FROM participation_survey WHERE (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_lokalna\nZbrosławice (Gmina)|8.9\nWyry (Gmina)|0.0"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "327",
            "inputs": "Porównaj odsetek osób, które odwiedzają domy kultury przynajmniej raz w roku, między mieszkańcami gminy Kobiór a mieszkańcami gminy Gierałtowice (pow. gliwicki).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_dom_kultury_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_dom_kultury_rocznie\nKobiór (Gmina)|50.52\nGierałtowice (Gmina)|28.57"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "328",
            "inputs": "Jaki procent mieszkańców Bobrownik i Pilchowic uważa, że 'religia' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_religia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_religia_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_religia_kultura\nBobrowniki (Gmina)|84.06\nPilchowice (Gmina)|51.3"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "329",
            "inputs": "Porównaj średnią ocenę (1-7) stwierdzenia 'Konsumpcja kultury sprawia przyjemność' między Mierzęcicami a Wyrami.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosc FROM participation_survey WHERE ((miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry')) AND opinia_kultura_przyjemnosc IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_ocena_przyjemnosc\nMierzęcice (Gmina)|4.42\nWyry (Gmina)|5.97"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "330",
            "inputs": "Jaki procent mieszkańców Psar i Ożarowic wskazuje 'mało atrakcyjną ofertę' jako barierę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_nieatrakcyjna_oferta = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_oferta FROM participation_survey WHERE (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_oferta\nPsary (Gmina)|26.08\nOżarowice (Gmina)|20.78"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "331",
            "inputs": "Porównaj odsetek osób, które odwiedzają teatry przynajmniej raz na 3 lata, między mieszkańcami gminy Chełm Śląski a mieszkańcami gminy Rudziniec (pow. gliwicki).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_teatr IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_teatr_3lata\nRudziniec (Gmina)|16.04\nChełm Śląski (Gmina)|26.26"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "332",
            "inputs": "Jaki procent mieszkańców gminy Gierałtowice i gminy Zbrosławice uważa, że 'patriotyzm' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_patriotyzm = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_patriotyzm_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_patriotyzm_kultura\nZbrosławice (Gmina)|77.61\nGierałtowice (Gmina)|74.38"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "333",
            "inputs": "Porównaj średnią ocenę (1-7) stwierdzenia 'Bez dostępu do kultury życie byłoby uboższe' między mieszkańcami gminy Pilchowice a mieszkańcami gminy Kobiór (pow. pszczyński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_ubozsze_zycie = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_ubozsze_zycie = '2' THEN 2 WHEN opinia_kultura_ubozsze_zycie = '3' THEN 3 WHEN opinia_kultura_ubozsze_zycie = '4' THEN 4 WHEN opinia_kultura_ubozsze_zycie = '5' THEN 5 WHEN opinia_kultura_ubozsze_zycie = '6' THEN 6 WHEN opinia_kultura_ubozsze_zycie = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_ubozsze FROM participation_survey WHERE ((miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór')) AND opinia_kultura_ubozsze_zycie IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_ocena_ubozsze\nKobiór (Gmina)|5.16\nPilchowice (Gmina)|3.46"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "334",
            "inputs": "Jaki procent mieszkańców gminy Rudziniec i gminy Wyry jako źródło informacji o kulturze wskazuje radio?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec' THEN 'Rudziniec (Gmina)' WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN informacja_radio = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_info_radio FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Rudziniec') OR (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_info_radio\nRudziniec (Gmina)|8.47\nWyry (Gmina)|20.89"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "335",
            "inputs": "Porównaj odsetek osób, które odwiedzają zoo przynajmniej raz na 3 lata, między mieszkańcami gminy Ożarowice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_zoo IN ('Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat') THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zoo_3lata FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_zoo_3lata\nOżarowice (Gmina)|30.34\nChełm Śląski (Gmina)|57.86"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "336",
            "inputs": "Jaki procent mieszkańców gminy Zbrosławice i gminy Bobrowniki uważa, że 'telewizja' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice' THEN 'Zbrosławice (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki' THEN 'Bobrowniki (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_telewizja = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_tv_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Bobrowniki') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_tv_kultura\nBobrowniki (Gmina)|87.77\nZbrosławice (Gmina)|71.01"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "337",
            "inputs": "Porównaj średnią ocenę (1-7) stwierdzenia 'Wypada być na bieżąco z kulturą' między mieszkańcami gminy Kobiór a mieszkańcami gminy Mierzęcice (pow. będziński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' THEN 'Kobiór (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice' THEN 'Mierzęcice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN opinia_kultura_bycie_na_biezaco = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_bycie_na_biezaco = '2' THEN 2 WHEN opinia_kultura_bycie_na_biezaco = '3' THEN 3 WHEN opinia_kultura_bycie_na_biezaco = '4' THEN 4 WHEN opinia_kultura_bycie_na_biezaco = '5' THEN 5 WHEN opinia_kultura_bycie_na_biezaco = '6' THEN 6 WHEN opinia_kultura_bycie_na_biezaco = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_na_biezaco FROM participation_survey WHERE ((miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Mierzęcice')) AND opinia_kultura_bycie_na_biezaco IS NOT NULL GROUP BY lokalizacja;",
                "result": "lokalizacja|srednia_ocena_na_biezaco\nMierzęcice (Gmina)|4.57\nKobiór (Gmina)|4.88"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`). Konwertuje skalę na numeryczną."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "338",
            "inputs": "Jaki procent mieszkańców gminy Wyry i gminy Psary wskazuje 'niewystarczającą ilość informacji' jako barierę?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry' THEN 'Wyry (Gmina)' WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary' THEN 'Psary (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN bariera_brak_informacji = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_bariera_info FROM participation_survey WHERE (miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Wyry') OR (miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Psary') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_bariera_info\nPsary (Gmina)|13.04\nWyry (Gmina)|17.73"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "339",
            "inputs": "Porównaj odsetek osób, które oglądają nagrania sztuk teatralnych przynajmniej raz w roku, między mieszkańcami gminy Gierałtowice a mieszkańcami gminy Chełm Śląski (pow. bieruńsko-lędziński).",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice' THEN 'Gierałtowice (Gmina)' WHEN miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski' THEN 'Chełm Śląski (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN czestotliwosc_nagrania_teatralne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_nagrania_rocznie FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Gierałtowice') OR (miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Chełm Śląski') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_nagrania_rocznie\nChełm Śląski (Gmina)|5.34\nGierałtowice (Gmina)|24.63"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "340",
            "inputs": "Jaki procent mieszkańców gminy Pilchowice i gminy Ożarowice uważa, że 'fotografia' to kultura?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice' THEN 'Pilchowice (Gmina)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice' THEN 'Ożarowice (Gmina)' END AS lokalizacja, ROUND(SUM(CASE WHEN kultura_fotografia = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_foto_kultura FROM participation_survey WHERE (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Pilchowice') OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Ożarowice') GROUP BY lokalizacja;",
                "result": "lokalizacja|procent_foto_kultura\nOżarowice (Gmina)|76.78\nPilchowice (Gmina)|80.29"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje dwie gminy wiejskie (`gmina_miejscowosc`) należące do różnych powiatów (`miasto_powiat`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "341",
            "inputs": "Jakie środki transportu są najczęściej używane przez studentów w Katowicach?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE) SELECT transport_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Komunikacja miejska (autobus, tramwaj)' AS transport_type, transport_komunikacja_miejska AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Komunikacja regionalna (kolej)' AS transport_type, transport_komunikacja_regionalna AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Własny samochód' AS transport_type, transport_wlasny_samochod AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Własny rower' AS transport_type, transport_wlasny_rower AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Pojazd na minuty (rower, hulajnoga)' AS transport_type, transport_wspoldzielony AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Pieszo' AS transport_type, transport_pieszo AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE UNION ALL SELECT 'Inaczej' AS transport_type, transport_inny AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Katowice' AND zatrudnienie_student = TRUE ) subquery WHERE selected = TRUE GROUP BY transport_type ORDER BY percentage DESC;",
                "result": "transport_type|percentage\nKomunikacja miejska (autobus, tramwaj)|83.42\nPieszo|44.79\nWłasny rower|33.69\nKomunikacja regionalna (kolej)|29.43\nWłasny samochód|28.9\nPojazd na minuty (rower, hulajnoga)|11.24\nInaczej|1.52"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for transport modes (`transport_*` columns) among students in Katowice. Calculates percentage based on the total weight of students in Katowice."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "342",
            "inputs": "Jakie 3 formy kultury cyfrowej są najpopularniejsze wśród osób w wieku 30-39 lat w subregionie tyskim?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI') SELECT digital_form, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wydarzenia kulturalne online' AS digital_form, cyfrowa_kultura_wydarzenia_online AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Interaktywne wystawy' AS digital_form, cyfrowa_kultura_wystawy_interaktywne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Sztuka nowych mediów' AS digital_form, cyfrowa_kultura_nowe_media AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Podcasty' AS digital_form, cyfrowa_kultura_podcasty AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Social Media (YT/TikTok)' AS digital_form, cyfrowa_kultura_social_media AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Wsparcie finansowe artystów GZM' AS digital_form, cyfrowa_kultura_wsparcie_artystow AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Interaktywne instalacje dźwiękowe' AS digital_form, cyfrowa_kultura_instalacje_dzwiekowe AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Gry komputerowe i gaming' AS digital_form, cyfrowa_kultura_gry AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'VR / Immersja' AS digital_form, cyfrowa_kultura_vr AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Inne formy cyfrowe' AS digital_form, cyfrowa_kultura_inne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Żadne z wymienionych form' AS digital_form, cyfrowa_kultura_zadne AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' AND subregion_metropolii_gzm = 'TYSKI' ) subquery WHERE selected = TRUE GROUP BY digital_form ORDER BY percentage DESC LIMIT 3;",
                "result": "digital_form|percentage\nSocial Media (YT/TikTok)|44.16\nŻadne z wymienionych form|30.8\nGry komputerowe i gaming|20.62"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for digital culture forms (`cyfrowa_kultura_*` columns) for a specific age group in a specific subregion. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "343",
            "inputs": "Jaki jest rozkład deklarowanych niepełnosprawności wśród osób w wieku 60+?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '60 i więcej') SELECT disability_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wzrokowa' AS disability_type, niepelnosprawnosc_wzrok AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Słuchowa' AS disability_type, niepelnosprawnosc_sluch AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Ruchowa' AS disability_type, niepelnosprawnosc_ruch AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Inny typ' AS disability_type, niepelnosprawnosc_inna AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' UNION ALL SELECT 'Żadna z powyższych' AS disability_type, niepelnosprawnosc_zadna AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '60 i więcej' ) subquery WHERE selected = TRUE GROUP BY disability_type ORDER BY percentage DESC;",
                "result": "disability_type|percentage\nŻadna z powyższych|78.34\nRuchowa|14.74\nInny typ|4.79\nSłuchowa|3.51\nWzrokowa|3.29"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for disability types (`niepelnosprawnosc_*` columns) for the 60+ age group. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "344",
            "inputs": "Jak rozkłada się status zatrudnienia wśród osób z wykształceniem wyższym?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE wyksztalcenie = 'wyższe') SELECT employment_status, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Bezrobotny/nie pracuje/zajmuje się domem' AS employment_status, zatrudnienie_bezrobotny AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Zatrudniony/-a' AS employment_status, zatrudnienie_pracujacy AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Samozatrudniony/-a' AS employment_status, zatrudnienie_samozatrudniony AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Uczy się/studiuje' AS employment_status, zatrudnienie_student AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Rencista/-ka' AS employment_status, zatrudnienie_rencista AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' UNION ALL SELECT 'Emeryt/-ka' AS employment_status, zatrudnienie_emeryt AS selected, waga_proby FROM participation_survey WHERE wyksztalcenie = 'wyższe' ) subquery WHERE selected = TRUE GROUP BY employment_status ORDER BY percentage DESC;",
                "result": "employment_status|percentage\nZatrudniony/-a|78.3\nEmeryt/-ka|8.29\nSamozatrudniony/-a|8.29\nUczy się/studiuje|3.49\nBezrobotny/nie pracuje/zajmuje się domem|3.05\nRencista/-ka|1.34"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for employment statuses (`zatrudnienie_*` columns) for those with higher education. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "345",
            "inputs": "Jakie są główne sposoby dostępu do internetu w powiecie gliwickim?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki') SELECT access_method, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'W domu' AS access_method, internet_w_domu AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' UNION ALL SELECT 'W pracy' AS access_method, internet_w_pracy AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' UNION ALL SELECT 'W telefonie komórkowym' AS access_method, internet_w_telefonie AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Powiat gliwicki' ) subquery WHERE selected = TRUE GROUP BY access_method ORDER BY percentage DESC;",
                "result": "access_method|percentage\nW telefonie komórkowym|94.24\nW domu|81.08\nW pracy|52.25"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for internet access methods (`internet_*` columns) in a specific county. Calculates percentage based on the total weight of residents in that county."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "346",
            "inputs": "W jakich aktywnościach w domach kultury najczęściej uczestniczą mieszkańcy Sosnowca (którzy odwiedzili dom kultury)?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE) SELECT activity, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Spotkanie z artystą' AS activity, dom_kultury_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Odczyt / prelekcja' AS activity, dom_kultury_prelekcja AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Pokaz filmu' AS activity, dom_kultury_film AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Przedstawienie teatralne' AS activity, dom_kultury_teatr AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Koncert' AS activity, dom_kultury_koncert AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Wystawa' AS activity, dom_kultury_wystawa AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE UNION ALL SELECT 'Inne' AS activity, dom_kultury_inne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Sosnowiec' AND ostatnio_dom_kultury = TRUE ) subquery WHERE selected = TRUE GROUP BY activity ORDER BY percentage DESC;",
                "result": "activity|percentage\nKoncert|23.36\nPrzedstawienie teatralne|15.88\nWystawa|14.96\nInne|7.48\nSpotkanie z artystą|7.48\nPokaz filmu|7.48"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for community center activities (`dom_kultury_*` columns) among recent visitors in Sosnowiec. Calculates percentage based on the total weight of *those who visited*."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "347",
            "inputs": "Jakich ofert biblioteki (poza wypożyczaniem książek) najczęściej używają mieszkańcy Chorzowa (którzy odwiedzili bibliotekę)?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE) SELECT offer, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wypożyczanie innych rzeczy (np. filmów, gier)' AS offer, biblioteka_wypozyczanie_innych_rzeczy AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE UNION ALL SELECT 'Uczestnictwo w spotkaniu z artystą' AS offer, biblioteka_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE UNION ALL SELECT 'Uczestnictwo w odczycie / prelekcji' AS offer, biblioteka_prelekcja AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE UNION ALL SELECT 'Obejrzenie wystawy' AS offer, biblioteka_wystawa AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE UNION ALL SELECT 'Inny cel' AS offer, biblioteka_inne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Chorzów' AND ostatnio_biblioteka = TRUE ) subquery WHERE selected = TRUE GROUP BY offer ORDER BY percentage DESC;",
                "result": "offer|percentage\nUczestnictwo w spotkaniu z artystą|6.64\nObejrzenie wystawy|6.45\nWypożyczanie innych rzeczy (np. filmów, gier)|4.84\nUczestnictwo w odczycie / prelekcji|3.32\nInny cel|1.61"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for library activities (`biblioteka_*` columns, excluding book borrowing implicitly by not listing it) among recent visitors in Chorzów. Calculates percentage based on the total weight of *those who visited*."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "348",
            "inputs": "Jakie są 3 główne bariery uczestnictwa w kulturze dla osób o dochodach do 3500 zł netto w subregionie bytomskim?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI') SELECT bariera, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Wysokie ceny / koszty korzystania' AS bariera, bariera_wysokie_ceny AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Problemy z dojazdem / komunikacją' AS bariera, bariera_dojazd AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało atrakcyjna oferta tematyczna' AS bariera, bariera_nieatrakcyjna_oferta AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Niewystarczająca ilość informacji o ofercie' AS bariera, bariera_brak_informacji AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Trudności z fizycznym dostępem / bariery architektoniczne' AS bariera, bariera_dostep_fizyczny AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało dogodne godziny otwarcia instytucji' AS bariera, bariera_godziny_otwarcia AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Brak czasu / za dużo innych spraw na głowie' AS bariera, bariera_brak_czasu AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Opieka nad inną osobą/ osobą zależną' AS bariera, bariera_opieka AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Mało atrakcyjna jakościowa oferta' AS bariera, bariera_niska_jakosc AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Niska dostępność biletów/są szybko wykupywane' AS bariera, bariera_dostepnosc_biletow AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Moja miejscowość nie ma żadnej oferty kulturalnej' AS bariera, bariera_brak_oferty_lokalnej AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Nie znam oferty kulturalnej w mojej okolicy' AS bariera, bariera_nieznajomosc_oferty AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Inne problemy' AS bariera, bariera_inne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Żadne z powyższych barier' AS bariera, bariera_zadne AS selected, waga_proby FROM participation_survey WHERE przedzial_wynagrodzenia = 'do 3500 zł' AND subregion_metropolii_gzm = 'BYTOMSKI' ) subquery WHERE selected = TRUE GROUP BY bariera ORDER BY procent DESC LIMIT 3;",
                "result": "bariera|procent\nWysokie ceny / koszty korzystania|43.56\nBrak czasu / za dużo innych spraw na głowie|41.08\nProblemy z dojazdem / komunikacją|17.99"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for barriers (`bariera_*` columns) for a specific income group in a specific subregion. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "349",
            "inputs": "Z jakich źródeł informacji o kulturze korzystają najczęściej osoby, które odwiedziły teatr w ciągu ostatnich 6 miesięcy?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE ostatnio_teatr = TRUE) SELECT source, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Prasa drukowana' AS source, informacja_prasa_drukowana AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Plakaty/ogłoszenia/reklamy' AS source, informacja_plakaty AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Lokalne portale/strony' AS source, informacja_portale_lokalne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnopolskie portale/strony' AS source, informacja_portale_ogolnopolskie AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile instytucji w mediach społecznościowych' AS source, informacja_social_media_instytucje AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Profile twórców w mediach społecznościowych' AS source, informacja_social_media_tworcy AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne profile w mediach społecznościowych' AS source, informacja_social_media_inne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Od znajomych/rodziny' AS source, informacja_znajomi_rodzina AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Radio' AS source, informacja_radio AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Telewizja' AS source, informacja_telewizja AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Strony internetowe instytucji kultury' AS source, informacja_strony_instytucji AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Ogólnotematyczne strony internetowe' AS source, informacja_strony_ogolne AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Inne źródła' AS source, informacja_inne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Żadne z powyższych źródeł informacji' AS source, informacja_zadne_zrodla AS selected, waga_proby FROM participation_survey WHERE ostatnio_teatr = TRUE ) subquery WHERE selected = TRUE GROUP BY source ORDER BY percentage DESC;",
                "result": "source|percentage\nPlakaty/ogłoszenia/reklamy|59.65\nOd znajomych/rodziny|57.92\nLokalne portale/strony|56.84\nProfile instytucji w mediach społecznościowych|42.35\nStrony internetowe instytucji kultury|40.25\nOgólnopolskie portale/strony|34.36\nInne profile w mediach społecznościowych|30.91\nProfile twórców w mediach społecznościowych|28.96\nRadio|27.79\nTelewizja|24.65\nPrasa drukowana|20.73\nOgólnotematyczne strony internetowe|19.87\nŻadne z powyższych źródeł informacji|1.08\nInne źródła|0.79"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for information sources (`informacja_*` columns) for those who recently visited a theatre. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "350",
            "inputs": "Jakie aktywności twórcze podejmują najczęściej osoby, które często chodzą na koncerty (przynajmniej raz w roku)?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') SELECT aktywnosc_tworcza, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS procent FROM ( SELECT 'Gra na instrumencie' AS aktywnosc_tworcza, tworczosc_gra_na_instrumencie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Pisanie tekstów' AS aktywnosc_tworcza, tworczosc_pisanie_tekstow AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Robienie zdjęć' AS aktywnosc_tworcza, tworczosc_fotografia AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Rysowanie lub malowanie' AS aktywnosc_tworcza, tworczosc_rysowanie_malowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Szycie/haftowanie' AS aktywnosc_tworcza, tworczosc_szycie_haftowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Śpiewanie' AS aktywnosc_tworcza, tworczosc_spiew AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Komponowanie muzyki' AS aktywnosc_tworcza, tworczosc_komponowanie AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Inna twórczość' AS aktywnosc_tworcza, tworczosc_inna AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' UNION ALL SELECT 'Żadne z powyższych aktywności twórczych' AS aktywnosc_tworcza, tworczosc_zadna AS selected, waga_proby FROM participation_survey WHERE czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' ) subquery WHERE selected = TRUE GROUP BY aktywnosc_tworcza ORDER BY procent DESC;",
                "result": "aktywnosc_tworcza|procent\nŻadne z powyższych aktywności twórczych|28.25\nRobienie zdjęć|11.79\nRysowanie lub malowanie|4.93\nŚpiewanie|3.92\nGra na instrumencie|3.78\nSzycie/haftowanie|3.47\nPisanie tekstów|2.71\nInna twórczość|1.99\nKomponowanie muzyki|1.2"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for creative activities (`tworczosc_*` columns) for frequent concert attendees. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "351",
            "inputs": "Jaki procent segmentu 'Konsumenci Kultury Instytucjonalnej' odwiedził zarówno teatr, jak i muzeum w ciągu ostatniego roku?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' AND czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_i_muzeum_rocznie FROM participation_survey WHERE segment_uczestnika = 'Konsumenci Kultury Instytucjonalnej';",
                "result": "procent_teatr_i_muzeum_rocznie\n65.18"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates the percentage of the specific segment meeting BOTH conditions annually, using correct weighting."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "352",
            "inputs": "Jak różnią się średnie wydatki na kulturę między respondentami z wykształceniem wyższym a tymi z wykształceniem średnim?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wyksztalcenie IN ('wyższe', 'średnie') AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|srednie_wydatki\nśrednie|114.76\nwyższe|133.5"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares weighted average spending between two education levels."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "353",
            "inputs": "Jakie platformy cyfrowe (YouTube, FB, Instagram) są najczęściej używane do celów kulturalnych przez osoby w wieku 30-39 lat?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = '30-39') SELECT platform, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'YouTube' AS platform, kultura_online_youtube AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' UNION ALL SELECT 'Facebook' AS platform, kultura_online_facebook AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' UNION ALL SELECT 'Instagram' AS platform, kultura_online_instagram AS selected, waga_proby FROM participation_survey WHERE grupa_wiekowa = '30-39' ) subquery WHERE selected = TRUE GROUP BY platform ORDER BY percentage DESC;",
                "result": "platform|percentage\nFacebook|26.9\nYouTube|25.63\nInstagram|12.22"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Rewritten using UNION ALL to show independent usage percentage for each specified platform within the 30-39 age group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "354",
            "inputs": "Który subregion GZM ma najwyższy odsetek osób odwiedzających muzea (rocznie)?",
            "expected_output": {
                "sql_query": "SELECT subregion_metropolii_gzm, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE subregion_metropolii_gzm != 'Inny' AND czestotliwosc_muzeum IS NOT NULL GROUP BY subregion_metropolii_gzm ORDER BY procent_muzea_rocznie DESC LIMIT 1;",
                "result": "subregion_metropolii_gzm|procent_muzea_rocznie\nKATOWICE|28.22"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates weighted percentage of annual museum visitors per subregion and finds the maximum. Excludes 'Inny' subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "355",
            "inputs": "Jaka jest zależność między postrzeganą istotnością kultury a średnimi wydatkami na kulturę?",
            "expected_output": {
                "sql_query": "SELECT istotnosc_uczestnictwa_w_kulturze, ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 END), 0) AS poziom_istotnosci_num, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE istotnosc_uczestnictwa_w_kulturze IS NOT NULL AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY istotnosc_uczestnictwa_w_kulturze ORDER BY poziom_istotnosci_num;",
                "result": "istotnosc_uczestnictwa_w_kulturze|poziom_istotnosci_num|srednie_wydatki\n1 zupełnie nieistotne|96.0|76.93\n2|332.0|60.04\n3|1500.0|78.77\n6|3984.0|129.61\n4|4516.0|95.74\n7 bardzo istotne|5019.0|167.85\n5|6465.0|114.59"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Shows weighted average spending for each level of perceived cultural importance. Handles Likert scale conversion correctly."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "356",
            "inputs": "Ilu respondentów (ważona liczba) napotykających bariery transportowe mimo to regularnie uczestniczy w wydarzeniach kulturalnych (muzeum lub teatr przynajmniej raz w roku)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN bariera_dojazd = TRUE AND (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' OR czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') THEN waga_proby ELSE 0 END)) AS liczba_wazona_aktywnych_mimo_barier FROM participation_survey;",
                "result": "liczba_wazona_aktywnych_mimo_barier\n250.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates the weighted sum of respondents meeting both barrier and participation criteria."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "357",
            "inputs": "Jaki jest przybliżony średni wiek respondentów uczestniczących w jakiejkolwiek formie kultury cyfrowej w porównaniu do tych, którzy nie uczestniczą?",
            "expected_output": {
                "sql_query": "WITH AgeMapping AS ( SELECT id_uczestnika, CASE grupa_wiekowa WHEN 'Mniej niż 30' THEN 25 WHEN '30-39' THEN 34.5 WHEN '40-49' THEN 44.5 WHEN '50-59' THEN 54.5 WHEN '60 i więcej' THEN 65 END AS mid_age, waga_proby FROM participation_survey ), DigitalParticipation AS ( SELECT id_uczestnika, ( cyfrowa_kultura_wydarzenia_online = TRUE OR cyfrowa_kultura_wystawy_interaktywne = TRUE OR cyfrowa_kultura_nowe_media = TRUE OR cyfrowa_kultura_podcasty = TRUE OR cyfrowa_kultura_social_media = TRUE OR cyfrowa_kultura_wsparcie_artystow = TRUE OR cyfrowa_kultura_instalacje_dzwiekowe = TRUE OR cyfrowa_kultura_gry = TRUE OR cyfrowa_kultura_vr = TRUE OR cyfrowa_kultura_inne = TRUE ) AS uczestniczy_cyfrowo FROM participation_survey ) SELECT dp.uczestniczy_cyfrowo, ROUND(SUM(am.mid_age * am.waga_proby) / SUM(am.waga_proby), 1) AS sredni_wiek FROM AgeMapping am JOIN DigitalParticipation dp ON am.id_uczestnika = dp.id_uczestnika GROUP BY dp.uczestniczy_cyfrowo;",
                "result": "uczestniczy_cyfrowo|sredni_wiek\nFalse|48.5\nTrue|40.6"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares weighted average age (using mid-point approximation) between those engaging in ANY digital culture form vs. those engaging in none."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "358",
            "inputs": "Wśród respondentów z problemami ruchowymi, jak różnią się ogólne opinie o kulturze (np. średnia ocena jej wpływu na atrakcyjność regionu) między osobami, które ostatnio odwiedziły teatr, a tymi, które odwiedziły muzeum?",
            "expected_output": {
                "sql_query": "WITH MobilityGroup AS ( SELECT ostatnio_teatr, ostatnio_muzeum, opinia_kultura_atrakcyjnosc_regionu, waga_proby FROM participation_survey WHERE niepelnosprawnosc_ruch = TRUE AND opinia_kultura_atrakcyjnosc_regionu IS NOT NULL ) SELECT 'Odwiedzający Teatr (z probl. ruch.)' AS grupa, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_atrakcyjnosc_regionu = '2' THEN 2 WHEN opinia_kultura_atrakcyjnosc_regionu = '3' THEN 3 WHEN opinia_kultura_atrakcyjnosc_regionu = '4' THEN 4 WHEN opinia_kultura_atrakcyjnosc_regionu = '5' THEN 5 WHEN opinia_kultura_atrakcyjnosc_regionu = '6' THEN 6 WHEN opinia_kultura_atrakcyjnosc_regionu = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_atrakcyjnosci FROM MobilityGroup WHERE ostatnio_teatr = TRUE UNION ALL SELECT 'Odwiedzający Muzeum (z probl. ruch.)' AS grupa, ROUND(SUM(CASE WHEN opinia_kultura_atrakcyjnosc_regionu = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_atrakcyjnosc_regionu = '2' THEN 2 WHEN opinia_kultura_atrakcyjnosc_regionu = '3' THEN 3 WHEN opinia_kultura_atrakcyjnosc_regionu = '4' THEN 4 WHEN opinia_kultura_atrakcyjnosc_regionu = '5' THEN 5 WHEN opinia_kultura_atrakcyjnosc_regionu = '6' THEN 6 WHEN opinia_kultura_atrakcyjnosc_regionu = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_atrakcyjnosci FROM MobilityGroup WHERE ostatnio_muzeum = TRUE;",
                "result": "grupa|srednia_ocena_atrakcyjnosci\nOdwiedzający Teatr (z probl. ruch.)|5.53\nOdwiedzający Muzeum (z probl. ruch.)|5.82"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Rewritten to compare a proxy opinion (attractiveness of region) between groups defined by recent visits to different institution types (theatre vs museum) within the mobility-impaired subset. Handles Likert scale."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "359",
            "inputs": "Jak rozkłada się preferencja skali wydarzeń kulturalnych (procentowo) w różnych grupach wiekowych?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT grupa_wiekowa, SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa IS NOT NULL GROUP BY grupa_wiekowa) SELECT p.grupa_wiekowa, sub.preference_type, ROUND(SUM(CASE WHEN sub.selected = TRUE THEN p.waga_proby ELSE 0 END) * 100.0 / MAX(twt.total), 2) AS percentage FROM participation_survey p JOIN ( SELECT id_uczestnika, 'Dzielnicowe' AS preference_type, wydarzenie_dzielnicowe AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Miejskie' AS preference_type, wydarzenie_miejskie AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Regionalne' AS preference_type, wydarzenie_regionalne AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Ogólnopolskie' AS preference_type, wydarzenie_ogolnopolskie AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Międzynarodowe' AS preference_type, wydarzenie_miedzynarodowe AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Niezależne od podziałów admin.' AS preference_type, wydarzenie_niezalezne AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Trudno powiedzieć' AS preference_type, wydarzenie_brak_opinii AS selected FROM participation_survey ) sub ON p.id_uczestnika = sub.id_uczestnika JOIN total_weight_target twt ON p.grupa_wiekowa = twt.grupa_wiekowa WHERE sub.selected = TRUE AND p.grupa_wiekowa IS NOT NULL GROUP BY p.grupa_wiekowa, sub.preference_type ORDER BY p.grupa_wiekowa, percentage DESC;",
                "result": "grupa_wiekowa|preference_type|percentage\n30-39|Miejskie|57.48\n30-39|Regionalne|27.11\n30-39|Dzielnicowe|19.63\n30-39|Trudno powiedzieć|16.21\n30-39|Niezależne od podziałów admin.|15.8\n30-39|Ogólnopolskie|13.36\n30-39|Międzynarodowe|3.04\n40-49|Miejskie|55.88\n40-49|Regionalne|26.31\n40-49|Dzielnicowe|20.96\n40-49|Trudno powiedzieć|19.93\n40-49|Niezależne od podziałów admin.|14.42\n40-49|Ogólnopolskie|11.04\n40-49|Międzynarodowe|3.73\n50-59|Miejskie|62.04\n50-59|Regionalne|24.81\n50-59|Dzielnicowe|21.25\n50-59|Trudno powiedzieć|17.79\n50-59|Niezależne od podziałów admin.|13.67\n50-59|Ogólnopolskie|10.83\n50-59|Międzynarodowe|2.46\n60 i więcej|Miejskie|59.67\n60 i więcej|Dzielnicowe|22.17\n60 i więcej|Trudno powiedzieć|19.26\n60 i więcej|Regionalne|17.16\n60 i więcej|Niezależne od podziałów admin.|12.04\n60 i więcej|Ogólnopolskie|6.46\n60 i więcej|Międzynarodowe|2.16\nMniej niż 30|Miejskie|62.34\nMniej niż 30|Regionalne|30.55\nMniej niż 30|Dzielnicowe|25.26\nMniej niż 30|Niezależne od podziałów admin.|15.97\nMniej niż 30|Ogólnopolskie|15.71\nMniej niż 30|Trudno powiedzieć|11.86\nMniej niż 30|Międzynarodowe|4.69"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Rewritten using UNION ALL to calculate the percentage preferring each event scale type independently within each age group. Denominator correctly calculated per age group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "360",
            "inputs": "Jak częstotliwość uczestnictwa w kulturze (np. muzea, teatr) koreluje z posiadaniem dostępu do internetu w domu?",
            "expected_output": {
                "sql_query": "SELECT internet_w_domu, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie, ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_teatr_rocznie FROM participation_survey WHERE internet_w_domu IS NOT NULL GROUP BY internet_w_domu;",
                "result": "internet_w_domu|procent_muzea_rocznie|procent_teatr_rocznie\nFalse|3.55|3.05\nTrue|21.94|15.3"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates weighted percentages for annual museum and theatre attendance, grouped by home internet access."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "361",
            "inputs": "Jaki procent respondentów o wysokich dochodach (powyżej 9000 zł) wspiera finansowo artystów z GZM (poprzez platformy cyfrowe)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN cyfrowa_kultura_wsparcie_artystow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_wspierajacych_artystow FROM participation_survey WHERE przedzial_wynagrodzenia = 'powyżej 9000 zł';",
                "result": "procent_wspierajacych_artystow\n10.7"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates weighted percentage for a specific digital behavior within a specific income group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "362",
            "inputs": "Jak różnią się używane środki transportu (procentowo) między osobami często (rocznie) i rzadziej odwiedzającymi muzea?",
            "expected_output": {
                "sql_query": "WITH ParticipationGroup AS ( SELECT id_uczestnika, CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Często (Muzeum rocznie)' ELSE 'Rzadziej (Muzeum < 1/rok)' END AS participation_freq FROM participation_survey WHERE czestotliwosc_muzeum IS NOT NULL ), total_weight_target AS ( SELECT pg.participation_freq, SUM(p.waga_proby) AS total FROM participation_survey p JOIN ParticipationGroup pg ON p.id_uczestnika = pg.id_uczestnika GROUP BY pg.participation_freq ) SELECT pg.participation_freq, sub.transport_type, ROUND(SUM(CASE WHEN sub.selected = TRUE THEN p.waga_proby ELSE 0 END) * 100.0 / MAX(twt.total), 2) AS percentage FROM participation_survey p JOIN ( SELECT id_uczestnika, 'Komunikacja miejska' AS transport_type, transport_komunikacja_miejska AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Własny samochód' AS transport_type, transport_wlasny_samochod AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Pieszo' AS transport_type, transport_pieszo AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Komunikacja regionalna' AS transport_type, transport_komunikacja_regionalna AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Własny rower' AS transport_type, transport_wlasny_rower AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Transport współdzielony' AS transport_type, transport_wspoldzielony AS selected FROM participation_survey UNION ALL SELECT id_uczestnika, 'Inny' AS transport_type, transport_inny AS selected FROM participation_survey ) sub ON p.id_uczestnika = sub.id_uczestnika JOIN ParticipationGroup pg ON p.id_uczestnika = pg.id_uczestnika JOIN total_weight_target twt ON pg.participation_freq = twt.participation_freq WHERE sub.selected = TRUE GROUP BY pg.participation_freq, sub.transport_type ORDER BY pg.participation_freq, percentage DESC;",
                "result": "participation_freq|transport_type|percentage\nCzęsto (Muzeum rocznie)|Własny samochód|65.42\nCzęsto (Muzeum rocznie)|Komunikacja miejska|50.31\nCzęsto (Muzeum rocznie)|Pieszo|46.12\nCzęsto (Muzeum rocznie)|Własny rower|24.18\nCzęsto (Muzeum rocznie)|Komunikacja regionalna|11.88\nCzęsto (Muzeum rocznie)|Transport współdzielony|5.75\nCzęsto (Muzeum rocznie)|Inny|0.72\nRzadziej (Muzeum < 1/rok)|Własny samochód|53.49\nRzadziej (Muzeum < 1/rok)|Komunikacja miejska|50.68\nRzadziej (Muzeum < 1/rok)|Pieszo|45.93\nRzadziej (Muzeum < 1/rok)|Własny rower|16.62\nRzadziej (Muzeum < 1/rok)|Komunikacja regionalna|8.46\nRzadziej (Muzeum < 1/rok)|Transport współdzielony|2.6\nRzadziej (Muzeum < 1/rok)|Inny|1.07"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Rewritten using UNION ALL to show percentage using each transport mode within frequent vs occasional museum-goer groups. Defines frequency based on annual visits."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "363",
            "inputs": "Jaka jest średnia liczba różnych aktywności kulturalnych (mierzona roczną frekwencją), w których uczestniczy każda grupa segmentu?",
            "expected_output": {
                "sql_query": "WITH AnnualParticipation AS ( SELECT id_uczestnika, waga_proby, segment_uczestnika, ( (czestotliwosc_galeria_sztuki = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_prasa_kulturalna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_nagrania_teatralne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_programy_kulturalne = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_wyklady = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_wydarzenia_literackie = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_archiwa = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_czytanie_ksiazek = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_zoo = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_piknik = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_festyn = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_dom_kultury = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_rekonstrukcja_historyczna = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int + (czestotliwosc_filharmonia = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy')::int ) AS num_annual_activities FROM participation_survey WHERE segment_uczestnika IS NOT NULL ) SELECT segment_uczestnika, ROUND(SUM(num_annual_activities * waga_proby) / SUM(waga_proby), 2) AS srednia_liczba_aktywnosci_rocznie FROM AnnualParticipation GROUP BY segment_uczestnika ORDER BY srednia_liczba_aktywnosci_rocznie DESC;",
                "result": "segment_uczestnika|srednia_liczba_aktywnosci_rocznie\nKonsumenci Kultury Instytucjonalnej|13.11\nZdobywcy Wiedzy|9.89\nAspirujący Mainstream|8.18\nSensualni|5.66\nMłodzi Uciekinierzy|5.39\nPoprawni Konformiści|4.89\nPrzymusowi Domatorzy|4.61\nLudowi Tradycjonaliści|2.72\nWycofani|2.0"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates weighted average number of distinct activities participated in annually (based on all `czestotliwosc_*` columns) per segment. Uses boolean-to-integer casting sum."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "364",
            "inputs": "Które grupy demograficzne (wiek, wykształcenie) najczęściej występują wśród osób o wysokich wydatkach na kulturę (250 zł i więcej miesięcznie)?",
            "expected_output": {
                "sql_query": "WITH HighSpenders AS ( SELECT grupa_wiekowa, wyksztalcenie, waga_proby FROM participation_survey WHERE wydatki_na_kulture_kategoria = '250 i więcej' ), TotalHighSpendersWeight AS ( SELECT SUM(waga_proby) AS total FROM HighSpenders ) SELECT grupa_wiekowa, wyksztalcenie, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalHighSpendersWeight), 2) AS procent_wsrod_wydajacych_duzo FROM HighSpenders GROUP BY grupa_wiekowa, wyksztalcenie ORDER BY procent_wsrod_wydajacych_duzo DESC;",
                "result": "grupa_wiekowa|wyksztalcenie|procent_wsrod_wydajacych_duzo\n40-49|średnie|14.46\n40-49|wyższe|12.02\nMniej niż 30|średnie|10.62\n30-39|wyższe|9.82\n30-39|średnie|9.72\n50-59|wyższe|7.35\nMniej niż 30|niższe niż średnie|7.09\n50-59|średnie|5.13\nMniej niż 30|wyższe|4.25\n40-49|niższe niż średnie|4.18\n60 i więcej|średnie|4.12\n50-59|niższe niż średnie|3.89\n30-39|niższe niż średnie|3.86\n60 i więcej|wyższe|3.33\n60 i więcej|niższe niż średnie|0.14"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identifies high spenders based on the highest category '250 i więcej'. Calculates the weighted percentage distribution of age and education groups *within* this high-spending group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "365",
            "inputs": "Jak uczestnictwo w kulturze i jej postrzeganie (np. średnia ocena przyjemności, odsetek odwiedzających muzea rocznie) różni się między rodzicami małych dzieci a pozostałymi osobami?",
            "expected_output": {
                "sql_query": "SELECT opieka_nad_dzieckiem AS ma_dzieci_ponizej_13, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci, ROUND(SUM(CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_muzea_rocznie FROM participation_survey WHERE opieka_nad_dzieckiem IS NOT NULL GROUP BY opieka_nad_dzieckiem;",
                "result": "ma_dzieci_ponizej_13|srednia_ocena_przyjemnosci|procent_muzea_rocznie\nFalse|4.75|19.86\nTrue|4.96|22.38"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares weighted average enjoyment rating and weighted percentage of annual museum attendance between parents of young children and others. Handles Likert scale."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "366",
            "inputs": "Jaki procent mieszkańców GZM słyszało o określeniu Górnośląsko-Zagłębiowska Metropolia?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN znajomosc_metropolii_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_znajacych_termin FROM participation_survey;",
                "result": "procent_znajacych_termin\n70.14"
            },
            "metadata": {
                "complexity": "low",
                "ambiguity_note": "Uses the rarely touched 'znajomosc_metropolii_gzm' field."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "367",
            "inputs": "Jak ogólne opinie o kulturze (np. średnia ocena przyjemności, poczucia uboższego życia bez kultury) różnią się w zależności od grupy dochodowej?",
            "expected_output": {
                "sql_query": "SELECT przedzial_wynagrodzenia, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci, ROUND(SUM(CASE WHEN opinia_kultura_ubozsze_zycie = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_ubozsze_zycie = '2' THEN 2 WHEN opinia_kultura_ubozsze_zycie = '3' THEN 3 WHEN opinia_kultura_ubozsze_zycie = '4' THEN 4 WHEN opinia_kultura_ubozsze_zycie = '5' THEN 5 WHEN opinia_kultura_ubozsze_zycie = '6' THEN 6 WHEN opinia_kultura_ubozsze_zycie = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_ubozsze_zycie FROM participation_survey WHERE przedzial_wynagrodzenia NOT IN ('nie wiem, trudno powiedzieć', 'odmowa odpowiedzi') AND przedzial_wynagrodzenia IS NOT NULL GROUP BY przedzial_wynagrodzenia ORDER BY CASE przedzial_wynagrodzenia WHEN 'do 3500 zł' THEN 1 WHEN '3501 - 4000 zł' THEN 2 WHEN '4001 - 4500 zł' THEN 3 WHEN '4501 - 5000 zł' THEN 4 WHEN '5001 - 6000 zł' THEN 5 WHEN '6001 - 7000 zł' THEN 6 WHEN '7001 - 8000 zł' THEN 7 WHEN '8001 - 9000 zł' THEN 8 WHEN 'powyżej 9000 zł' THEN 9 ELSE 10 END;",
                "result": "przedzial_wynagrodzenia|srednia_ocena_przyjemnosci|srednia_ocena_ubozsze_zycie\ndo 3500 zł|4.73|4.39\n3501 - 4000 zł|4.86|4.62\n4001 - 4500 zł|4.95|4.55\n4501 - 5000 zł|5.13|4.65\n5001 - 6000 zł|5.02|4.72\n6001 - 7000 zł|5.33|4.86\n7001 - 8000 zł|5.25|4.78\n8001 - 9000 zł|5.19|5.26\npowyżej 9000 zł|5.43|5.2"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates weighted average ratings for two opinion scales across income brackets. Handles Likert scales and orders income brackets logically."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "368",
            "inputs": "Jak konsumpcja kultury cyfrowej (średnia częstotliwość online, odsetek używających VR) różni się między mieszkańcami miast i wsi?",
            "expected_output": {
                "sql_query": "SELECT wielkosc_miejscowosci, ROUND(SUM(CASE WHEN czestotliwosc_kultura_online = '1 bardzo rzadko lub wcale' THEN 1 WHEN czestotliwosc_kultura_online = '2' THEN 2 WHEN czestotliwosc_kultura_online = '3' THEN 3 WHEN czestotliwosc_kultura_online = '4' THEN 4 WHEN czestotliwosc_kultura_online = '5' THEN 5 WHEN czestotliwosc_kultura_online = '6' THEN 6 WHEN czestotliwosc_kultura_online = '7 bardzo często' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_czestotliwosc_online, ROUND(SUM(CASE WHEN cyfrowa_kultura_vr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_uzywa_vr FROM participation_survey WHERE wielkosc_miejscowosci IS NOT NULL GROUP BY wielkosc_miejscowosci ORDER BY wielkosc_miejscowosci;",
                "result": "wielkosc_miejscowosci|srednia_czestotliwosc_online|procent_uzywa_vr\nmiasto  poniżej 20 tys. mieszkańców|3.56|1.99\nmiasto 100 - 199 tys. mieszkańców|3.47|2.48\nmiasto 20 - 99 tys. mieszkańców|3.0|2.63\nmiasto powyżej 200 tys. mieszkańców|3.88|4.02\nwieś|3.13|2.82"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares weighted average online frequency and weighted percentage of VR users across different locality sizes. Handles Likert scale."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "369",
            "inputs": "Jaki jest związek między uczestnictwem w kulturze (mierzonym roczną aktywnością w muzeach) a postrzeganą jakością życia (średnia ocena poczucia sensu, przyjemności)?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN 'Aktywny w muzeach (rocznie)' ELSE 'Nieaktywny w muzeach (rocznie)' END AS uczestnictwo_muzea, ROUND(SUM(CASE WHEN opinia_kultura_sens_zycia = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_sens_zycia = '2' THEN 2 WHEN opinia_kultura_sens_zycia = '3' THEN 3 WHEN opinia_kultura_sens_zycia = '4' THEN 4 WHEN opinia_kultura_sens_zycia = '5' THEN 5 WHEN opinia_kultura_sens_zycia = '6' THEN 6 WHEN opinia_kultura_sens_zycia = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_sens_zycia, ROUND(SUM(CASE WHEN opinia_kultura_przyjemnosc = '1 zupełnie się nie zgadzam' THEN 1 WHEN opinia_kultura_przyjemnosc = '2' THEN 2 WHEN opinia_kultura_przyjemnosc = '3' THEN 3 WHEN opinia_kultura_przyjemnosc = '4' THEN 4 WHEN opinia_kultura_przyjemnosc = '5' THEN 5 WHEN opinia_kultura_przyjemnosc = '6' THEN 6 WHEN opinia_kultura_przyjemnosc = '7 w pełni sie zgadzam' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_ocena_przyjemnosci FROM participation_survey WHERE czestotliwosc_muzeum IS NOT NULL AND opinia_kultura_sens_zycia IS NOT NULL AND opinia_kultura_przyjemnosc IS NOT NULL GROUP BY uczestnictwo_muzea;",
                "result": "uczestnictwo_muzea|srednia_ocena_sens_zycia|srednia_ocena_przyjemnosci\nNieaktywny w muzeach (rocznie)|4.32|4.61\nAktywny w muzeach (rocznie)|5.13|5.57"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares weighted average ratings for life meaning and enjoyment proxies between active and inactive museum-goers. Handles Likert scales."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "370",
            "inputs": "Jaka kombinacja aktywności kulturalnych (roczna frekwencja: muzeum, teatr, koncert) jest najczęstsza (procentowo) wśród młodych profesjonalistów (30-39 lat, wyższe wykształcenie)?",
            "expected_output": {
                "sql_query": "WITH TargetGroup AS ( SELECT id_uczestnika, waga_proby, (czestotliwosc_muzeum = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS museum_yr, (czestotliwosc_teatr = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS theater_yr, (czestotliwosc_koncert = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy') AS concert_yr FROM participation_survey WHERE grupa_wiekowa = '30-39' AND wyksztalcenie = 'wyższe' ), TotalWeight AS ( SELECT SUM(waga_proby) AS total FROM TargetGroup ) SELECT museum_yr, theater_yr, concert_yr, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalWeight), 2) AS procent_kombinacji FROM TargetGroup GROUP BY museum_yr, theater_yr, concert_yr ORDER BY procent_kombinacji DESC;",
                "result": "museum_yr|theater_yr|concert_yr|procent_kombinacji\nFalse|False|False|31.62\nFalse|False|True|19.42\nTrue|True|True|16.02\nTrue|False|True|13.68\nTrue|False|False|8.69\nFalse|True|True|5.07\nFalse|True|False|2.82\nTrue|True|False|2.68"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identifies combinations of annual participation in three specific activities for the target demographic and calculates the weighted percentage for each combination."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "371",
            "inputs": "Jakie jest prawdopodobieństwo (w procentach), że osoba odwiedzająca teatr (przynajmniej raz na 3 lata) odwiedza również muzea (przynajmniej raz na 3 lata)?",
            "expected_output": {
                "sql_query": "WITH WeightedTheaterAttendeesTotal AS ( SELECT SUM(waga_proby) AS total_theater_weight FROM participation_survey WHERE czestotliwosc_teatr IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' ) ) SELECT ROUND( SUM(CASE WHEN czestotliwosc_muzeum IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' ) THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total_theater_weight FROM WeightedTheaterAttendeesTotal), 2) AS prawdopodobienstwo_procentowe FROM participation_survey WHERE czestotliwosc_teatr IN ( 'Przynajmniej raz w ciągu ostatnich 12 miesięcy', 'Dawniej niż w ciągu ostatnich 12 miesięcy, ale w ciągu ostatnich 3 lat' );",
                "result": "prawdopodobienstwo_procentowe\n75.32"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates the weighted conditional probability P(Museum | Theater) based on 3-year attendance frequencies."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "372",
            "inputs": "Jaki jest rozkład województw zamieszkania respondentów?",
            "expected_output": {
                "sql_query": "SELECT wojewodztwo, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wojewodztwo IS NOT NULL), 2) AS procent FROM participation_survey WHERE wojewodztwo IS NOT NULL GROUP BY wojewodztwo ORDER BY procent DESC;",
                "result": "wojewodztwo|procent\nśląskie|100.0"
            },
            "metadata": {
                "complexity": "low",
                "ambiguity_note": "Uses the rarely touched 'wojewodztwo' field to test basic distribution."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "373",
            "inputs": "Jaki procent osób z segmentu 'Sensualni' nigdy nie był w teatrze, ale chciałby pójść w przyszłości?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_teatr = 'Nigdy, ale chciał(a)bym w przyszłości' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_chcialby_isc FROM participation_survey WHERE segment_uczestnika = 'Sensualni' AND czestotliwosc_teatr IS NOT NULL;",
                "result": "procent_chcialby_isc\n34.38"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Targets a less common segment and a specific non-participation category ('Nigdy, ale...')."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "374",
            "inputs": "Ilu dokładnie respondentów (liczba rekordów) z Gliwic należy do grupy wiekowej 40-49 lat?",
            "expected_output": {
                "sql_query": "SELECT COUNT(id_uczestnika) AS liczba_rekordow FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND grupa_wiekowa = '40-49';",
                "result": "liczba_rekordow\n102"
            },
            "metadata": {
                "complexity": "low",
                "ambiguity_note": "Explicitly asks for raw count (liczba rekordów), testing the instruction to ignore weights in this specific case."
            },
            "evaluators": []
        },
        {
            "name": "375",
            "inputs": "Jaki procent mieszkańców GZM wymienia 'Spodek' jako którekolwiek ze swoich pierwszych trzech skojarzeń z miejscami kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN skojarzenia_miejsca_gzm_1_kategoria = 'Spodek' OR skojarzenia_miejsca_gzm_2_kategoria = 'Spodek' OR skojarzenia_miejsca_gzm_3_kategoria = 'Spodek' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_skojarzenie_spodek_top3 FROM participation_survey;",
                "result": ""
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Tests combining multiple association fields (*_1, *_2, *_3) with OR."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "376",
            "inputs": "Jaki procent 'Innych' barier uczestnictwa (odpowiedź tekstowa) wspomina o 'pandemii' lub 'covid'?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN LOWER(bariera_inne_tekst) LIKE '%pandemi%' OR LOWER(bariera_inne_tekst) LIKE '%covid%' THEN waga_proby ELSE 0 END) * 100.0 / SUM(CASE WHEN bariera_inne = TRUE THEN waga_proby ELSE 0 END), 2) AS procent_wspomnien_pandemii FROM participation_survey WHERE bariera_inne = TRUE AND bariera_inne_tekst IS NOT NULL;",
                "result": "procent_wspomnien_pandemii\n0.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Tests using LIKE on a text field (`bariera_inne_tekst`), calculating percentage within the subgroup that selected 'bariera_inne'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "377",
            "inputs": "Jaka jest średnia miesięczna kwota wydatków na kulturę w Będzinie?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki_bedzin FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Będzin' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": "srednie_wydatki_bedzin\n100.92"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Tests the MAP hint: User asks for 'Będzin' (city), query correctly uses 'Powiat będziński' (`miasto_powiat`) AND 'Będzin' (`gmina_miejscowosc`)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "378",
            "inputs": "Jaki procent osób korzystających z komunikacji miejskiej, ale NIE z komunikacji regionalnej (kolei), odwiedza miejsca kultury w innych miastach GZM?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN uczestnictwo_inne_miejsce_gzm = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kultura_inne_miasta FROM participation_survey WHERE transport_komunikacja_miejska = TRUE AND transport_komunikacja_regionalna = FALSE;",
                "result": "procent_kultura_inne_miasta\n19.77"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Tests combination filter (A=TRUE AND B=FALSE)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "379",
            "inputs": "Jaki jest rozkład kategorii dla 'Innych problemów' jako barier uczestnictwa (pokaż top 3)?",
            "expected_output": {
                "sql_query": "SELECT bariera_inne_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE bariera_inne = TRUE), 2) AS procent FROM participation_survey WHERE bariera_inne = TRUE AND bariera_inne_kategoria IS NOT NULL AND bariera_inne_kategoria NOT IN ('Inne', 'Nie wiem, trudno powiedzieć') GROUP BY bariera_inne_kategoria ORDER BY procent DESC LIMIT 3;",
                "result": "bariera_inne_kategoria|procent\nZdrowotne|36.8\nBrak chęci/zainteresowania|26.9\nWiek|7.8"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the 'bariera_inne_kategoria' field, calculating percentages within the group that selected 'bariera_inne'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "380",
            "inputs": "Jaki jest rozkład kategorii dla 'Innej twórczości' (pokaż top 3)?",
            "expected_output": {
                "sql_query": "SELECT tworczosc_inna_kategoria, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE tworczosc_inna = TRUE), 2) AS procent FROM participation_survey WHERE tworczosc_inna = TRUE AND tworczosc_inna_kategoria IS NOT NULL AND tworczosc_inna_kategoria NOT IN ('Inne', 'Nie wiem, trudno powiedzieć') GROUP BY tworczosc_inna_kategoria ORDER BY procent DESC LIMIT 3;",
                "result": "tworczosc_inna_kategoria|procent\nSzydełkowanie|10.68\nCzytanie|5.65\nPiszę wiersze|5.34"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the 'tworczosc_inna_kategoria' field, calculating percentages within the group that selected 'tworczosc_inna'."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "381",
            "inputs": "Jaki procent osób w GZM ma dostęp do internetu jednocześnie w domu, pracy i telefonie?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN internet_w_domu = TRUE AND internet_w_pracy = TRUE AND internet_w_telefonie = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_internet_wszedzie FROM participation_survey;",
                "result": "procent_internet_wszedzie\n61.93"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Checks the intersection of multiple boolean flags related to internet access."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "382",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między osobami z niepełnosprawnością słuchu LUB wzroku a osobami bez tych niepełnosprawności.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN niepelnosprawnosc_sluch = TRUE OR niepelnosprawnosc_wzrok = TRUE THEN 'Słuch LUB Wzrok' ELSE 'Bez tych niepełnosprawności' END AS grupa_niepelnosprawnosci, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE wydatki_na_kulture_kwota IS NOT NULL GROUP BY grupa_niepelnosprawnosci;",
                "result": "grupa_niepelnosprawnosci|srednie_wydatki\nSłuch LUB Wzrok|132.66\nBez tych niepełnosprawności|112.2"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses OR logic for grouping based on disability types and compares weighted average spending."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "383",
            "inputs": "Jaki procent mieszkańców Gliwic odwiedzających muzea w ciągu ostatnich 6 miesięcy odwiedziło Muzeum w Gliwicach?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN kategoria_odwiedzonego_muzeum = 'Muzeum w Gliwicach' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_odwiedzil_mgliwice_wsrod_odwiedzajacych FROM participation_survey WHERE miasto_powiat = 'Gliwice' AND ostatnio_muzeum = TRUE;",
                "result": "procent_odwiedzil_mgliwice_wsrod_odwiedzajacych\n28.47"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates percentage within a subgroup defined by recent museum visit AND location. Denominator correctly represents the total weight of recent museum visitors in Gliwice."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "384",
            "inputs": "Jaki procent osób 'zupełnie niezgadzających się' (ocena 1), że kultura jest dla wszystkich, występuje w grupie z wykształceniem podstawowym vs wyższym?",
            "expected_output": {
                "sql_query": "SELECT wyksztalcenie, ROUND(SUM(CASE WHEN opinia_kultura_dla_wszystkich = '1 zupełnie się nie zgadzam' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zupelnie_sie_nie_zgadza FROM participation_survey WHERE wyksztalcenie IN ('niższe niż średnie', 'wyższe') AND opinia_kultura_dla_wszystkich IS NOT NULL GROUP BY wyksztalcenie;",
                "result": "wyksztalcenie|procent_zupelnie_sie_nie_zgadza\nniższe niż średnie|3.9\nwyższe|1.29"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Filters for a specific Likert scale level (1) and compares its prevalence across education groups."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "385",
            "inputs": "Jaki jest pełny rozkład ocen (1-7) dla stwierdzenia 'Lubię poznawać nowe miejsca związane z kulturą' w subregionie tyskim?",
            "expected_output": {
                "sql_query": "SELECT opinia_kultura_nowe_miejsca, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND opinia_kultura_nowe_miejsca IS NOT NULL), 2) AS procent FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND opinia_kultura_nowe_miejsca IS NOT NULL GROUP BY opinia_kultura_nowe_miejsca ORDER BY CASE opinia_kultura_nowe_miejsca WHEN '1 zupełnie się nie zgadzam' THEN 1 WHEN '2' THEN 2 WHEN '3' THEN 3 WHEN '4' THEN 4 WHEN '5' THEN 5 WHEN '6' THEN 6 WHEN '7 w pełni sie zgadzam' THEN 7 ELSE 8 END;",
                "result": "opinia_kultura_nowe_miejsca|procent\n1 zupełnie się nie zgadzam|1.83\n2|2.47\n3|6.8\n4|20.22\n5|24.44\n6|18.39\n7 w pełni sie zgadzam|25.87"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Shows the weighted percentage distribution for all levels of a Likert scale within a specific subregion."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "386",
            "inputs": "Porównaj średnie miesięczne wydatki na kulturę między miastem Gliwice a wszystkimi gminami wiejskimi powiatu gliwickiego łącznie.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Gliwice' THEN 'Gliwice (Miasto)' WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice', 'Rudziniec', 'Sośnicowice') THEN 'Gminy Wiejskie Pow. Gliwicki' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Gliwice' OR (miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc IN ('Gierałtowice', 'Pilchowice', 'Rudziniec', 'Sośnicowice'))) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja HAVING lokalizacja IS NOT NULL;",
                "result": "lokalizacja|srednie_wydatki\nGminy Wiejskie Pow. Gliwicki|118.63\nGliwice (Miasto)|93.45"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares a city to an aggregation of specific rural municipalities within its associated county (excluding towns like Knurów/Pyskowice). Filters out NULL locations generated by CASE."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "387",
            "inputs": "Jaki procent mieszkańców zespołu dzielnic północnych Katowic oraz jaki procent mieszkańców gminy Mikołów był ostatnio na pikniku/festynie?",
            "expected_output": {
                "sql_query": "WITH KatowiceZoneNTotal AS ( SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') ), GminaMikolowTotal AS ( SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Mikołów' ) SELECT 'Zespół dzielnic północnych KTW' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM KatowiceZoneNTotal), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic IN ('Wełnowiec-Józefowiec', 'Dąb', 'Załęże', 'Osiedle Tysiąclecia', 'Osiedle Witosa') UNION ALL SELECT 'Mikołów (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM GminaMikolowTotal), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Mikołów';",
                "result": "lokalizacja|procent_ostatnio_piknik\nZespół dzielnic północnych KTW|53.77\nMikołów|54.74"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Compares a grouped Katowice zone with a specific Gmina using UNION ALL and separate denominator calculations."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "388",
            "inputs": "Jaki procent osób w wieku 40-49 lat z wykształceniem wyższym w Katowicach korzysta z profili instytucji w mediach społecznościowych do informacji o kulturze?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN informacja_social_media_instytucje = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_sm_instytucje FROM participation_survey WHERE grupa_wiekowa = '40-49' AND wyksztalcenie = 'wyższe' AND miasto_powiat = 'Katowice';",
                "result": "procent_sm_instytucje\n23.28"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates percentage for a specific behavior based on multiple combined demographic filters."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "389",
            "inputs": "Jaka jest średnia ocena istotności kultury (1-7) dla osób bez zadeklarowanych niepełnosprawności, pracujących na etacie i mieszkających na wsi?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN istotnosc_uczestnictwa_w_kulturze = '1 zupełnie nieistotne' THEN 1 WHEN istotnosc_uczestnictwa_w_kulturze = '2' THEN 2 WHEN istotnosc_uczestnictwa_w_kulturze = '3' THEN 3 WHEN istotnosc_uczestnictwa_w_kulturze = '4' THEN 4 WHEN istotnosc_uczestnictwa_w_kulturze = '5' THEN 5 WHEN istotnosc_uczestnictwa_w_kulturze = '6' THEN 6 WHEN istotnosc_uczestnictwa_w_kulturze = '7 bardzo istotne' THEN 7 ELSE 0 END * waga_proby) / SUM(waga_proby), 2) AS srednia_istotnosc FROM participation_survey WHERE niepelnosprawnosc_zadna = TRUE AND zatrudnienie_pracujacy = TRUE AND wielkosc_miejscowosci = 'wieś' AND istotnosc_uczestnictwa_w_kulturze IS NOT NULL;",
                "result": "srednia_istotnosc\n3.9"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates average rating for a highly specific subgroup defined by multiple conditions. Handles Likert scale."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "390",
            "inputs": "Jakie aktywności kulturalne (ostatnio_*) były najczęściej podejmowane przez mieszkańców Zabrza w ostatnich 6 miesiącach (top 5)?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Zabrze') SELECT activity_type, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'Wizyta w kinie' AS activity_type, ostatnio_kino AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w teatrze' AS activity_type, ostatnio_teatr AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Uczestnictwo w koncercie' AS activity_type, ostatnio_koncert AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w muzeum / galerii sztuki' AS activity_type, ostatnio_muzeum AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w parku rozrywki' AS activity_type, ostatnio_park_rozrywki AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w domu kultury / centrum kultury' AS activity_type, ostatnio_dom_kultury AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w bibliotece' AS activity_type, ostatnio_biblioteka AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w zoo' AS activity_type, ostatnio_zoo AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Wizyta w filharmonii lub operze' AS activity_type, ostatnio_filharmonia AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Uczestnictwo w spotkaniu z artystą' AS activity_type, ostatnio_spotkanie_z_artysta AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Udział w pikniku / festynie' AS activity_type, ostatnio_piknik AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Inna aktywność' AS activity_type, ostatnio_inna_aktywnosc AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' UNION ALL SELECT 'Żadna z powyższych' AS activity_type, ostatnio_zadne AS selected, waga_proby FROM participation_survey WHERE miasto_powiat = 'Zabrze' ) subquery WHERE selected = TRUE GROUP BY activity_type ORDER BY percentage DESC LIMIT 5;",
                "result": "activity_type|percentage\nWizyta w kinie|53.45\nUdział w pikniku / festynie|34.64\nŻadna z powyższych|23.95\nWizyta w zoo|22.94\nWizyta w bibliotece|21.12"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for recent activities (`ostatnio_*` columns) in a specific city. Calculates percentage based on the total weight of residents in that city and shows top 5."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "391",
            "inputs": "Wśród osób poniżej 30 lat, czy większy procent korzysta z gier komputerowych czy z podcastów jako formy kultury cyfrowej?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30') SELECT 'Gry komputerowe i gaming' AS digital_form, ROUND(SUM(CASE WHEN cyfrowa_kultura_gry = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30' UNION ALL SELECT 'Podcasty' AS digital_form, ROUND(SUM(CASE WHEN cyfrowa_kultura_podcasty = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM participation_survey WHERE grupa_wiekowa = 'Mniej niż 30';",
                "result": "digital_form|percentage\nGry komputerowe i gaming|32.19\nPodcasty|23.73"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares the percentage usage of two specific digital culture forms within the youngest age group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "392",
            "inputs": "Jak różni się postrzeganie 'gotowania' i 'mody' jako części kultury między kobietami a mężczyznami?",
            "expected_output": {
                "sql_query": "SELECT plec, ROUND(SUM(CASE WHEN kultura_gotowanie = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_gotowanie_kultura, ROUND(SUM(CASE WHEN kultura_moda = 'Tak' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_moda_kultura FROM participation_survey WHERE plec IN ('Kobieta', 'Mężczyzna') GROUP BY plec;",
                "result": "plec|procent_gotowanie_kultura|procent_moda_kultura\nMężczyzna|59.92|68.33\nKobieta|60.72|72.79"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares the weighted percentage of men vs women who consider cooking and fashion as culture, calculating each independently per gender."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "393",
            "inputs": "Czy osoby ceniące 'praktyczność' w wolnym czasie (ocena 5-7) rzadziej cenią 'nowość' (ocena 1-3)?",
            "expected_output": {
                "sql_query": "WITH PracticalGroup AS ( SELECT id_uczestnika, waga_proby FROM participation_survey WHERE wolny_czas_definicja_praktycznosc IN ('5', '6', '7 w pełni sie zgadzam') ), TotalPracticalWeight AS ( SELECT SUM(waga_proby) AS total FROM PracticalGroup ) SELECT ROUND(SUM(CASE WHEN ps.wolny_czas_definicja_nowosc IN ('1 zupełnie się nie zgadzam', '2', '3') THEN pg.waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM TotalPracticalWeight), 2) AS procent_nie_ceniacych_nowosci FROM PracticalGroup pg JOIN participation_survey ps ON pg.id_uczestnika = ps.id_uczestnika WHERE ps.wolny_czas_definicja_nowosc IS NOT NULL;",
                "result": "procent_nie_ceniacych_nowosci\nnan"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Calculates the percentage of respondents who value practicality (5-7) that also devalue novelty (1-3). Uses CTEs for clarity and correct denominator."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "394",
            "inputs": "Jaki procent mieszkańców Tychów odwiedza Chorzów w celach kulturalnych, a jaki procent mieszkańców Chorzowa odwiedza Tychy?",
            "expected_output": {
                "sql_query": "SELECT 'Mieszkańcy Tychów odwiedzający Chorzów' AS grupa, ROUND(SUM(CASE WHEN miejsce_kultury_chorzow = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Tychy' UNION ALL SELECT 'Mieszkańcy Chorzowa odwiedzający Tychy' AS grupa, ROUND(SUM(CASE WHEN miejsce_kultury_tychy = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent FROM participation_survey WHERE miasto_powiat = 'Chorzów';",
                "result": "grupa|procent\nMieszkańcy Tychów odwiedzający Chorzów|11.07\nMieszkańcy Chorzowa odwiedzający Tychy|0.0"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Compares cross-visitation percentages between two specific cities using UNION ALL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "395",
            "inputs": "Jaki jest rozkład preferencji miejsc uczestnictwa w kulturze (dom, instytucja, przestrzeń publiczna etc.) wśród osób samozatrudnionych?",
            "expected_output": {
                "sql_query": "WITH total_weight_target AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE) SELECT preference_location, ROUND(SUM(CASE WHEN selected = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM total_weight_target), 2) AS percentage FROM ( SELECT 'W domu' AS preference_location, preferowane_miejsce_dom AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W siedzibie instytucji kultury' AS preference_location, preferowane_miejsce_instytucja_kultury AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W przestrzeni publicznej' AS preference_location, preferowane_miejsce_przestrzen_publiczna AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W tymczasowo zaaranżowanej przestrzeni' AS preference_location, preferowane_miejsce_przestrzen_tymczasowa AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Na stadionie' AS preference_location, preferowane_miejsce_stadion AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'W pubie/klubie/restauracji' AS preference_location, preferowane_miejsce_pub_klub AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Inne miejsce' AS preference_location, preferowane_miejsce_inne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE UNION ALL SELECT 'Żadne z powyższych' AS preference_location, preferowane_miejsce_zadne AS selected, waga_proby FROM participation_survey WHERE zatrudnienie_samozatrudniony = TRUE ) subquery WHERE selected = TRUE GROUP BY preference_location ORDER BY percentage DESC;",
                "result": "preference_location|percentage\nW przestrzeni publicznej|57.11\nW domu|48.7\nW siedzibie instytucji kultury|42.82\nW pubie/klubie/restauracji|35.04\nNa stadionie|26.64\nW tymczasowo zaaranżowanej przestrzeni|22.56\nŻadne z powyższych|6.45\nInne miejsce|1.12"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Uses UNION ALL for preferred locations (`preferowane_miejsce_*` columns) among self-employed individuals. Calculates percentage based on the total weight of that specific group."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "396",
            "inputs": "Jaki procent właścicieli firm z sektora MŚP w GZM jest zainteresowany sponsorowaniem kultury?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN zainteresowanie_sponsorowaniem_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_zainteresowanych_sponsorowaniem FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE;",
                "result": "procent_zainteresowanych_sponsorowaniem\n18.39"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Uses the business-related fields `wlasciciel_firmy_msp` and `zainteresowanie_sponsorowaniem_kultury`."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "397",
            "inputs": "Czy firmy MŚP, które już sponsorowały kulturę, częściej mają siedzibę w Katowicach niż w innych miastach GZM?",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Katowice' THEN 'Katowice' ELSE 'Inne miasta GZM' END AS lokalizacja_firmy, ROUND(SUM(waga_proby) * 100.0 / (SELECT SUM(waga_proby) FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE AND sponsorowanie_kultury = TRUE), 2) AS procent_firm_sponsorujacych FROM participation_survey WHERE wlasciciel_firmy_msp = TRUE AND sponsorowanie_kultury = TRUE GROUP BY lokalizacja_firmy;",
                "result": "lokalizacja_firmy|procent_firm_sponsorujacych\nKatowice|15.81\nInne miasta GZM|84.19"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Filters for SMEs that have sponsored culture (`wlasciciel_firmy_msp`=TRUE AND `sponsorowanie_kultury`=TRUE) and compares their location distribution (Katowice vs. Rest of GZM)."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "398",
            "inputs": "Wśród osób z Katowic, które NIGDY nie były w filharmonii/operze i NIE SĄ tym zainteresowane, jaki jest średni wiek?",
            "expected_output": {
                "sql_query": "WITH AgeMapping AS ( SELECT id_uczestnika, CASE grupa_wiekowa WHEN 'Mniej niż 30' THEN 25 WHEN '30-39' THEN 34.5 WHEN '40-49' THEN 44.5 WHEN '50-59' THEN 54.5 WHEN '60 i więcej' THEN 65 END AS mid_age, waga_proby FROM participation_survey ) SELECT ROUND(SUM(am.mid_age * am.waga_proby) / SUM(am.waga_proby), 1) AS sredni_wiek_niezainteresowanych FROM AgeMapping am JOIN participation_survey ps ON am.id_uczestnika = ps.id_uczestnika WHERE ps.miasto_powiat = 'Katowice' AND ps.czestotliwosc_filharmonia = 'Nigdy i nie jestem tym zainteresowany(a)';",
                "result": "sredni_wiek_niezainteresowanych\n49.6"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Targets a very specific subgroup based on location and a specific non-participation category ('Nigdy i nie jestem tym zainteresowany(a)') and calculates their weighted average age."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "399",
            "inputs": "Jakie kombinacje barier (np. cena+brak czasu, dojazd+brak informacji) są najczęstsze wśród osób z niepełnosprawnością ruchową?",
            "expected_output": {
                "sql_query": "WITH TargetGroup AS ( SELECT id_uczestnika, waga_proby, bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji FROM participation_survey WHERE niepelnosprawnosc_ruch = TRUE ), TotalWeight AS ( SELECT SUM(waga_proby) AS total FROM TargetGroup ) SELECT bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji, ROUND(SUM(waga_proby) * 100.0 / (SELECT total FROM TotalWeight), 2) AS procent_kombinacji FROM TargetGroup GROUP BY bariera_wysokie_ceny, bariera_brak_czasu, bariera_dojazd, bariera_brak_informacji ORDER BY procent_kombinacji DESC LIMIT 5;",
                "result": "bariera_wysokie_ceny|bariera_brak_czasu|bariera_dojazd|bariera_brak_informacji|procent_kombinacji\nFalse|False|False|False|29.14\nTrue|False|False|False|15.67\nTrue|False|True|False|9.19\nFalse|True|False|False|9.03\nTrue|True|False|False|8.37"
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Identifies combinations of selected barriers (using boolean flags) for the target group and calculates the weighted percentage for each combination, showing the top 5."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "400",
            "inputs": "Jaki procent osób w GZM, które często korzystają z kultury online (ocena 6-7), również często odwiedza kino (przynajmniej raz w roku)?",
            "expected_output": {
                "sql_query": "SELECT ROUND(SUM(CASE WHEN czestotliwosc_kino = 'Przynajmniej raz w ciągu ostatnich 12 miesięcy' THEN waga_proby ELSE 0 END) * 100.0 / SUM(waga_proby), 2) AS procent_kino_rocznie_wsrod_czestych_online FROM participation_survey WHERE czestotliwosc_kultura_online IN ('6', '7 bardzo często');",
                "result": "procent_kino_rocznie_wsrod_czestych_online\n69.99"
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Calculates the percentage of frequent online users who also attend cinema annually. Denominator correctly reflects the weight of frequent online users."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "401",
            "inputs": "Porównaj średnie wydatki na kulturę w subregionie gliwickim i mieście Zabrze.",
            "expected_output": {
                "sql_query": "SELECT 'Subregion GLIWICKI' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Zabrze (Miasto)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Zabrze' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje Subregion (`subregion_metropolii_gzm`) z Miastem na prawach powiatu (`miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "402",
            "inputs": "Jaki procent mieszkańców subregionu tyski i gminy Łaziska Górne był ostatnio na koncercie?",
            "expected_output": {
                "sql_query": "WITH SubregionTyskiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI'), GminaLaziskaTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Łaziska Górne') SELECT 'Subregion TYSKI' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SubregionTyskiTotal), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' UNION ALL SELECT 'Łaziska Górne (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM GminaLaziskaTotal), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' AND gmina_miejscowosc = 'Łaziska Górne';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Subregion (`subregion_metropolii_gzm`) z Gminą (`gmina_miejscowosc` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "403",
            "inputs": "Porównaj średnie wydatki na kulturę w subregionie sosnowieckim i katowickiej dzielnicy Giszowiec.",
            "expected_output": {
                "sql_query": "SELECT 'Subregion SOSNOWIECKI' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'SOSNOWIECKI' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Giszowiec KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Giszowiec' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Subregion (`subregion_metropolii_gzm`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "404",
            "inputs": "Jaki procent mieszkańców miasta Bytom i gminy Zbrosławice był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "WITH BytomTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Bytom'), ZbroslawiceTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice') SELECT 'Bytom (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM BytomTotal), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Bytom' UNION ALL SELECT 'Zbrosławice (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM ZbroslawiceTotal), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Zbrosławice';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Miasto na prawach powiatu (`miasto_powiat`) z Gminą (`gmina_miejscowosc` w ramach innego `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "405",
            "inputs": "Porównaj średnie wydatki na kulturę w mieście Tychy i katowickiej dzielnicy Osiedle Tysiąclecia.",
            "expected_output": {
                "sql_query": "SELECT 'Tychy (Miasto)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Tychy' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Osiedle Tysiąclecia KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Osiedle Tysiąclecia' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Miasto na prawach powiatu (`miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "406",
            "inputs": "Jaki procent mieszkańców gminy Tarnowskie Góry i katowickiej dzielnicy Załęże był ostatnio w muzeum?",
            "expected_output": {
                "sql_query": "WITH TarnowskieGoryTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry'), ZalezeTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Załęże') SELECT 'Tarnowskie Góry (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM TarnowskieGoryTotal), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Tarnowskie Góry' UNION ALL SELECT 'Załęże KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_muzeum = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM ZalezeTotal), 2) AS procent_ostatnio_muzeum FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Załęże';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "407",
            "inputs": "Porównaj średnie wydatki na kulturę w Powiecie będzińskim i subregionie Tyskim.",
            "expected_output": {
                "sql_query": "SELECT 'Powiat Będziński' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Subregion TYSKI' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'TYSKI' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "medium",
                "ambiguity_note": "Porównuje Powiat (`miasto_powiat`) z Subregionem (`subregion_metropolii_gzm`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "408",
            "inputs": "Jaki procent mieszkańców Powiatu mikołowskiego i subregionu katowickiego był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "WITH PowiatMikolowskiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski'), SubregionKatowickiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICKI') SELECT 'Powiat Mikołowski' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM PowiatMikolowskiTotal), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Powiat mikołowski' UNION ALL SELECT 'Subregion KATOWICKI' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SubregionKatowickiTotal), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICKI';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Powiat (`miasto_powiat`) z Subregionem (`subregion_metropolii_gzm`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "409",
            "inputs": "Porównaj średnie wydatki na kulturę w gminie Kobiór i subregionie GLIWICKIM.",
            "expected_output": {
                "sql_query": "SELECT 'Kobiór (Gmina)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat pszczyński' AND gmina_miejscowosc = 'Kobiór' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Subregion GLIWICKI' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'GLIWICKI' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Subregionem (`subregion_metropolii_gzm`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "410",
            "inputs": "Jaki procent mieszkańców katowickiej dzielnicy Ligota-Panewniki i subregionu BYTOMSKIEGO był ostatnio na pikniku/festynie?",
            "expected_output": {
                "sql_query": "WITH LigotaTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Ligota-Panewniki'), SubregionBytomskiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI') SELECT 'Ligota-Panewniki KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM LigotaTotal), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Ligota-Panewniki' UNION ALL SELECT 'Subregion BYTOMSKI' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_piknik = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SubregionBytomskiTotal), 2) AS procent_ostatnio_piknik FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Dzielnicę Katowic (`dzielnica_katowic` w ramach `miasto_powiat`) z Subregionem (`subregion_metropolii_gzm`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "411",
            "inputs": "Porównaj średnie wydatki na kulturę w mieście Piekary Śląskie i gminie Radzionków.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Piekary Śląskie' THEN 'Piekary Śląskie (Miasto)' WHEN miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków' THEN 'Radzionków (Gmina)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Piekary Śląskie' OR (miasto_powiat = 'Powiat tarnogórski' AND gmina_miejscowosc = 'Radzionków')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Miasto na prawach powiatu (`miasto_powiat`) z Gminą (`gmina_miejscowosc` w ramach innego `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "412",
            "inputs": "Jaki procent mieszkańców Świętochłowic i katowickiej dzielnicy Brynów Cz. Wsch.-Os. Zgrzebnioka był ostatnio w bibliotece?",
            "expected_output": {
                "sql_query": "WITH SwietochlowiceTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Świętochłowice'), BrynowTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Brynów Część Wschodnia - Os. Zgrzebnioka') SELECT 'Świętochłowice (Miasto)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SwietochlowiceTotal), 2) AS procent_ostatnio_biblioteka FROM participation_survey WHERE miasto_powiat = 'Świętochłowice' UNION ALL SELECT 'Brynów KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_biblioteka = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM BrynowTotal), 2) AS procent_ostatnio_biblioteka FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Brynów Część Wschodnia - Os. Zgrzebnioka';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Miasto na prawach powiatu (`miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "413",
            "inputs": "Porównaj średnie wydatki na kulturę w gminie Siewierz i katowickiej dzielnicy Bogucice.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Siewierz' THEN 'Siewierz (Gmina)' WHEN miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Bogucice' THEN 'Bogucice KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Siewierz') OR (miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Bogucice')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "414",
            "inputs": "Jaki procent mieszkańców gminy Imielin i katowickiej dzielnicy Kostuchna był ostatnio na koncercie?",
            "expected_output": {
                "sql_query": "WITH ImielinTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Imielin'), KostuchnaTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Kostuchna') SELECT 'Imielin (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM ImielinTotal), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' AND gmina_miejscowosc = 'Imielin' UNION ALL SELECT 'Kostuchna KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_koncert = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM KostuchnaTotal), 2) AS procent_ostatnio_koncert FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Kostuchna';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "415",
            "inputs": "Porównaj średnie wydatki na kulturę w Powiecie tarnogórskim i katowickiej dzielnicy Wełnowiec-Józefowiec.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat tarnogórski' THEN 'Powiat Tarnogórski' WHEN miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Wełnowiec-Józefowiec' THEN 'Wełnowiec KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE (miasto_powiat = 'Powiat tarnogórski' OR (miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Wełnowiec-Józefowiec')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Powiat (`miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "416",
            "inputs": "Jaki procent mieszkańców Powiatu bieruńsko-lędzińskiego i katowickiej dzielnicy Podlesie był ostatnio w domu kultury?",
            "expected_output": {
                "sql_query": "WITH PowiatBLTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński'), PodlesieTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Podlesie') SELECT 'Powiat Bieruńsko-Lędziński' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM PowiatBLTotal), 2) AS procent_ostatnio_dom_kultury FROM participation_survey WHERE miasto_powiat = 'Powiat bieruńsko-lędziński' UNION ALL SELECT 'Podlesie KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_dom_kultury = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM PodlesieTotal), 2) AS procent_ostatnio_dom_kultury FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Podlesie';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Powiat (`miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "417",
            "inputs": "Porównaj średnie wydatki na kulturę w subregionie KATOWICKIM (bez Katowic) i gminie Będzin.",
            "expected_output": {
                "sql_query": "SELECT 'Subregion KATOWICKI' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE subregion_metropolii_gzm = 'KATOWICKI' AND wydatki_na_kulture_kwota IS NOT NULL UNION ALL SELECT 'Będzin (Gmina)' AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Będzin' AND wydatki_na_kulture_kwota IS NOT NULL;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Subregion (`subregion_metropolii_gzm`) z Gminą (`gmina_miejscowosc` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "418",
            "inputs": "Jaki procent mieszkańców subregionu BYTOMSKIEGO i katowickiej dzielnicy Murcki był ostatnio w kinie?",
            "expected_output": {
                "sql_query": "WITH SubregionBytomskiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI'), MurckiTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Murcki') SELECT 'Subregion BYTOMSKI' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SubregionBytomskiTotal), 2) AS procent_ostatnio_kino FROM participation_survey WHERE subregion_metropolii_gzm = 'BYTOMSKI' UNION ALL SELECT 'Murcki KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_kino = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM MurckiTotal), 2) AS procent_ostatnio_kino FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Murcki';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Subregion (`subregion_metropolii_gzm`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "419",
            "inputs": "Porównaj średnie wydatki na kulturę w gminie Sośnicowice i katowickiej dzielnicy Załęska Hałda-Brynów Cz. Zach.",
            "expected_output": {
                "sql_query": "SELECT CASE WHEN miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Sośnicowice' THEN 'Sośnicowice (Gmina)' WHEN miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Załęska Hałda - Brynów Część Zachodnia' THEN 'Załęska Hałda KTW (Dzielnica)' END AS lokalizacja, ROUND(SUM(wydatki_na_kulture_kwota * waga_proby) / SUM(waga_proby), 2) AS srednie_wydatki FROM participation_survey WHERE ((miasto_powiat = 'Powiat gliwicki' AND gmina_miejscowosc = 'Sośnicowice') OR (miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Załęska Hałda - Brynów Część Zachodnia')) AND wydatki_na_kulture_kwota IS NOT NULL GROUP BY lokalizacja;",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Średnie wydatki, wymaga filtra IS NOT NULL."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        },
        {
            "name": "420",
            "inputs": "Jaki procent mieszkańców gminy Sławków i katowickiej dzielnicy Zarzecze był ostatnio w teatrze?",
            "expected_output": {
                "sql_query": "WITH SlawkowTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Sławków'), ZarzeczeTotal AS (SELECT SUM(waga_proby) AS total FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Zarzecze') SELECT 'Sławków (Gmina)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM SlawkowTotal), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Powiat będziński' AND gmina_miejscowosc = 'Sławków' UNION ALL SELECT 'Zarzecze KTW (Dzielnica)' AS lokalizacja, ROUND(SUM(CASE WHEN ostatnio_teatr = TRUE THEN waga_proby ELSE 0 END) * 100.0 / (SELECT total FROM ZarzeczeTotal), 2) AS procent_ostatnio_teatr FROM participation_survey WHERE miasto_powiat = 'Katowice' AND dzielnica_katowic = 'Zarzecze';",
                "result": ""
            },
            "metadata": {
                "complexity": "high",
                "ambiguity_note": "Porównuje Gminę (`gmina_miejscowosc` w ramach `miasto_powiat`) z Dzielnicą Katowic (`dzielnica_katowic` w ramach `miasto_powiat`). Odsetek, wymaga osobnych mianowników dla grup."
            },
            "evaluators": [
                "ResultWeighted"
            ]
        }
    ],
    "evaluators": [
        "ResultEquals"
    ]
}